(* ::Package:: *)

(* Low moments from 2111.15561 *)
gqq3psN2 = (+ cf^3*nf * ( 227938/2187 + 1952/81*z3 + 256/9*z4 - 640/3*z5 )
		+ d4RR/nr*nf * ( 1024/9 + 256/9*z3 - 2560/9*z5 )
       + cf^2*ca*nf * ( - 162658/6561 + 8048/27*z3 - 1664/9*z4 + 320/9*z5 )
       + cf*ca^2*nf * ( - 410299/6561 - 26896/81*z3 + 1408/9*z4 + 4480/27*z5 )
       + cf^2*nf^2 * ( - 73772/6561 - 5248/81*z3 + 320/9*z4 )
       + cf*ca*nf^2 * ( 160648/6561 + 48*z3 - 320/9*z4 )
       + cf*nf^3 * ( - 1712/729 + 128/27*z3 ) );

gqq3psN4 = (
       + nf*cf^3 * ( 1995890620891/52488000000 - 897403/202500*z3 + 18997/2250*z4 - 484/15*z5 )
       + nf*ca*cf^2 * ( 209865827521/26244000000 + 6743539/202500*z3 - 29161/750*z4 + 242/45*z5 )
       + nf*ca^2*cf * ( - 55187654921/3280500000 - 3104267/67500*z3 + 34243/1125*z4 + 3164/135*z5 )
       + nf*d4RR/nr * ( 172231/675 - 5368/25*z3 - 3728/45*z5 )
       + nf^2*cf^2 * ( - 141522185707/26244000000 - 1207/135*z3 + 242/45*z4 )
       + nf^2*ca*cf * ( 9398360351/1640250000 + 57877/10125*z3 - 242/45*z4 )
       + nf^3*cf * ( - 46099151/72900000 + 484/675*z3 ));

gqq3psN6 =(+ nf*cf^3 * ( 140565274663259489/5403265623000000 - 62727544/24310125*z3
          + 343156/77175*z4 - 1936/147*z5 )
       + nf*ca*cf^2 * ( 336481838777617/360217708200000 + 2111992/324135*z3
          - 1389806/77175*z4 + 968/441*z5 )
       + nf*ca^2*cf * ( - 6194882229735067/864522499680000 - 2396237/165375*z3
          + 41866/3087*z4 + 9544/1323*z5 )
       + nf*d4RR/nr * ( 64697569/330750 - 426976/3675*z3 - 39808/441*z5 )
       + nf^2*cf^2 * ( - 812984663253277/270163281150000 - 2594876/694575*z3
          + 968/441*z4 )
       + nf^2*ca*cf * ( 3092531515013/964868861250 + 217432/99225*z3
          - 968/441*z4 )
          + nf^3*cf * ( - 19597073837/61261515000 + 1936/6615*z3 ));

gqq3psN8 =(+ nf*cf^3 * ( 3960340604223955458923/192072198786048000000
          - 34718701049/18003384000*z3 + 13529827/4762800*z4 - 1369/189*z5 )
       + nf*ca*cf^2 * ( - 43838488788848637899/13719442770432000000
          + 10167760657/18003384000*z3 - 10211371/952560*z4 + 1369/1134*z5 )
       + nf*ca^2*cf * ( - 8552512702477166383/2939880593664000000
          - 97528710971/18003384000*z3 + 1340251/170100*z4 + 128/63*z5 )
       + nf*d4RR/nr * ( 1183211180737/7715736000 - 18321694/297675*z3
          - 18164/189*z5 )
       + nf^2*cf^2 * ( - 5115927245667479753/2743888554086400000
          - 15129691/7144200*z3 + 1369/1134*z4 )
       + nf^2*ca*cf * ( 15301312238130101/7349701484160000 + 8397097/7144200*z3
          - 1369/1134*z4 )
       + nf^3*cf * ( - 162840799744061/816633498240000 + 1369/8505*z3 ));

(* Moments for N=10 .. 20 are taken from https://arxiv.org/abs/2302.07593 *)
gqq3psN10= (
      +nf*d4RR/nr*(1240606813603/9901861200-1624576/16335*z5-182828576543/6303268125*z3)
      +cf*nf^3*(-2205751150439/15885856515375+25088/245025*z3)
      +cf*ca*nf^2*(314242565140920849001/215285127496362000000
		   -12544/16335*z4+89550464/121287375*z3)
      +cf*ca^2*nf*(-202179113304531644762417/284176368295197840000000
		   -14912/49005*z5+23430848/4492125*z4-192321673117627/109828143810000*z3)
      +cf^2*nf^2*(-367710354086746558213/296017050307497750000
		  +12544/16335*z4-1243744/898425*z3)
      +cf^2*ca*nf*(-1538138456874500390560463/298385186709957732000000
		   +12544/16335*z5-97295744/13476375*z4-31074715888/28017383625*z3)
      +cf^3*nf*(19206657411733877390649313/1118944450162341495000000
		-25088/5445*z5+1080128/539055*z4-45224548192/28017383625*z3)
);

gqq3psN12 = (
      +nf*d4RR/nr*(13789024918875535939/130167745507800000
		     -11883280/117117*z5-261789233833/33202669500*z3)
      +cf*nf^3*(-127821768039445576087/1233139451029305019200+24964/351351*z3)
      +cf*ca*nf^2*(17400519563132679535658867/16159059366288012971596800
		   -62410/117117*z4+536686847/1055107053*z3)
      +cf*ca^2*nf*(108542242435054542124290045599/210067771761744168630758400000
		   -549260/351351*z5+108549713/29066310*z4+7458806358343849/228131026571448000*z3)
      +cf^2*nf^2*(-2797424774494087428631891051/3209368735248869242969920000
		  +62410/117117*z4-15566147588/15826605795*z3)
      +cf^2*ca*nf*(-116621076523257514706541796876157/19410262110785161181482076160000
		   +62410/117117*z5-18419693641/3517023510*z4-1989733300788683/1267394592063600*z3)
      +cf^3*nf*(88961716829219432715740321165467/6065706909620362869213148800000
		-124820/39039*z5+2642589184/1758511755*z4-671898176890091/475272972023850*z3)
);

gqq3psN14=(
      +nf*d4RR/nr*(19073114986773056430079/207292134721171500000
		     -2945344/28665*z5+1655601644872528/246073284331875*z3)
      +cf*nf^3*(-1225131890207918292167/15090867407701285200000+22472/429975*z3)
      +cf*ca*nf^2*(15677247599879616342540623/19014492933703619352000000
		   -11236/28665*z4+72862649/195638625*z3)
      +cf*ca^2*nf*(212618793832045564739311832977/171789605491700966305536000000
		   -15356/6615*z5+933124519/331080750*z4+77579129461513987/76774864711545000*z3)
      +cf^2*nf^2*(-4032068581057610850590942023/6344502475545774323784000000+11236/28665*z4-14300095639/19368223875*z3)
      +cf^2*ca*nf*(-158391038218926832370900571697207/25124229803161266322184640000000
		   +11236/28665*z5-17190217637/4304049750*z4-14044584522181/8616707599500*z3)
      +cf^3*nf*(378715964141637885273854172708551/29692271585554223835309120000000
		-22472/9555*z5+505959889/430404975*z4-367639947406454/290813881483125*z3)
);

gqq3psN16=(
      +nf*d4RR/nr*(194754027746301317663486903/2385646868143957017600000
		     -808523/7803*z5+488331702547711013/28175156700490800*z3)
      +cf*nf^3*(-13608819731912112034987483/206666738093821415406796800+18769/468180*z3)
      +cf*ca*nf^2*(5139790280893055367044834414063191/7912907734820757808449287577600000
		   -18769/62424*z4+1631966041/5730523200*z3)
      +cf*ca^2*nf*(108178133162924948555733173122528196346341/64633896443253521100663132819849216000000
		   -131747/46818*z5+19557316769/8852243400*z4+12453233313645527413979/7816915474984167552000*z3)
      +cf^2*nf^2*(-27940032477586559318231174397709681/58566283098537309493828740710400000
		  +18769/62424*z4-220452248921/382416914880*z3)
      +cf^2*ca*nf*(-272131316618720437180274758003365964006181/43089264295502347400442088546566144000000
		   +18769/62424*z5-805069021181/254944609920*z4-186362119838618569/120140097978700800*z3)
      +cf^3*nf*(52845922593469053066814397892836049514811/4700647014054801534593682386898124800000
		-18769/10404*z5+1209091491169/1274723049600*z4-1576051471675106357/1378077594461568000*z3)
);

gqq3psN18=(
      +nf*d4RR/nr*(269658033224423391160920092267/3660178707449866054252800000
		     -17270272/165699*z5+231728400575045385953/9154108411989460920*z3)
      +cf*nf^3*(-12093315480521279173973861137/220470747728360428912290678000+236672/7456455*z3)
      +cf*ca*nf^2*(5746360771534685866990135393992059327/10978384977283253229773296769145600000
		   -118336/497097*z4+24382094512/108379573425*z3)
      +cf*ca^2*nf*(89162440521267641872038820315362221737605493/45935538854249042498952832875523636608000000
		   -522368/165699*z5+50551793128/28362863529*z4+132300696845690213098985759/67414515989255185999248000*z3)
      +cf^2*nf^2*(-510320588931393559068451118322848217263/1393078636581692811620875836456225600000
		  +118336/497097*z4-10059181640656/21697590599685*z3)
      +cf^2*ca*nf*(-28959853818114889791771647893787915791563566723/4685424963133402334893188953303410934016000000
		   +118336/497097*z5-30932168351824/12054216999825*z4-751673700996836590582/526149756409646494125*z3)
      +cf^3*nf*(7253359571892497953990576741964828731260622709/724111130666071269938038292783254417075200000
		-236672/165699*z5+9447656272424/12054216999825*z4-109721806416706447798/105229951281929298825*z3)
);

gqq3psN20=(
      +nf*d4RR/nr*(124046988016629781809318499469746921/1840118243383345660115052672000000
		     -48237328/460845*z5+34660205433264885994007/1100342324269440252000*z3)
      +cf*nf^3*(-46235817346069201871585241841/990993385042051234188945600000+178084/6912675*z3)
      +cf*ca*nf^2*(688560020231378646396927215051130832957/1602729320537086079392450022635008000000
		   -89042/460845*z4+1316792611/7223745375*z3)
      +cf*ca^2*nf*(250450109018215553669333751863263807123028219/119012268425801863911365768880785154048000000
		   -4694036/1382535*z5+164760066767/112031419500*z4+40625424437896114995230699/18397723661785041013440000*z3)
      +cf^2*nf^2*(-20553091730130297702276618606953655791/71772053747957053386934630643251200000
		  +89042/460845*z4-2842660003013/7450089396750*z3)
      +cf^2*ca*nf*(-8442281731349030891500282315883757515259615913/1413270687556397133947468505459323704320000000
		   +89042/460845*z5-7936779238702/3725044698375*z4-13512345934144930064021/10405952297389729080000*z3)
      +cf^3*nf*(2128032487727689123396891103081423002879945894061/236298858959429600796016734112798923362304000000
		-178084/153615*z5+9834028074797/14900178793500*z4-7463032385600125416449/7804464223042296810000*z3)
);

(* All x paramtrization from: https://arxiv.org/src/2302.07593v1/anc/xPps3a.f*)
gqq3psX[Y_, nf_, imod_]:= Module[{YM, Y1, DL, DL1, nf2, nf3, x1L4cff, x1L3cff, y1L4cff, y1L3cff, bfkl1,x0L6cff,x0L5cff,x0L4cff, P3psApp1, P3psApp2, P3psA, P3ps01},
	YM  = 1/Y;
	Y1  = 1-Y;
	DL  = Log[Y];
	DL1 = Log[1-Y];
	nf2 = nf*nf;
	nf3 = nf*nf2;
	(* Known large-x coefficients *)
	x1L4cff = - 5.6460905*10*nf + 3.6213992*nf2;
	x1L3cff = - 2.4755054*10^2*nf + 4.0559671*10*nf2 - 1.5802469*nf3;
	y1L4cff = - 1.3168724*10*nf;
	y1L3cff = - 1.9911111*10^2*nf + 1.3695473*10*nf2;
	(* Known small-x coefficients *)
	bfkl1   =   1.7492273*10^3*nf;
	x0L6cff = - 7.5061728*nf + 7.9012346*10^-1*nf2;
	x0L5cff =   2.8549794*10*nf + 3.7925926*nf2;
	x0L4cff = - 8.5480010*10^2*nf + 7.7366255*10*nf2 - 1.9753086*10^-1*nf3;

	(* The resulting part of the function *)
	P3ps01 =(
      + bfkl1* DL^2*YM
      + x0L6cff* DL^6
      + x0L5cff* DL^5
      + x0L4cff* DL^4
      + x1L3cff* Y1*DL1^3
      + x1L4cff* Y1*DL1^4
      + y1L3cff* Y1*Y1*DL1^3
      + y1L4cff* Y1*Y1*DL1^4
	);

	(* The selected approximations for nf = 3, 4, 5 *)
	Which[
	nf == 3,
	P3psApp1 = (P3ps01
      + 67731. * Y1*DL*YM
      + 274100.* Y1*YM
      - 104493.* Y1*(1+2*Y)
      + 34403. * Y1*Y*Y
      + 353656.* Y1*DL
      + 10620. * DL^2
      + 40006. * DL^3
      - 7412.1 * Y1*DL1
      - 2365.1 * Y1*DL1^2
      + 1533.0 * Y1*Y1*DL1^2
     );
    P3psApp2 = (P3ps01
      + 54593. * Y1*DL*YM
      + 179748.* Y1*YM
      - 195263.* Y1
      + 12789. * Y1*Y*(1+Y)
      + 4700.0 * Y1*DL
      - 103604.* DL^2
      - 2758.3 * DL^3
      - 2801.2 * Y1*DL1
      - 1986.9 * Y1*DL1^2
      - 6005.9 * Y1*Y1*DL1^2
     );,
	nf == 4,
    P3psApp1 =( P3ps01
      + 90154. * Y1*DL*YM
      + 359084.* Y1*YM
      - 136319.* Y1*(1+2*Y)
      + 45379. * Y1*Y*Y
      + 461167.* Y1*DL
      + 13869. * DL^2
      + 52525. * DL^3
      - 7498.2 * Y1*DL1
      - 2491.5 * Y1*DL1^2
      + 1727.2 * Y1*Y1*DL1^2
     );
    P3psApp2  =( P3ps01
      + 72987. * Y1*DL*YM
      + 235802.* Y1*YM
      - 254921.* Y1
      + 17138. * Y1*Y*(1+Y)
      + 5212.9 * Y1*DL
      - 135378.* DL^2
      - 3350.9 * DL^3
      - 1472.7 * Y1*DL1
      - 1997.2 * Y1*DL1^2
      - 8123.3 * Y1*Y1*DL1^2
     );,
	nf == 5,
    P3psApp1 =( P3ps01
      + 112481.* Y1*DL*YM
      + 440555.* Y1*YM
      - 166581.* Y1*(1+2*Y)
      + 56087. * Y1*Y*Y
      + 562992.* Y1*DL
      + 16882. * DL^2
      + 64577. * DL^3
      - 6570.1 * Y1*DL1
      - 2365.7 * Y1*DL1^2
      + 1761.7 * Y1*Y1*DL1^2
      );
    P3psApp2  = (P3ps01
      + 91468. * Y1*DL*YM
      + 289658.* Y1*YM
      - 311749.* Y1
      + 21521. * Y1*Y*(1+Y)
      +  4908.9* Y1*DL
      - 165795.* DL^2
      -  3814.9* DL^3
      +   804.5* Y1*DL1
      -  1760.8* Y1*DL1^2
      - 10295. * Y1*Y1*DL1^2
     );
     ];
	(* We return (for now) one of the two error-band boundaries
	* or the present best estimate, their average *)
    Which[
    imod == 1, P3psA = P3psApp1,
    imod == 2, P3psA = P3psApp2,
    imod == "asy", P3psA=P3ps01,
    imod == 0, P3psA = 1/2* ( P3psApp1 + P3psApp2 );
    ];
    P3psA
];

(* Limit for N \[Rule] 0 from 2202.10362 *)
gqq3psN0asy =-((
       - 640*n^(-7)*cf*ca^2*nf
       + 320*n^(-7)*cf^2*nf^2
       + 640*n^(-7)*cf^2*ca*nf
       - 480*n^(-7)*cf^3*nf
       + 80*n^(-7)*cf^4
       - 2176/3*n^(-6)*cf*ca^2*nf
       - 256*n^(-6)*cf^2*nf^2
       + 3424/3*n^(-6)*cf^2*ca*nf
       - 1024/3*n^(-6)*cf^3*nf
       - 80*n^(-6)*cf^3*beta0
       + 160*n^(-6)*cf^4
       - 32/9*n^(-5)*cf*nf^3
       - 288*n^(-5)*cf*ca*nf^2
       - 13672/9*n^(-5)*cf*ca^2*nf
       + 15232/9*n^(-5)*cf^2*nf^2
       + 4328/9*n^(-5)*cf^2*ca*nf
       + 24*n^(-5)*cf^2*beta0^2
       - 1384*n^(-5)*cf^3*nf
       + 160*n^(-5)*cf^3*ca
       + 80*n^(-5)*cf^3*beta0
       + 128*n^(-5)*cf^4
       + 512/3*n^(-5)*z2*cf*ca^2*nf
       - 1184*n^(-5)*z2*cf^2*ca*nf
       - 480*n^(-5)*z2*cf^2*ca^2
       + 4192/3*n^(-5)*z2*cf^3*nf
       + 1536*n^(-5)*z2*cf^3*ca
       - 1600*n^(-5)*z2*cf^4
      ) - Pns3R) /. BetaRules;

(* eq 3.3 *)
Pns3R =(
    + 80*n^(-7)*cf^4
    - 80*n^(-6)*cf^3*beta0
    + 160*n^(-6)*cf^4
    + 24*n^(-5)*cf^2*beta0^2
    + 160*n^(-5)*cf^3*ca
    + 80*n^(-5)*cf^3*beta0
    + 128*n^(-5)*cf^4
    - 480*n^(-5)*z2*cf^2*ca^2
    + 1536*n^(-5)*z2*cf^3*ca
    - 1600*n^(-5)*z2*cf^4
      ) /. BetaRules;

(*
Limit for N \[Rule] 1 from 1805.06460 eq 2.21b,
Note: in 1805.06460 is reported gqq3, but according to
1707.08315 gqq3nsp do not have a pole in N=1. *)
gqq3psN1asy = - (4 Pi)^4 (1/(n-1)^3 ca^2 cf nf/(3 Pi^4) (82/81 + 2 z3));

(*
Part proportional to Zeta[5] and the quartic Casimir,
see Eq. 3.13 of 1805.09638
*)
gqq3psz5N = (
  + (d4RR/nr)*nf* 320/3*z5* (
     - 1
     - 16 * (1/(n)-1/(n+1))
     - 16 * (1/(n-1)-1/(n+2))
     + 36 * (1/(n)^2 + 1/(n+1)^2)
    )
);

(*Large-x limit (1-x)Log[1-x]^{3,4} from 0912.0369 eq 5.19 *)
gqq3psXinf4 = Log[1-x]^4(
  + caf^2 cf nf (-728/(81 x) - 602/27 + 122/27 x + 2168/81 x^2
     +4/27 (40 / x -121 -241 x -40 x^2) H[0,x] + 80/9 (1+x) H[0,0,x])
  + caf cf^2 nf (- 248/(81 x) -62/27 + 62/27 x + 248/81 x^2
     +4/27 (40 / x -1 -61 x -40 x^2) H[0,x] + 160/9 (1+x) H[0,0,x])
  + caf cf nf^2 (176/(81 x) + 44/27 (1 - x) - 176/81 x^2 + 88/27 (1+x) H[0,x])
 ) /. hrep;

gqq3psXinf3 = Log[1-x]^3(
	cf^3 nf (
		+ 1072/(27x) + 610/9 - 2182/27 x - 80/3x^2
		\[Minus](320/(27 x)+ 80/9 (1\[Minus]x)\[Minus] 320/27 x^2) Zeta[2] +( 2252/27 \[Minus] 884/27 x
		\[Minus] 2560/27 x^2 \[Minus] 160/9 Zeta[2](1+x)) H[0,x] \[Minus]8/3 (5 + 25/3 x + 152/9 x^2)H[0,0,x]
		+(1216/(27 x) \[Minus] 112/3 \[Minus] 1264/9 x \[Minus] 1216/27 x^2 ) Ht[1,0,x]
		- 320/9 (1+x) Ht[1,0,0,x] + 32(1+x) Ht[0,1,0,x] + 560/9 (1+x) H[0,0,0,x]
	)
	+ cf^2 ca nf (
		\[Minus]24232/(243 x) + 8954/81 \[Minus] 16730/81 x + 47560/243 x^2
		+(64/(27 x) + 16/9 (1\[Minus]x) \[Minus] 64/27x^2) Zeta[2] \[Minus](4864/(81 x) + 2584/27
		\[Minus]4952/27 x \[Minus] 6944/81 x^2 \[Minus] 32/9(1+x)Zeta[2])H[0,x] \[Minus]16/27( 142
		+301 x) H[0,0,x] +( 640/(27x) \[Minus] 160/9 (1+x) + 640/27 x^2) Ht[\[Minus]1,0,x]
		\[Minus]16/27 (88/x \[Minus] 205 \[Minus] 457 x \[Minus] 88 x^2 )Ht[1,0,x] \[Minus]320/9 (1-x)Ht[0,-1,0,x]
		-128/3 (1+x) Ht[0,1,0,x] - (176/3 - 208/9 x )H[0,0,0,x]
	)
	+ cf ca^2 nf (
		+ 1580/(27 x) \[Minus] 13028/81 + 23804/81 x \[Minus] 1724/9 x^2
		+ (256/(27 x) + 64/9 (1\[Minus]x) \[Minus] 256/27 x^2) Zeta[2] +(2720/(81 x) + 632/27
		\[Minus] 3656/27 x + 3872/81 x^2 + 128/9 (1+x) Zeta[2] ) H[0,x] \[Minus](832/(27x) \[Minus] 1376/27
		\[Minus] 4064/27 x \[Minus] 128/9 x^2) H[0,0,x] \[Minus] 160/9 (4/(3x) \[Minus] 1 \[Minus] x + 4/3 x^2) Ht[\[Minus]1,0,x]
		+ (64/(9 x ) \[Minus] 2272/27 \[Minus] 3520/27 x \[Minus] 64/9 x^2)Ht[1,0,x] + 32/3(1+x)Ht[0,1,0,x]
		+ 320/9 (1\[Minus]x) Ht[0,\[Minus]1,0,x] + 320/9 (1+x) Ht[1,0,0,x] \[Minus] (32/9 + 256/3 x) H[0,0,0,x]
	)
	+cf^2 nf^2 (
		\[Minus] (1504/x + 1820 \[Minus] 860 x \[Minus] 2464 x^2)/81 \[Minus] (368/9 + 160/3 x
		+ 704/81 x^2) H[0,x] + 16/27(1+x) H[0,0,x] \[Minus] 352/27 (1+x) Ht[1,0,x]
	)
	+ cf ca nf^2 (
		+ 3280/(243 x) + 1472/81 \[Minus] 512/81 x \[Minus] 6160/243 x^2
		\[Minus] (704/(81 x) \[Minus] 832/27 \[Minus] 448/9 x \[Minus] 704/81 x^2 ) H[0,x]
		\[Minus] 32/27( 13 + 10 x ) H[0,0,x] + 352/27 (1+x) Ht[1,0,x]
	)
	+ cf nf^3 (
		\[Minus]128/(81x) \[Minus] 32/27 (1\[Minus]x) + 128/81 x^2 \[Minus]64/27(1+x)H[0,x]
	)
) //. hrep;

clog4 = Limit[(ReduceToHBasis[gqq3psXinf4] /. hrep) /((1-x) Log[1-x]^4), x -> 1] //.QCDConstantsRules //Expand;
clog3 = Limit[(ReduceToHBasis[gqq3psXinf3] /. hrep ) /((1-x)Log[1-x]^3) //.QCDConstantsRules, x-> 1];
gqq3psNinf = - (Lm14m1[n] clog4 + Lm13m1[n] clog3);
