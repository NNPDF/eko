*
* ..File: xkij2e.f    K_ij^(2)
* 
*
* ..The three-loop physical evolution kernel for the system (F_2,F_phi)  
*    of structure function at mu_r = Q, expanded in alpha_s/(4 pi). 
* 
* ..The distributions (in the mathematical sense) are given as in eq.
*    (B.26) of Floratos, Kounnas, Lacaze: Nucl. Phys. B192 (1981) 417.
*    The name-endings A, B, and C of the functions below correspond to
*    the kernel superscripts [2], [3], and [1] in that equation.
*
* ..The code uses the package of Gehrmann and Remiddi for the harmonic
*    polylogarithms published in hep-ph/0107173 = CPC 141 (2001) 296.
*
* ..Reference: G. Soar, S. Moch, J. Vermaseren and A. Vogt,
*              arXiv:0912.0369 [hep-ph]
*
* =====================================================================
*
*
* ..K_22, regular part
*
       FUNCTION XK222A (X, NF)
*
       IMPLICIT REAL*8 (A - Z)
       COMPLEX*16 HC1, HC2, HC3, HC4 
       INTEGER NF, N1, N2, NW, I1, I2, I3
       PARAMETER ( N1 = -1, N2 = 1, NW = 4 ) 
       DIMENSION HC1(N1:N2),HC2(N1:N2,N1:N2),HC3(N1:N2,N1:N2,N1:N2), 
     ,           HC4(N1:N2,N1:N2,N1:N2,N1:N2) 
       DIMENSION HR1(N1:N2),HR2(N1:N2,N1:N2),HR3(N1:N2,N1:N2,N1:N2), 
     ,           HR4(N1:N2,N1:N2,N1:N2,N1:N2) 
       DIMENSION HI1(N1:N2),HI2(N1:N2,N1:N2),HI3(N1:N2,N1:N2,N1:N2), 
     ,           HI4(N1:N2,N1:N2,N1:N2,N1:N2) 
       PARAMETER ( Z2 = 1.6449 34066 84822 64365 D0,
     ,             Z3 = 1.2020 56903 15959 42854 D0,
     ,             Z4 = 1.0823 23233 71113 81916 D0 )
*
* ..The soft coefficient for use in XK222B and XK222C
*
       COMMON / K22SOFT / K22A2, K22A1, K22A0
*
* ...Colour factors
*
       CF  = 4./3.D0
       CA  = 3.D0
*
* ...Some abbreviations
*
       DX = 1.D0/X
       DM = 1.D0/(1.D0-X)
       DP = 1.D0/(1.D0+X)
       DL1 = LOG (1.D0-X)
*
* ...The harmonic polylogs up to weight NW = 4 by Gehrmann and Remiddi
*
       CALL HPLOG (X, NW, HC1,HC2,HC3,HC4, HR1,HR2,HR3,HR4,
     ,            HI1,HI2,HI3,HI4, N1, N2) 
*
* ...The physical kernel in terms of the harmonic polylogs
*    (without the delta(1-x) part, but with the soft contribution)
*
      Kqq2 =
     &  + cf*ca**2 * (  - 29233.D0/405.D0 - 552187.D0/405.D0*x + 528.D0/
     &    5.D0*x**2 - 31.D0*z4 - 121.D0*z4*x + 176.D0/15.D0*dx - 80.D0*
     &    dp*z4 + 50689.D0/81.D0*dm + 192.D0*dm*z4 - 88.D0*z3 + 560.D0/
     &    3.D0*z3*x + 352.D0/3.D0*z3*dp - 40.D0/3.D0*z3*dm - 40.D0/9.D0
     &    *z2 + 304.D0*z2*x - 528.D0/5.D0*z2*x**3 + 1072.D0/9.D0*z2*dp
     &     - 3008.D0/9.D0*z2*dm - 192.D0*Hr1(-1)*z3 + 192.D0*Hr1(-1)*z3
     &    *x + 384.D0*Hr1(-1)*z3*dp + 472.D0/3.D0*Hr1(-1)*z2 - 232.D0/3.
     &    D0*Hr1(-1)*z2*x - 352.D0/3.D0*Hr1(-1)*z2*dp - 39488.D0/135.D0
     &    *Hr1(0) - 158228.D0/135.D0*Hr1(0)*x + 528.D0/5.D0*Hr1(0)*x**2
     &     - 176.D0/15.D0*Hr1(0)*dx - 248.D0/3.D0*Hr1(0)*dp + 21170.D0/
     &    27.D0*Hr1(0)*dm - 144.D0*Hr1(0)*z3*x - 128.D0*Hr1(0)*z3*dp + 
     &    128.D0*Hr1(0)*z3*dm - 4.D0*Hr1(0)*z2 + 28.D0/3.D0*Hr1(0)*z2*x
     &     + 160.D0/3.D0*Hr1(0)*z2*dp - 424.D0/3.D0*Hr1(0)*z2*dm + 2908.
     &    D0/27.D0*Hr1(1) - 20060.D0/27.D0*Hr1(1)*x + 9298.D0/27.D0*
     &    Hr1(1)*dm - 144.D0*Hr1(1)*z3 - 144.D0*Hr1(1)*z3*x + 288.D0*
     &    Hr1(1)*z3*dm )
      Kqq2 = Kqq2 + cf*ca**2 * ( 272.D0/3.D0*Hr1(1)*z2 + 608.D0/3.D0*
     &    Hr1(1)*z2*x - 176.D0*Hr1(1)*z2*dm + 256.D0*Hr2(-1,-1)*z2 - 
     &    256.D0*Hr2(-1,-1)*z2*x - 512.D0*Hr2(-1,-1)*z2*dp + 1688.D0/9.D
     &    0*Hr2(-1,0) + 2776.D0/9.D0*Hr2(-1,0)*x - 528.D0/5.D0*Hr2(-1,0
     &    )*x**3 + 176.D0/15.D0*Hr2(-1,0)*dx**2 + 2144.D0/9.D0*Hr2(-1,0
     &    )*dp - 176.D0*Hr2(-1,0)*z2 + 176.D0*Hr2(-1,0)*z2*x + 352.D0*
     &    Hr2(-1,0)*z2*dp - 136.D0*Hr2(0,-1)*z2 + 136.D0*Hr2(0,-1)*z2*x
     &     + 256.D0*Hr2(0,-1)*z2*dp - 484.D0/3.D0*Hr2(0,0) - 3220.D0/9.D
     &    0*Hr2(0,0)*x + 528.D0/5.D0*Hr2(0,0)*x**3 - 1072.D0/9.D0*Hr2(0
     &    ,0)*dp + 3976.D0/9.D0*Hr2(0,0)*dm + 36.D0*Hr2(0,0)*z2 - 68.D0
     &    *Hr2(0,0)*z2*x - 96.D0*Hr2(0,0)*z2*dp + 40.D0/9.D0*Hr2(0,1)
     &     + 40.D0/9.D0*Hr2(0,1)*x + 1936.D0/9.D0*Hr2(0,1)*dm - 40.D0*
     &    Hr2(0,1)*z2 + 24.D0*Hr2(0,1)*z2*x + 64.D0*Hr2(0,1)*z2*dp - 
     &    484.D0/9.D0*Hr2(1,0) - 484.D0/9.D0*Hr2(1,0)*x + 968.D0/9.D0*
     &    Hr2(1,0)*dm + 16.D0*Hr2(1,0)*z2 + 16.D0*Hr2(1,0)*z2*x - 32.D0
     &    *Hr2(1,0)*z2*dm )
      Kqq2 = Kqq2 + cf*ca**2 * (  - 484.D0/9.D0*Hr2(1,1) - 484.D0/9.D0*
     &    Hr2(1,1)*x + 968.D0/9.D0*Hr2(1,1)*dm + 368.D0/3.D0*Hr3(-1,-1,
     &    0) - 1040.D0/3.D0*Hr3(-1,-1,0)*x - 704.D0/3.D0*Hr3(-1,-1,0)*
     &    dp - 680.D0/3.D0*Hr3(-1,0,0) + 728.D0/3.D0*Hr3(-1,0,0)*x + 
     &    352.D0*Hr3(-1,0,0)*dp - 96.D0*Hr3(-1,0,1) - 96.D0*Hr3(-1,0,1)
     &    *x - 440.D0/3.D0*Hr3(0,-1,0) + 40.D0/3.D0*Hr3(0,-1,0)*x + 704.
     &    D0/3.D0*Hr3(0,-1,0)*dp + 128.D0*Hr3(0,-1,0)*dm - 392.D0/3.D0*
     &    Hr3(0,0,0)*x - 512.D0/3.D0*Hr3(0,0,0)*dp + 512.D0/3.D0*Hr3(0,
     &    0,0)*dm + 4.D0*Hr3(0,0,1) + 4.D0*Hr3(0,0,1)*x + 88.D0*Hr3(0,0
     &    ,1)*dm - 52.D0/3.D0*Hr3(1,0,0) - 388.D0/3.D0*Hr3(1,0,0)*x + 
     &    88.D0/3.D0*Hr3(1,0,0)*dm - 88.D0/3.D0*Hr3(1,0,1) - 88.D0/3.D0
     &    *Hr3(1,0,1)*x + 176.D0/3.D0*Hr3(1,0,1)*dm + 88.D0/3.D0*Hr3(1,
     &    1,0) + 88.D0/3.D0*Hr3(1,1,0)*x - 176.D0/3.D0*Hr3(1,1,0)*dm - 
     &    128.D0*Hr4(-1,-1,0,0) + 128.D0*Hr4(-1,-1,0,0)*x + 256.D0*Hr4(
     &    -1,-1,0,0)*dp - 256.D0*Hr4(-1,-1,0,1) + 256.D0*Hr4(-1,-1,0,1)
     &    *x )
      Kqq2 = Kqq2 + cf*ca**2 * ( 512.D0*Hr4(-1,-1,0,1)*dp + 48.D0*Hr4(
     &    -1,0,0,0) - 48.D0*Hr4(-1,0,0,0)*x - 96.D0*Hr4(-1,0,0,0)*dp + 
     &    128.D0*Hr4(-1,0,0,1) - 128.D0*Hr4(-1,0,0,1)*x - 256.D0*Hr4(-1
     &    ,0,0,1)*dp - 80.D0*Hr4(0,-1,-1,0) - 48.D0*Hr4(0,-1,-1,0)*x + 
     &    128.D0*Hr4(0,-1,-1,0)*dm + 88.D0*Hr4(0,-1,0,0) - 56.D0*Hr4(0,
     &    -1,0,0)*x - 128.D0*Hr4(0,-1,0,0)*dp - 32.D0*Hr4(0,-1,0,0)*dm
     &     + 96.D0*Hr4(0,-1,0,1) - 160.D0*Hr4(0,-1,0,1)*x - 256.D0*Hr4(
     &    0,-1,0,1)*dp + 64.D0*Hr4(0,-1,0,1)*dm + 8.D0*Hr4(0,0,-1,0) - 
     &    40.D0*Hr4(0,0,-1,0)*x - 32.D0*Hr4(0,0,-1,0)*dp + 32.D0*Hr4(0,
     &    0,-1,0)*dm + 40.D0*Hr4(0,0,0,0)*x + 32.D0*Hr4(0,0,0,0)*dp - 
     &    32.D0*Hr4(0,0,0,0)*dm - 36.D0*Hr4(0,0,0,1) + 28.D0*Hr4(0,0,0,
     &    1)*x + 64.D0*Hr4(0,0,0,1)*dp + 32.D0*Hr4(0,0,0,1)*dm + 28.D0*
     &    Hr4(0,1,0,0) + 28.D0*Hr4(0,1,0,0)*x - 64.D0*Hr4(0,1,0,0)*dm
     &     - 96.D0*Hr4(1,0,-1,0) - 96.D0*Hr4(1,0,-1,0)*x + 192.D0*Hr4(1
     &    ,0,-1,0)*dm + 48.D0*Hr4(1,0,0,0) + 48.D0*Hr4(1,0,0,0)*x - 96.D
     &    0*Hr4(1,0,0,0)*dm )
      Kqq2 = Kqq2 + cf*ca**2 * (  - 64.D0*Hr4(1,0,0,1) - 64.D0*Hr4(1,0,
     &    0,1)*x + 128.D0*Hr4(1,0,0,1)*dm + 64.D0*Hr4(1,1,0,0) + 64.D0*
     &    Hr4(1,1,0,0)*x - 128.D0*Hr4(1,1,0,0)*dm )
      Kqq2 = Kqq2 + cf**2*ca * (  - 5656.D0/45.D0 + 14566.D0/45.D0*x - 
     &    1056.D0/5.D0*x**2 - 12.D0*z4 + 28.D0*z4*x - 352.D0/15.D0*dx
     &     + 20.D0*dp*z4 + 11.D0*dm - 276.D0*dm*z4 + 1304.D0/3.D0*z3 + 
     &    664.D0/3.D0*z3*x - 488.D0/3.D0*z3*dp - 1328.D0/3.D0*z3*dm + 
     &    4240.D0/9.D0*z2 + 704.D0/9.D0*z2*x + 1056.D0/5.D0*z2*x**3 - 
     &    2144.D0/9.D0*z2*dp + 672.D0*Hr1(-1)*z3 - 672.D0*Hr1(-1)*z3*x
     &     - 1344.D0*Hr1(-1)*z3*dp - 1520.D0/3.D0*Hr1(-1)*z2 - 400.D0/3.
     &    D0*Hr1(-1)*z2*x + 416.D0/3.D0*Hr1(-1)*z2*dp + 3272.D0/45.D0*
     &    Hr1(0) + 6248.D0/5.D0*Hr1(0)*x - 1056.D0/5.D0*Hr1(0)*x**2 + 
     &    352.D0/15.D0*Hr1(0)*dx + 568.D0/3.D0*Hr1(0)*dp - 317.D0*Hr1(0
     &    )*dm - 144.D0*Hr1(0)*z3 + 400.D0*Hr1(0)*z3*x + 464.D0*Hr1(0)*
     &    z3*dp - 272.D0*Hr1(0)*z3*dm + 832.D0/3.D0*Hr1(0)*z2 + 1472.D0/
     &    3.D0*Hr1(0)*z2*x - 248.D0/3.D0*Hr1(0)*z2*dp - 376.D0/3.D0*
     &    Hr1(0)*z2*dm - 2156.D0/3.D0*Hr1(1) + 1056.D0*Hr1(1)*x + 384.D0
     &    *Hr1(1)*z3 + 384.D0*Hr1(1)*z3*x - 768.D0*Hr1(1)*z3*dm - 112.D0
     &    *Hr1(1)*z2 )
      Kqq2 = Kqq2 + cf**2*ca * (  - 240.D0*Hr1(1)*z2*x + 352.D0/3.D0*
     &    Hr1(1)*z2*dm - 896.D0*Hr2(-1,-1)*z2 + 896.D0*Hr2(-1,-1)*z2*x
     &     + 1792.D0*Hr2(-1,-1)*z2*dp - 3232.D0/9.D0*Hr2(-1,0) - 5408.D0
     &    /9.D0*Hr2(-1,0)*x + 1056.D0/5.D0*Hr2(-1,0)*x**3 - 352.D0/15.D0
     &    *Hr2(-1,0)*dx**2 - 4288.D0/9.D0*Hr2(-1,0)*dp + 672.D0*Hr2(-1,
     &    0)*z2 - 672.D0*Hr2(-1,0)*z2*x - 1344.D0*Hr2(-1,0)*z2*dp + 576.
     &    D0*Hr2(0,-1)*z2 - 480.D0*Hr2(0,-1)*z2*x - 1024.D0*Hr2(0,-1)*
     &    z2*dp - 96.D0*Hr2(0,-1)*z2*dm - 220.D0/3.D0*Hr2(0,0) - 1108.D0
     &    /9.D0*Hr2(0,0)*x - 1056.D0/5.D0*Hr2(0,0)*x**3 + 2144.D0/9.D0*
     &    Hr2(0,0)*dp - 148.D0*Hr2(0,0)*dm - 96.D0*Hr2(0,0)*z2 + 352.D0
     &    *Hr2(0,0)*z2*x + 416.D0*Hr2(0,0)*z2*dp - 128.D0*Hr2(0,0)*z2*
     &    dm - 4240.D0/9.D0*Hr2(0,1) - 6112.D0/9.D0*Hr2(0,1)*x + 2144.D0
     &    /9.D0*Hr2(0,1)*dm + 160.D0*Hr2(0,1)*z2 - 64.D0*Hr2(0,1)*z2*x
     &     - 224.D0*Hr2(0,1)*z2*dp - 64.D0*Hr2(0,1)*z2*dm - 796.D0/9.D0
     &    *Hr2(1,0) - 2140.D0/9.D0*Hr2(1,0)*x + 2936.D0/9.D0*Hr2(1,0)*
     &    dm )
      Kqq2 = Kqq2 + cf**2*ca * ( 32.D0*Hr2(1,0)*z2 + 32.D0*Hr2(1,0)*z2*
     &    x - 64.D0*Hr2(1,0)*z2*dm - 1024.D0/3.D0*Hr3(-1,-1,0) + 1792.D0
     &    /3.D0*Hr3(-1,-1,0)*x + 1408.D0/3.D0*Hr3(-1,-1,0)*dp + 2056.D0/
     &    3.D0*Hr3(-1,0,0) - 904.D0/3.D0*Hr3(-1,0,0)*x - 752.D0*Hr3(-1,
     &    0,0)*dp + 336.D0*Hr3(-1,0,1) + 432.D0*Hr3(-1,0,1)*x + 96.D0*
     &    Hr3(-1,0,1)*dp + 1072.D0/3.D0*Hr3(0,-1,0) + 208.D0/3.D0*Hr3(0
     &    ,-1,0)*x - 1552.D0/3.D0*Hr3(0,-1,0)*dp - 256.D0*Hr3(0,-1,0)*
     &    dm - 308.D0*Hr3(0,0,0) - 476.D0/3.D0*Hr3(0,0,0)*x + 1240.D0/3.
     &    D0*Hr3(0,0,0)*dp - 8.D0/3.D0*Hr3(0,0,0)*dm - 832.D0/3.D0*Hr3(
     &    0,0,1) - 1264.D0/3.D0*Hr3(0,0,1)*x - 48.D0*Hr3(0,0,1)*dp + 
     &    256.D0*Hr3(0,0,1)*dm - 484.D0/3.D0*Hr3(0,1,0) - 484.D0/3.D0*
     &    Hr3(0,1,0)*x + 880.D0/3.D0*Hr3(0,1,0)*dm - 88.D0*Hr3(0,1,1)
     &     - 88.D0*Hr3(0,1,1)*x + 176.D0*Hr3(0,1,1)*dm - 568.D0/3.D0*
     &    Hr3(1,0,0) + 104.D0/3.D0*Hr3(1,0,0)*x + 1168.D0/3.D0*Hr3(1,0,
     &    0)*dm - 176.D0/3.D0*Hr3(1,0,1) - 176.D0/3.D0*Hr3(1,0,1)*x + 
     &    352.D0/3.D0*Hr3(1,0,1)*dm )
      Kqq2 = Kqq2 + cf**2*ca * (  - 352.D0/3.D0*Hr3(1,1,0) - 352.D0/3.D0
     &    *Hr3(1,1,0)*x + 704.D0/3.D0*Hr3(1,1,0)*dm + 576.D0*Hr4(-1,-1,
     &    0,0) - 576.D0*Hr4(-1,-1,0,0)*x - 1152.D0*Hr4(-1,-1,0,0)*dp + 
     &    896.D0*Hr4(-1,-1,0,1) - 896.D0*Hr4(-1,-1,0,1)*x - 1792.D0*
     &    Hr4(-1,-1,0,1)*dp + 64.D0*Hr4(-1,0,-1,0) - 64.D0*Hr4(-1,0,-1,
     &    0)*x - 128.D0*Hr4(-1,0,-1,0)*dp - 272.D0*Hr4(-1,0,0,0) + 272.D
     &    0*Hr4(-1,0,0,0)*x + 544.D0*Hr4(-1,0,0,0)*dp - 512.D0*Hr4(-1,0
     &    ,0,1) + 512.D0*Hr4(-1,0,0,1)*x + 1024.D0*Hr4(-1,0,0,1)*dp - 
     &    32.D0*Hr4(-1,0,1,0) + 32.D0*Hr4(-1,0,1,0)*x + 64.D0*Hr4(-1,0,
     &    1,0)*dp + 320.D0*Hr4(0,-1,-1,0) + 128.D0*Hr4(0,-1,-1,0)*x - 
     &    128.D0*Hr4(0,-1,-1,0)*dp - 448.D0*Hr4(0,-1,-1,0)*dm - 464.D0*
     &    Hr4(0,-1,0,0) + 304.D0*Hr4(0,-1,0,0)*x + 672.D0*Hr4(0,-1,0,0)
     &    *dp + 160.D0*Hr4(0,-1,0,0)*dm - 416.D0*Hr4(0,-1,0,1) + 544.D0
     &    *Hr4(0,-1,0,1)*x + 960.D0*Hr4(0,-1,0,1)*dp - 128.D0*Hr4(0,-1,
     &    0,1)*dm - 128.D0*Hr4(0,0,-1,0) + 128.D0*Hr4(0,0,-1,0)*x + 160.
     &    D0*Hr4(0,0,-1,0)*dp )
      Kqq2 = Kqq2 + cf**2*ca * (  - 32.D0*Hr4(0,0,-1,0)*dm - 224.D0*
     &    Hr4(0,0,0,0)*x - 160.D0*Hr4(0,0,0,0)*dp + 160.D0*Hr4(0,0,0,0)
     &    *dm + 96.D0*Hr4(0,0,0,1) - 224.D0*Hr4(0,0,0,1)*x - 320.D0*
     &    Hr4(0,0,0,1)*dp + 32.D0*Hr4(0,0,0,1)*dm - 32.D0*Hr4(0,0,1,0)*
     &    x - 32.D0*Hr4(0,0,1,0)*dp + 32.D0*Hr4(0,0,1,0)*dm - 48.D0*
     &    Hr4(0,1,0,0) - 48.D0*Hr4(0,1,0,0)*x + 160.D0*Hr4(0,1,0,0)*dm
     &     + 256.D0*Hr4(1,0,-1,0) + 256.D0*Hr4(1,0,-1,0)*x - 512.D0*
     &    Hr4(1,0,-1,0)*dm - 176.D0*Hr4(1,0,0,0) - 176.D0*Hr4(1,0,0,0)*
     &    x + 352.D0*Hr4(1,0,0,0)*dm + 128.D0*Hr4(1,0,0,1) + 128.D0*
     &    Hr4(1,0,0,1)*x - 256.D0*Hr4(1,0,0,1)*dm - 128.D0*Hr4(1,1,0,0)
     &     - 128.D0*Hr4(1,1,0,0)*x + 256.D0*Hr4(1,1,0,0)*dm )
      Kqq2 = Kqq2 + cf**3 * (  - 62.D0 + 62.D0*x - 28.D0*z4 + 252.D0*z4
     &    *x + 280.D0*dp*z4 + 72.D0*dm*z4 - 48.D0*z3 - 720.D0*z3*x - 
     &    144.D0*z3*dp - 308.D0*z2 - 372.D0*z2*x - 576.D0*Hr1(-1)*z3 + 
     &    576.D0*Hr1(-1)*z3*x + 1152.D0*Hr1(-1)*z3*dp + 384.D0*Hr1(-1)*
     &    z2 + 576.D0*Hr1(-1)*z2*x + 192.D0*Hr1(-1)*z2*dp + 24.D0*Hr1(0
     &    ) - 560.D0*Hr1(0)*x - 48.D0*Hr1(0)*dp - 6.D0*Hr1(0)*dm + 288.D
     &    0*Hr1(0)*z3 - 224.D0*Hr1(0)*z3*x - 416.D0*Hr1(0)*z3*dp + 32.D0
     &    *Hr1(0)*z3*dm - 96.D0*Hr1(0)*z2 - 448.D0*Hr1(0)*z2*x - 48.D0*
     &    Hr1(0)*z2*dp - 48.D0*Hr1(0)*z2*dm + 560.D0*Hr1(1) - 560.D0*
     &    Hr1(1)*x - 192.D0*Hr1(1)*z3 - 192.D0*Hr1(1)*z3*x + 384.D0*
     &    Hr1(1)*z3*dm + 96.D0*Hr1(1)*z2 - 96.D0*Hr1(1)*z2*x + 768.D0*
     &    Hr2(-1,-1)*z2 - 768.D0*Hr2(-1,-1)*z2*x - 1536.D0*Hr2(-1,-1)*
     &    z2*dp - 32.D0*Hr2(-1,0) - 32.D0*Hr2(-1,0)*x - 640.D0*Hr2(-1,0
     &    )*z2 + 640.D0*Hr2(-1,0)*z2*x + 1280.D0*Hr2(-1,0)*z2*dp - 608.D
     &    0*Hr2(0,-1)*z2 + 416.D0*Hr2(0,-1)*z2*x + 1024.D0*Hr2(0,-1)*z2
     &    *dp )
      Kqq2 = Kqq2 + cf**3 * ( 192.D0*Hr2(0,-1)*z2*dm - 44.D0*Hr2(0,0)
     &     + 356.D0*Hr2(0,0)*x + 52.D0*Hr2(0,0)*dm + 240.D0*Hr2(0,0)*z2
     &     - 240.D0*Hr2(0,0)*z2*x - 448.D0*Hr2(0,0)*z2*dp + 308.D0*Hr2(
     &    0,1) + 340.D0*Hr2(0,1)*x - 96.D0*Hr2(0,1)*z2 + 96.D0*Hr2(0,1)
     &    *z2*x + 192.D0*Hr2(0,1)*z2*dp - 16.D0*Hr2(1,0) + 16.D0*Hr2(1,
     &    0)*x + 192.D0*Hr3(-1,-1,0) + 192.D0*Hr3(-1,-1,0)*x - 464.D0*
     &    Hr3(-1,0,0) - 368.D0*Hr3(-1,0,0)*x + 96.D0*Hr3(-1,0,0)*dp - 
     &    288.D0*Hr3(-1,0,1) - 480.D0*Hr3(-1,0,1)*x - 192.D0*Hr3(-1,0,1
     &    )*dp - 128.D0*Hr3(0,-1,0) - 192.D0*Hr3(0,-1,0)*x + 96.D0*Hr3(
     &    0,-1,0)*dp + 120.D0*Hr3(0,0,0) + 248.D0*Hr3(0,0,0)*x - 144.D0
     &    *Hr3(0,0,0)*dp + 96.D0*Hr3(0,0,1) + 256.D0*Hr3(0,0,1)*x + 96.D
     &    0*Hr3(0,0,1)*dp + 72.D0*Hr3(0,1,0) + 8.D0*Hr3(0,1,0)*x - 96.D0
     &    *Hr3(0,1,0)*dm + 96.D0*Hr3(1,0,0) + 96.D0*Hr3(1,0,0)*x - 192.D
     &    0*Hr3(1,0,0)*dm - 640.D0*Hr4(-1,-1,0,0) + 640.D0*Hr4(-1,-1,0,
     &    0)*x + 1280.D0*Hr4(-1,-1,0,0)*dp - 768.D0*Hr4(-1,-1,0,1) + 
     &    768.D0*Hr4(-1,-1,0,1)*x )
      Kqq2 = Kqq2 + cf**3 * ( 1536.D0*Hr4(-1,-1,0,1)*dp - 128.D0*Hr4(-1
     &    ,0,-1,0) + 128.D0*Hr4(-1,0,-1,0)*x + 256.D0*Hr4(-1,0,-1,0)*dp
     &     + 352.D0*Hr4(-1,0,0,0) - 352.D0*Hr4(-1,0,0,0)*x - 704.D0*
     &    Hr4(-1,0,0,0)*dp + 512.D0*Hr4(-1,0,0,1) - 512.D0*Hr4(-1,0,0,1
     &    )*x - 1024.D0*Hr4(-1,0,0,1)*dp + 64.D0*Hr4(-1,0,1,0) - 64.D0*
     &    Hr4(-1,0,1,0)*x - 128.D0*Hr4(-1,0,1,0)*dp - 320.D0*Hr4(0,-1,
     &    -1,0) - 64.D0*Hr4(0,-1,-1,0)*x + 256.D0*Hr4(0,-1,-1,0)*dp + 
     &    384.D0*Hr4(0,-1,-1,0)*dm + 576.D0*Hr4(0,-1,0,0) - 384.D0*Hr4(
     &    0,-1,0,0)*x - 832.D0*Hr4(0,-1,0,0)*dp - 192.D0*Hr4(0,-1,0,0)*
     &    dm + 448.D0*Hr4(0,-1,0,1) - 448.D0*Hr4(0,-1,0,1)*x - 896.D0*
     &    Hr4(0,-1,0,1)*dp + 224.D0*Hr4(0,0,-1,0) - 96.D0*Hr4(0,0,-1,0)
     &    *x - 192.D0*Hr4(0,0,-1,0)*dp - 64.D0*Hr4(0,0,-1,0)*dm - 112.D0
     &    *Hr4(0,0,0,0) + 176.D0*Hr4(0,0,0,0)*x + 192.D0*Hr4(0,0,0,0)*
     &    dp - 64.D0*Hr4(0,0,0,0)*dm - 240.D0*Hr4(0,0,0,1) + 144.D0*
     &    Hr4(0,0,0,1)*x + 384.D0*Hr4(0,0,0,1)*dp + 64.D0*Hr4(0,0,0,1)*
     &    dm )
      Kqq2 = Kqq2 + cf**3 * (  - 128.D0*Hr4(0,0,1,0) - 64.D0*Hr4(0,0,1,
     &    0)*x + 64.D0*Hr4(0,0,1,0)*dp + 128.D0*Hr4(0,0,1,0)*dm - 64.D0
     &    *Hr4(0,0,1,1) - 64.D0*Hr4(0,0,1,1)*x + 128.D0*Hr4(0,0,1,1)*dm
     &     - 80.D0*Hr4(0,1,0,0) - 80.D0*Hr4(0,1,0,0)*x + 64.D0*Hr4(0,1,
     &    0,0)*dm - 64.D0*Hr4(0,1,0,1) - 64.D0*Hr4(0,1,0,1)*x + 128.D0*
     &    Hr4(0,1,0,1)*dm - 64.D0*Hr4(0,1,1,0) - 64.D0*Hr4(0,1,1,0)*x
     &     + 128.D0*Hr4(0,1,1,0)*dm - 128.D0*Hr4(1,0,-1,0) - 128.D0*
     &    Hr4(1,0,-1,0)*x + 256.D0*Hr4(1,0,-1,0)*dm + 64.D0*Hr4(1,0,0,0
     &    ) + 64.D0*Hr4(1,0,0,0)*x - 128.D0*Hr4(1,0,0,0)*dm - 128.D0*
     &    Hr4(1,0,0,1) - 128.D0*Hr4(1,0,0,1)*x + 256.D0*Hr4(1,0,0,1)*dm
     &     - 64.D0*Hr4(1,0,1,0) - 64.D0*Hr4(1,0,1,0)*x + 128.D0*Hr4(1,0
     &    ,1,0)*dm )
      Kqq2 = Kqq2 + nf*cf*ca * ( 137471.D0/405.D0 + 297014.D0/405.D0*x
     &     - 6752.D0/135.D0*x**2 + 22.D0*z4 + 62.D0*z4*x - 80143.D0/135.
     &    D0*dx - 15062.D0/81.D0*dm + 8.D0/3.D0*z3 - 280.D0*z3*x - 224.D
     &    0/3.D0*z3*x**2 + 256.D0/3.D0*z3*dx - 64.D0/3.D0*z3*dp - 128.D0
     &    /3.D0*z3*dm - 364.D0/9.D0*z2 + 676.D0/9.D0*z2*x - 640.D0/9.D0
     &    *z2*x**2 + 96.D0/5.D0*z2*x**3 + 1472.D0/9.D0*z2*dx - 160.D0/9.
     &    D0*z2*dp + 96.D0*z2*dm + 176.D0/3.D0*Hr1(-1)*z2 + 304.D0/3.D0
     &    *Hr1(-1)*z2*x + 32.D0/3.D0*Hr1(-1)*z2*x**2 + 32.D0/3.D0*Hr1(
     &    -1)*z2*dx + 64.D0/3.D0*Hr1(-1)*z2*dp - 96914.D0/135.D0*Hr1(0)
     &     + 23656.D0/135.D0*Hr1(0)*x + 11368.D0/135.D0*Hr1(0)*x**2 - 
     &    7912.D0/135.D0*Hr1(0)*dx + 32.D0/3.D0*Hr1(0)*dp - 7072.D0/27.D
     &    0*Hr1(0)*dm + 64.D0*Hr1(0)*z3 + 32.D0*Hr1(0)*z3*x - 28.D0*
     &    Hr1(0)*z2 - 100.D0/3.D0*Hr1(0)*z2*x - 64.D0/3.D0*Hr1(0)*z2*
     &    x**2 + 64.D0/3.D0*Hr1(0)*z2*dx - 16.D0/3.D0*Hr1(0)*z2*dp + 64.
     &    D0/3.D0*Hr1(0)*z2*dm - 8.D0/27.D0*Hr1(1) + 5356.D0/27.D0*Hr1(
     &    1)*x )
      Kqq2 = Kqq2 + nf*cf*ca * (  - 472.D0/9.D0*Hr1(1)*x**2 + 508.D0/9.D
     &    0*Hr1(1)*dx - 3104.D0/27.D0*Hr1(1)*dm + 64.D0/3.D0*Hr1(1)*z2
     &     - 224.D0/3.D0*Hr1(1)*z2*x - 32.D0/3.D0*Hr1(1)*z2*x**2 + 32.D0
     &    /3.D0*Hr1(1)*z2*dx + 32.D0*Hr1(1)*z2*dm + 2320.D0/9.D0*Hr2(-1
     &    ,0) + 1040.D0/9.D0*Hr2(-1,0)*x + 736.D0/9.D0*Hr2(-1,0)*x**2
     &     + 96.D0/5.D0*Hr2(-1,0)*x**3 + 1888.D0/9.D0*Hr2(-1,0)*dx - 32.
     &    D0/15.D0*Hr2(-1,0)*dx**2 - 320.D0/9.D0*Hr2(-1,0)*dp + 32.D0*
     &    Hr2(0,-1)*z2 - 32.D0*Hr2(0,-1)*z2*x + 3500.D0/9.D0*Hr2(0,0)
     &     - 848.D0/3.D0*Hr2(0,0)*x + 992.D0/3.D0*Hr2(0,0)*x**2 - 96.D0/
     &    5.D0*Hr2(0,0)*x**3 + 112.D0/9.D0*Hr2(0,0)*dx + 160.D0/9.D0*
     &    Hr2(0,0)*dp - 1216.D0/9.D0*Hr2(0,0)*dm + 8.D0*Hr2(0,0)*z2 - 8.
     &    D0*Hr2(0,0)*z2*x + 364.D0/9.D0*Hr2(0,1) + 364.D0/9.D0*Hr2(0,1
     &    )*x + 640.D0/9.D0*Hr2(0,1)*x**2 + 416.D0/9.D0*Hr2(0,1)*dx - 
     &    704.D0/9.D0*Hr2(0,1)*dm + 32.D0*Hr2(0,1)*z2 + 32.D0*Hr2(0,1)*
     &    z2*x - 412.D0/9.D0*Hr2(1,0) + 188.D0/9.D0*Hr2(1,0)*x + 64.D0/
     &    3.D0*Hr2(1,0)*x**2 )
      Kqq2 = Kqq2 + nf*cf*ca * ( 128.D0/3.D0*Hr2(1,0)*dx - 352.D0/9.D0*
     &    Hr2(1,0)*dm + 176.D0/9.D0*Hr2(1,1) + 176.D0/9.D0*Hr2(1,1)*x
     &     - 352.D0/9.D0*Hr2(1,1)*dm + 160.D0/3.D0*Hr3(-1,-1,0) + 416.D0
     &    /3.D0*Hr3(-1,-1,0)*x - 64.D0/3.D0*Hr3(-1,-1,0)*x**2 - 64.D0/3.
     &    D0*Hr3(-1,-1,0)*dx + 128.D0/3.D0*Hr3(-1,-1,0)*dp + 32.D0/3.D0
     &    *Hr3(-1,0,0) - 224.D0/3.D0*Hr3(-1,0,0)*x - 128.D0/3.D0*Hr3(-1
     &    ,0,0)*x**2 - 128.D0/3.D0*Hr3(-1,0,0)*dx - 64.D0*Hr3(-1,0,0)*
     &    dp - 32.D0*Hr3(-1,0,1) - 32.D0*Hr3(-1,0,1)*x - 64.D0/3.D0*
     &    Hr3(-1,0,1)*x**2 - 64.D0/3.D0*Hr3(-1,0,1)*dx - 136.D0/3.D0*
     &    Hr3(0,-1,0) - 280.D0/3.D0*Hr3(0,-1,0)*x - 64.D0*Hr3(0,-1,0)*
     &    x**2 + 128.D0/3.D0*Hr3(0,-1,0)*dx - 128.D0/3.D0*Hr3(0,-1,0)*
     &    dp - 32.D0*Hr3(0,-1,0)*dm - 120.D0*Hr3(0,0,0) - 688.D0/3.D0*
     &    Hr3(0,0,0)*x + 80.D0/3.D0*Hr3(0,0,0)*dp - 80.D0/3.D0*Hr3(0,0,
     &    0)*dm + 28.D0*Hr3(0,0,1) - 60.D0*Hr3(0,0,1)*x + 64.D0/3.D0*
     &    Hr3(0,0,1)*x**2 + 64.D0/3.D0*Hr3(0,0,1)*dx - 16.D0*Hr3(0,0,1)
     &    *dm )
      Kqq2 = Kqq2 + nf*cf*ca * ( 40.D0/3.D0*Hr3(0,1,0) - 104.D0/3.D0*
     &    Hr3(0,1,0)*x + 64.D0/3.D0*Hr3(0,1,0)*x**2 - 164.D0/3.D0*Hr3(1
     &    ,0,0) + 244.D0/3.D0*Hr3(1,0,0)*x + 64.D0/3.D0*Hr3(1,0,0)*x**2
     &     - 64.D0/3.D0*Hr3(1,0,0)*dx - 16.D0/3.D0*Hr3(1,0,0)*dm + 16.D0
     &    /3.D0*Hr3(1,0,1) + 16.D0/3.D0*Hr3(1,0,1)*x - 32.D0/3.D0*Hr3(1
     &    ,0,1)*dm - 16.D0/3.D0*Hr3(1,1,0) - 16.D0/3.D0*Hr3(1,1,0)*x + 
     &    32.D0/3.D0*Hr3(1,1,0)*dm + 64.D0*Hr4(0,-1,-1,0) - 64.D0*Hr4(0
     &    ,-1,-1,0)*x + 32.D0*Hr4(0,-1,0,0) - 32.D0*Hr4(0,-1,0,0)*x + 
     &    48.D0*Hr4(0,0,-1,0) - 16.D0*Hr4(0,0,-1,0)*x + 64.D0*Hr4(0,0,0
     &    ,0) - 48.D0*Hr4(0,0,0,0)*x - 8.D0*Hr4(0,0,0,1) - 8.D0*Hr4(0,0
     &    ,0,1)*x - 32.D0*Hr4(0,0,1,0) - 32.D0*Hr4(0,0,1,0)*x - 56.D0*
     &    Hr4(0,1,0,0) - 56.D0*Hr4(0,1,0,0)*x )
      Kqq2 = Kqq2 + nf*cf**2 * (  - 1618.D0/15.D0 + 6244.D0/45.D0*x - 
     &    3916.D0/45.D0*x**2 + 88.D0*z4 + 48.D0*z4*x + 1792.D0/15.D0*dx
     &     - 134.D0/3.D0*dm - 224.D0/3.D0*z3 + 752.D0/3.D0*z3*x + 64.D0/
     &    3.D0*z3*dx + 128.D0/3.D0*z3*dp + 416.D0/3.D0*z3*dm + 1568.D0/
     &    9.D0*z2 + 728.D0/3.D0*z2*x + 256.D0/9.D0*z2*x**2 - 256.D0/5.D0
     &    *z2*x**3 - 640.D0/9.D0*z2*dx + 320.D0/9.D0*z2*dp - 112.D0/3.D0
     &    *Hr1(-1)*z2 - 368.D0/3.D0*Hr1(-1)*z2*x - 128.D0/3.D0*Hr1(-1)*
     &    z2*dp - 1184.D0/15.D0*Hr1(0) + 1062.D0/5.D0*Hr1(0)*x + 4904.D0
     &    /45.D0*Hr1(0)*x**2 + 1064.D0/45.D0*Hr1(0)*dx - 64.D0/3.D0*
     &    Hr1(0)*dp + 38.D0*Hr1(0)*dm + 32.D0*Hr1(0)*z3 - 32.D0*Hr1(0)*
     &    z3*x + 32.D0/3.D0*Hr1(0)*z2 + 176.D0/3.D0*Hr1(0)*z2*x - 256.D0
     &    /3.D0*Hr1(0)*z2*x**2 - 64.D0/3.D0*Hr1(0)*z2*dx + 32.D0/3.D0*
     &    Hr1(0)*z2*dp + 160.D0/3.D0*Hr1(0)*z2*dm - 712.D0/3.D0*Hr1(1)
     &     + 92.D0*Hr1(1)*x + 232.D0/9.D0*Hr1(1)*x**2 + 596.D0/9.D0*
     &    Hr1(1)*dx - 8.D0*Hr1(1)*dm - 48.D0*Hr1(1)*z2 + 112.D0*Hr1(1)*
     &    z2*x )
      Kqq2 = Kqq2 + nf*cf**2 * (  - 64.D0/3.D0*Hr1(1)*z2*dm + 2608.D0/9.
     &    D0*Hr2(-1,0) + 2992.D0/9.D0*Hr2(-1,0)*x - 256.D0/5.D0*Hr2(-1,
     &    0)*x**3 + 256.D0/45.D0*Hr2(-1,0)*dx**2 + 640.D0/9.D0*Hr2(-1,0
     &    )*dp - 32.D0*Hr2(0,-1)*z2 + 32.D0*Hr2(0,-1)*z2*x - 764.D0/3.D0
     &    *Hr2(0,0) - 1804.D0/9.D0*Hr2(0,0)*x - 736.D0/9.D0*Hr2(0,0)*
     &    x**2 + 256.D0/5.D0*Hr2(0,0)*x**3 - 320.D0/9.D0*Hr2(0,0)*dp + 
     &    24.D0*Hr2(0,0)*dm + 96.D0*Hr2(0,0)*z2 + 96.D0*Hr2(0,0)*z2*x
     &     - 1568.D0/9.D0*Hr2(0,1) + 808.D0/9.D0*Hr2(0,1)*x - 256.D0/9.D
     &    0*Hr2(0,1)*x**2 + 640.D0/9.D0*Hr2(0,1)*dx - 320.D0/9.D0*Hr2(0
     &    ,1)*dm - 32.D0*Hr2(0,1)*z2 - 32.D0*Hr2(0,1)*z2*x - 1016.D0/9.D
     &    0*Hr2(1,0) + 1480.D0/9.D0*Hr2(1,0)*x - 160.D0/3.D0*Hr2(1,0)*
     &    x**2 + 160.D0/3.D0*Hr2(1,0)*dx - 464.D0/9.D0*Hr2(1,0)*dm - 
     &    224.D0/3.D0*Hr3(-1,-1,0) - 736.D0/3.D0*Hr3(-1,-1,0)*x - 256.D0
     &    /3.D0*Hr3(-1,-1,0)*dp - 16.D0/3.D0*Hr3(-1,0,0) + 496.D0/3.D0*
     &    Hr3(-1,0,0)*x + 128.D0*Hr3(-1,0,0)*dp + 128.D0/3.D0*Hr3(0,-1,
     &    0) )
      Kqq2 = Kqq2 + nf*cf**2 * ( 32.D0*Hr3(0,-1,0)*x + 256.D0/3.D0*Hr3(
     &    0,-1,0)*dp + 64.D0*Hr3(0,-1,0)*dm + 72.D0*Hr3(0,0,0) - 104.D0/
     &    3.D0*Hr3(0,0,0)*x + 128.D0*Hr3(0,0,0)*x**2 - 160.D0/3.D0*Hr3(
     &    0,0,0)*dp - 64.D0/3.D0*Hr3(0,0,0)*dm - 32.D0/3.D0*Hr3(0,0,1)
     &     - 80.D0/3.D0*Hr3(0,0,1)*x + 256.D0/3.D0*Hr3(0,0,1)*x**2 + 64.
     &    D0/3.D0*Hr3(0,0,1)*dx - 64.D0*Hr3(0,0,1)*dm + 40.D0/3.D0*Hr3(
     &    0,1,0) + 88.D0/3.D0*Hr3(0,1,0)*x + 128.D0/3.D0*Hr3(0,1,0)*
     &    x**2 + 64.D0/3.D0*Hr3(0,1,0)*dx - 160.D0/3.D0*Hr3(0,1,0)*dm
     &     + 16.D0*Hr3(0,1,1) + 16.D0*Hr3(0,1,1)*x - 32.D0*Hr3(0,1,1)*
     &    dm + 256.D0/3.D0*Hr3(1,0,0) - 224.D0/3.D0*Hr3(1,0,0)*x - 160.D
     &    0/3.D0*Hr3(1,0,0)*dm + 32.D0/3.D0*Hr3(1,0,1) + 32.D0/3.D0*
     &    Hr3(1,0,1)*x - 64.D0/3.D0*Hr3(1,0,1)*dm + 64.D0/3.D0*Hr3(1,1,
     &    0) + 64.D0/3.D0*Hr3(1,1,0)*x - 128.D0/3.D0*Hr3(1,1,0)*dm - 64.
     &    D0*Hr4(0,-1,-1,0) + 64.D0*Hr4(0,-1,-1,0)*x + 32.D0*Hr4(0,-1,0
     &    ,0) - 32.D0*Hr4(0,-1,0,0)*x + 64.D0*Hr4(0,0,-1,0) - 64.D0*
     &    Hr4(0,0,0,0) )
      Kqq2 = Kqq2 + nf*cf**2 * (  - 64.D0*Hr4(0,0,0,0)*x - 96.D0*Hr4(0,
     &    0,0,1) - 96.D0*Hr4(0,0,0,1)*x - 32.D0*Hr4(0,0,1,0) - 32.D0*
     &    Hr4(0,0,1,0)*x + 32.D0*Hr4(0,1,0,0) + 32.D0*Hr4(0,1,0,0)*x )
      Kqq2 = Kqq2 + nf**2*cf * ( 9982.D0/81.D0 - 9080.D0/81.D0*x + 872.D
     &    0/81.D0*x**2 - 4310.D0/81.D0*dx + 940.D0/81.D0*dm - 32.D0/3.D0
     &    *z3 - 32.D0/3.D0*z3*x + 32.D0/9.D0*z2 - 160.D0/9.D0*z2*x - 64.
     &    D0/9.D0*z2*dx - 64.D0/9.D0*z2*dm + 1100.D0/27.D0*Hr1(0) - 88.D
     &    0/27.D0*Hr1(0)*x - 320.D0/9.D0*Hr1(0)*x**2 - 848.D0/27.D0*
     &    Hr1(0)*dx + 536.D0/27.D0*Hr1(0)*dm - 128.D0/27.D0*Hr1(1) - 
     &    272.D0/27.D0*Hr1(1)*x + 232.D0/27.D0*Hr1(1)*dm - 64.D0/3.D0*
     &    Hr2(-1,0) - 64.D0/3.D0*Hr2(-1,0)*x - 64.D0/9.D0*Hr2(-1,0)*
     &    x**2 - 64.D0/9.D0*Hr2(-1,0)*dx + 136.D0/9.D0*Hr2(0,0) + 712.D0
     &    /9.D0*Hr2(0,0)*x - 160.D0/9.D0*Hr2(0,0)*x**2 - 32.D0/3.D0*
     &    Hr2(0,0)*dx + 32.D0/3.D0*Hr2(0,0)*dm - 32.D0/9.D0*Hr2(0,1) - 
     &    32.D0/9.D0*Hr2(0,1)*x + 64.D0/9.D0*Hr2(0,1)*dm - 40.D0/9.D0*
     &    Hr2(1,0) + 8.D0/9.D0*Hr2(1,0)*x + 32.D0/9.D0*Hr2(1,0)*x**2 - 
     &    32.D0/9.D0*Hr2(1,0)*dx + 32.D0/9.D0*Hr2(1,0)*dm - 16.D0/9.D0*
     &    Hr2(1,1) - 16.D0/9.D0*Hr2(1,1)*x + 32.D0/9.D0*Hr2(1,1)*dm + 
     &    16.D0*Hr3(0,0,0) )
      Kqq2 = Kqq2 + nf**2*cf * ( 16.D0*Hr3(0,0,0)*x - 16.D0/3.D0*Hr3(0,
     &    1,0) - 16.D0/3.D0*Hr3(0,1,0)*x )
*
* ...The soft (`+'-distribution) part of the kernel
*
       K22A2 =
     &    +16.D0/9.D0*cf*nf**2
     &    -176.D0/9.D0*cf*ca*nf
     &    +484.D0/9.D0*cf*ca**2
       K22A1 =
     &    -232.D0/27.D0*cf*nf**2
     &    +3104.D0/27.D0*cf*ca*nf
     &    -9298.D0/27.D0*cf*ca**2
     &    +8.D0*cf**2*nf
     &    -32.D0/3.D0*z2*cf*ca*nf
     &    +176.D0/3.D0*z2*cf*ca**2
       K22A0 =
     &    +940.D0/81.D0*cf*nf**2
     &    -15062.D0/81.D0*cf*ca*nf
     &    +50689.D0/81.D0*cf*ca**2
     &    -134.D0/3.D0*cf**2*nf
     &    +11.D0*cf**2*ca
     &    +16.D0*z3*cf*ca*nf
     &    -264.D0*z3*cf*ca**2
     &    +176.D0*z3*cf**2*ca
     &    -32.D0/9.D0*z2*cf*nf**2
     &    +512.D0/9.D0*z2*cf*ca*nf
     &    -680.D0/3.D0*z2*cf*ca**2
     &    +16.D0*z2*cf**2*nf
     &    -88.D0*z2*cf**2*ca
     &    +176.D0/5.D0*z2**2*cf*ca**2
*
       Kqq2L = DM* ( DL1**2* K22A2 + DL1* K22A1 + K22A0 )

* ...The regular piece of the kernel
*
       XK222A = Kqq2 - Kqq2L
*
       RETURN
       END
*
* ---------------------------------------------------------------------
*
*
* ..The singular (soft) piece.
*
       FUNCTION XK222B (Y, NF)
       IMPLICIT REAL*8 (A - Z)
       INTEGER NF
*
       COMMON / K22SOFT / K22A2, K22A1, K22A0
*
       DL1 = LOG (1.D0-Y)
       DM  = 1.D0/(1.D0-Y)
*
       XK222B  = DM* ( DL1**2* K22A2 + DL1* K22A1 + K22A0 )
*
       RETURN
       END
*
* ---------------------------------------------------------------------
*
*
* ..The 'local' piece.
*
       FUNCTION XK222C (Y, NF)
*
       IMPLICIT REAL*8 (A - Z)
       INTEGER NF
       PARAMETER ( Z2 = 1.6449 34066 84822 64365 D0,
     ,             Z3 = 1.2020 56903 15959 42854 D0,
     ,             Z4 = 1.0823 23233 71113 81916 D0,
     ,             Z5 = 1.0369 27755 14336 99263 D0 )
*
       COMMON / K22SOFT / K22A2, K22A1, K22A0
*
* ...Colour factors
*
       CF  = 4./3.D0
       CA  = 3.D0
*
* ...The coefficient of delta(1-x)
*
       K22DELT = 
     &    +406.D0/27.D0*cf*nf**2
     &    -5516.D0/27.D0*cf*ca*nf
     &    +16540.D0/27.D0*cf*ca**2
     &    -239.D0/6.D0*cf**2*nf
     &    +94.D0/3.D0*cf**2*ca
     &    +29.D0/2.D0*cf**3
     &    +40.D0*z5*cf*ca**2
     &    +120.D0*z5*cf**2*ca
     &    -240.D0*z5*cf**3
     &    +224.D0/3.D0*z3*cf*ca*nf
     &    -1544.D0/3.D0*z3*cf*ca**2
     &    -400.D0/3.D0*z3*cf**2*nf
     &    +2296.D0/3.D0*z3*cf**2*ca
     &    +68.D0*z3*cf**3
     &    +536.D0/27.D0*z2*cf*nf**2
     &    -7216.D0/27.D0*z2*cf*ca*nf
     &    +22286.D0/27.D0*z2*cf*ca**2
     &    +146.D0/3.D0*z2*cf**2*nf
     &    -1235.D0/3.D0*z2*cf**2*ca
     &    +18.D0*z2*cf**3
     &    +16.D0*z2*z3*cf**2*ca
     &    -32.D0*z2*z3*cf**3
     &    +296.D0/15.D0*z2**2*cf*ca*nf
     &    -1592.D0/15.D0*z2**2*cf*ca**2
     &    +208.D0/15.D0*z2**2*cf**2*nf
     &    -856.D0/15.D0*z2**2*cf**2*ca
     &    +288.D0/5.D0*z2**2*cf**3
*
       DL1 = LOG (1.D0-Y)
*
       XK222C = DL1**3 * K22A2/3.D0 + DL1**2 * K22A1/2.D0 
     1        + DL1 * K22A0 + K22DELT
*
       RETURN
       END
*
* ---------------------------------------------------------------------
*
*
* ..K_2phi 
*
       FUNCTION XK2P2A (X, NF)
*
       IMPLICIT REAL*8 (A - Z)
       COMPLEX*16 HC1, HC2, HC3, HC4
       INTEGER NF, N1, N2, NW, I1, I2, I3
       PARAMETER ( N1 = -1, N2 = 1, NW = 4 )
       DIMENSION HC1(N1:N2),HC2(N1:N2,N1:N2),HC3(N1:N2,N1:N2,N1:N2),
     ,           HC4(N1:N2,N1:N2,N1:N2,N1:N2)
       DIMENSION HR1(N1:N2),HR2(N1:N2,N1:N2),HR3(N1:N2,N1:N2,N1:N2),
     ,           HR4(N1:N2,N1:N2,N1:N2,N1:N2)
       DIMENSION HI1(N1:N2),HI2(N1:N2,N1:N2),HI3(N1:N2,N1:N2,N1:N2),
     ,           HI4(N1:N2,N1:N2,N1:N2,N1:N2)
       PARAMETER ( Z2 = 1.6449 34066 84822 64365 D0,
     ,             Z3 = 1.2020 56903 15959 42854 D0,
     ,             Z4 = 1.0823 23233 71113 81916 D0 )
*
* ...Colour factors and an abbreviation
*
       CF  = 4./3.D0
       CA  = 3.D0
*
       DX = 1.D0/X
*
* ...The harmonic polylogs up to weight 2 by Gehrmann and Remiddi
*
       CALL HPLOG (X, NW, HC1,HC2,HC3,HC4, HR1,HR2,HR3,HR4,
     ,            HI1,HI2,HI3,HI4, N1, N2)
*
* ...The physical kernel in terms of the harmonic polylogs
*
      Kqg2 =
     &  + nf*ca**2 * ( 8515.D0/9.D0 - 19387.D0/9.D0*x + 46270.D0/27.D0*
     &    x**2 + 149.D0*z4 + 174.D0*z4*x + 352.D0*z4*x**2 - 19297.D0/27.
     &    D0*dx + 532.D0/3.D0*z3 + 536.D0/3.D0*z3*x - 1144.D0/3.D0*z3*
     &    x**2 + 320.D0/3.D0*z3*dx + 500.D0/3.D0*z2 + 2648.D0/3.D0*z2*x
     &     - 7408.D0/9.D0*z2*x**2 + 128.D0*z2*dx - 80.D0*Hr1(-1)*z3 - 
     &    160.D0*Hr1(-1)*z3*x - 48.D0*Hr1(-1)*z3*x**2 + 8.D0/3.D0*Hr1(
     &    -1)*z2 + 88.D0/3.D0*Hr1(-1)*z2*x + 48.D0*Hr1(-1)*z2*x**2 - 
     &    128.D0/3.D0*Hr1(-1)*z2*dx - 3178.D0/9.D0*Hr1(0) - 12724.D0/9.D
     &    0*Hr1(0)*x + 4616.D0/9.D0*Hr1(0)*x**2 - 248.D0/3.D0*Hr1(0)*dx
     &     + 128.D0*Hr1(0)*z3 + 576.D0*Hr1(0)*z3*x - 68.D0/3.D0*Hr1(0)*
     &    z2 + 588.D0*Hr1(0)*z2*x - 1232.D0/3.D0*Hr1(0)*z2*x**2 - 40.D0
     &    *Hr1(1) - 1120.D0*Hr1(1)*x + 3488.D0/3.D0*Hr1(1)*x**2 + 64.D0/
     &    3.D0*Hr1(1)*dx - 144.D0*Hr1(1)*z3 + 288.D0*Hr1(1)*z3*x - 176.D
     &    0*Hr1(1)*z3*x**2 + 184.D0/3.D0*Hr1(1)*z2 + 520.D0/3.D0*Hr1(1)
     &    *z2*x - 656.D0/3.D0*Hr1(1)*z2*x**2 + 128.D0/3.D0*Hr1(1)*z2*dx
     &     + 96.D0*Hr2(-1,-1)*z2 )
      Kqg2 = Kqg2 + nf*ca**2 * ( 192.D0*Hr2(-1,-1)*z2*x + 64.D0*Hr2(-1,
     &    -1)*z2*x**2 + 88.D0*Hr2(-1,0) - 704.D0/3.D0*Hr2(-1,0)*x - 
     &    1432.D0/9.D0*Hr2(-1,0)*x**2 + 1952.D0/9.D0*Hr2(-1,0)*dx + 16.D
     &    0*Hr2(-1,0)*z2 + 32.D0*Hr2(-1,0)*z2*x + 96.D0*Hr2(-1,0)*z2*
     &    x**2 + 120.D0*Hr2(0,-1)*z2 - 176.D0*Hr2(0,-1)*z2*x + 192.D0*
     &    Hr2(0,-1)*z2*x**2 + 4078.D0/9.D0*Hr2(0,0) - 9884.D0/9.D0*Hr2(
     &    0,0)*x + 12680.D0/9.D0*Hr2(0,0)*x**2 + 112.D0/9.D0*Hr2(0,0)*
     &    dx + 36.D0*Hr2(0,0)*z2 + 152.D0*Hr2(0,0)*z2*x - 96.D0*Hr2(0,0
     &    )*z2*x**2 - 500.D0/3.D0*Hr2(0,1) - 3352.D0/3.D0*Hr2(0,1)*x + 
     &    7408.D0/9.D0*Hr2(0,1)*x**2 + 800.D0/9.D0*Hr2(0,1)*dx + 56.D0*
     &    Hr2(0,1)*z2 + 304.D0*Hr2(0,1)*z2*x - 326.D0/9.D0*Hr2(1,0) - 
     &    5516.D0/9.D0*Hr2(1,0)*x + 5648.D0/9.D0*Hr2(1,0)*x**2 + 128.D0/
     &    3.D0*Hr2(1,0)*dx - 96.D0*Hr2(1,0)*z2 + 192.D0*Hr2(1,0)*z2*x
     &     - 128.D0*Hr2(1,0)*z2*x**2 + 296.D0/3.D0*Hr2(1,1) - 592.D0*
     &    Hr2(1,1)*x + 560.D0*Hr2(1,1)*x**2 - 96.D0*Hr2(1,1)*z2 + 192.D0
     &    *Hr2(1,1)*z2*x )
      Kqg2 = Kqg2 + nf*ca**2 * (  - 128.D0*Hr2(1,1)*z2*x**2 + 208.D0/3.D
     &    0*Hr3(-1,-1,0) - 592.D0/3.D0*Hr3(-1,-1,0)*x - 288.D0*Hr3(-1,
     &    -1,0)*x**2 - 256.D0/3.D0*Hr3(-1,-1,0)*dx - 136.D0/3.D0*Hr3(-1
     &    ,0,0) - 1016.D0/3.D0*Hr3(-1,0,0)*x - 400.D0*Hr3(-1,0,0)*x**2
     &     + 32.D0*Hr3(-1,0,1) - 128.D0*Hr3(-1,0,1)*x - 192.D0*Hr3(-1,0
     &    ,1)*x**2 - 368.D0/3.D0*Hr3(0,-1,0) - 1000.D0/3.D0*Hr3(0,-1,0)
     &    *x + 80.D0/3.D0*Hr3(0,-1,0)*x**2 + 128.D0/3.D0*Hr3(0,-1,0)*dx
     &     - 8.D0/3.D0*Hr3(0,0,0) - 920.D0*Hr3(0,0,0)*x + 96.D0*Hr3(0,0
     &    ,0)*x**2 + 68.D0/3.D0*Hr3(0,0,1) - 2764.D0/3.D0*Hr3(0,0,1)*x
     &     + 1232.D0/3.D0*Hr3(0,0,1)*x**2 + 128.D0/3.D0*Hr3(0,0,1)*dx
     &     + 136.D0/3.D0*Hr3(0,1,0) - 1472.D0/3.D0*Hr3(0,1,0)*x + 928.D0
     &    /3.D0*Hr3(0,1,0)*x**2 + 104.D0/3.D0*Hr3(0,1,1) - 976.D0/3.D0*
     &    Hr3(0,1,1)*x + 976.D0/3.D0*Hr3(0,1,1)*x**2 - 132.D0*Hr3(1,0,0
     &    ) - 212.D0*Hr3(1,0,0)*x + 1120.D0/3.D0*Hr3(1,0,0)*x**2 - 128.D
     &    0/3.D0*Hr3(1,0,0)*dx - 80.D0/3.D0*Hr3(1,0,1) - 224.D0/3.D0*
     &    Hr3(1,0,1)*x )
      Kqg2 = Kqg2 + nf*ca**2 * ( 224.D0/3.D0*Hr3(1,0,1)*x**2 + 32.D0*
     &    Hr3(1,1,0) - 192.D0*Hr3(1,1,0)*x + 192.D0*Hr3(1,1,0)*x**2 + 
     &    192.D0*Hr4(-1,-1,-1,0) + 384.D0*Hr4(-1,-1,-1,0)*x + 256.D0*
     &    Hr4(-1,-1,-1,0)*x**2 - 32.D0*Hr4(-1,-1,0,0) - 64.D0*Hr4(-1,-1
     &    ,0,0)*x + 32.D0*Hr4(-1,-1,0,0)*x**2 + 64.D0*Hr4(-1,-1,0,1)*
     &    x**2 - 96.D0*Hr4(-1,0,-1,0) - 192.D0*Hr4(-1,0,-1,0)*x - 128.D0
     &    *Hr4(-1,0,-1,0)*x**2 - 16.D0*Hr4(-1,0,0,0) - 32.D0*Hr4(-1,0,0
     &    ,0)*x - 64.D0*Hr4(-1,0,0,0)*x**2 - 64.D0*Hr4(-1,0,0,1) - 128.D
     &    0*Hr4(-1,0,0,1)*x - 160.D0*Hr4(-1,0,0,1)*x**2 + 176.D0*Hr4(0,
     &    -1,-1,0) - 480.D0*Hr4(0,-1,-1,0)*x + 128.D0*Hr4(0,-1,-1,0)*
     &    x**2 - 40.D0*Hr4(0,-1,0,0) - 48.D0*Hr4(0,-1,0,0)*x - 128.D0*
     &    Hr4(0,-1,0,0)*x**2 - 32.D0*Hr4(0,-1,0,1) - 64.D0*Hr4(0,-1,0,1
     &    )*x - 128.D0*Hr4(0,-1,0,1)*x**2 - 24.D0*Hr4(0,0,-1,0) - 16.D0
     &    *Hr4(0,0,-1,0)*x + 64.D0*Hr4(0,0,0,0) - 240.D0*Hr4(0,0,0,0)*x
     &     - 36.D0*Hr4(0,0,0,1) - 168.D0*Hr4(0,0,0,1)*x + 96.D0*Hr4(0,0
     &    ,0,1)*x**2 )
      Kqg2 = Kqg2 + nf*ca**2 * (  - 192.D0*Hr4(0,0,1,0)*x + 64.D0*Hr4(0
     &    ,0,1,0)*x**2 + 64.D0*Hr4(0,0,1,1) - 128.D0*Hr4(0,0,1,1)*x + 
     &    128.D0*Hr4(0,0,1,1)*x**2 - 100.D0*Hr4(0,1,0,0) - 360.D0*Hr4(0
     &    ,1,0,0)*x - 32.D0*Hr4(0,1,0,0)*x**2 + 32.D0*Hr4(0,1,0,1) - 64.
     &    D0*Hr4(0,1,0,1)*x + 64.D0*Hr4(0,1,0,1)*x**2 + 32.D0*Hr4(0,1,1
     &    ,0) - 64.D0*Hr4(0,1,1,0)*x + 64.D0*Hr4(0,1,1,0)*x**2 + 48.D0*
     &    Hr4(1,0,0,0) - 96.D0*Hr4(1,0,0,0)*x + 64.D0*Hr4(1,0,0,0)*x**2
     &     + 48.D0*Hr4(1,0,0,1) - 96.D0*Hr4(1,0,0,1)*x + 64.D0*Hr4(1,0,
     &    0,1)*x**2 + 48.D0*Hr4(1,1,0,0) - 96.D0*Hr4(1,1,0,0)*x + 64.D0
     &    *Hr4(1,1,0,0)*x**2 )
      Kqg2 = Kqg2 + nf*cf*ca * (  - 338.D0/5.D0 + 41977.D0/45.D0*x - 
     &    46292.D0/45.D0*x**2 + 118.D0*z4 + 628.D0*z4*x - 240.D0*z4*
     &    x**2 + 4732.D0/45.D0*dx - 700.D0/3.D0*z3 - 3736.D0/3.D0*z3*x
     &     - 152.D0*z3*x**2 - 192.D0*z3*x**3 - 348.D0/5.D0*z2 - 10124.D0
     &    /45.D0*z2*x + 2856.D0/5.D0*z2*x**2 - 896.D0/5.D0*z2*x**3 - 
     &    544.D0/15.D0*z2*dx + 400.D0*Hr1(-1)*z3 + 800.D0*Hr1(-1)*z3*x
     &     + 464.D0*Hr1(-1)*z3*x**2 + 1520.D0/3.D0*Hr1(-1)*z2 + 2176.D0/
     &    3.D0*Hr1(-1)*z2*x + 472.D0*Hr1(-1)*z2*x**2 + 576.D0/5.D0*Hr1(
     &    -1)*z2*x**3 + 160.D0/3.D0*Hr1(-1)*z2*dx + 16.D0/5.D0*Hr1(-1)*
     &    z2*dx**2 - 139.D0/9.D0*Hr1(0) + 25786.D0/45.D0*Hr1(0)*x - 
     &    10072.D0/15.D0*Hr1(0)*x**2 + 848.D0/45.D0*Hr1(0)*dx - 64.D0*
     &    Hr1(0)*z3 - 928.D0*Hr1(0)*z3*x - 128.D0*Hr1(0)*z3*x**2 - 4.D0/
     &    3.D0*Hr1(0)*z2 - 2368.D0/3.D0*Hr1(0)*z2*x - 224.D0*Hr1(0)*z2*
     &    x**2 - 768.D0/5.D0*Hr1(0)*z2*x**3 + 266.D0/5.D0*Hr1(1) + 
     &    14312.D0/15.D0*Hr1(1)*x - 5376.D0/5.D0*Hr1(1)*x**2 + 1568.D0/
     &    15.D0*Hr1(1)*dx )
      Kqg2 = Kqg2 + nf*cf*ca * ( 352.D0*Hr1(1)*z3 - 704.D0*Hr1(1)*z3*x
     &     + 368.D0*Hr1(1)*z3*x**2 - 56.D0/3.D0*Hr1(1)*z2 - 592.D0/3.D0
     &    *Hr1(1)*z2*x + 248.D0*Hr1(1)*z2*x**2 - 192.D0/5.D0*Hr1(1)*z2*
     &    x**3 - 32.D0*Hr1(1)*z2*dx + 16.D0/15.D0*Hr1(1)*z2*dx**2 - 480.
     &    D0*Hr2(-1,-1)*z2 - 960.D0*Hr2(-1,-1)*z2*x - 576.D0*Hr2(-1,-1)
     &    *z2*x**2 + 11416.D0/15.D0*Hr2(-1,0) + 36448.D0/45.D0*Hr2(-1,0
     &    )*x - 464.D0/5.D0*Hr2(-1,0)*x**2 - 896.D0/5.D0*Hr2(-1,0)*x**3
     &     - 32.D0/15.D0*Hr2(-1,0)*dx - 224.D0/45.D0*Hr2(-1,0)*dx**2 + 
     &    288.D0*Hr2(-1,0)*z2 + 576.D0*Hr2(-1,0)*z2*x + 384.D0*Hr2(-1,0
     &    )*z2*x**2 + 256.D0*Hr2(0,-1)*z2 + 512.D0*Hr2(0,-1)*z2*x + 416.
     &    D0*Hr2(0,-1)*z2*x**2 - 412.D0/5.D0*Hr2(0,0) - 7588.D0/45.D0*
     &    Hr2(0,0)*x - 18904.D0/45.D0*Hr2(0,0)*x**2 + 896.D0/5.D0*Hr2(0
     &    ,0)*x**3 + 32.D0/15.D0*Hr2(0,0)*dx + 24.D0*Hr2(0,0)*z2 - 16.D0
     &    *Hr2(0,0)*z2*x - 32.D0*Hr2(0,0)*z2*x**2 + 348.D0/5.D0*Hr2(0,1
     &    ) + 15524.D0/15.D0*Hr2(0,1)*x - 2856.D0/5.D0*Hr2(0,1)*x**2 + 
     &    512.D0/15.D0*Hr2(0,1)*dx )
      Kqg2 = Kqg2 + nf*cf*ca * (  - 384.D0*Hr2(0,1)*z2*x + 96.D0*Hr2(0,
     &    1)*z2*x**2 - 554.D0/3.D0*Hr2(1,0) + 2176.D0/3.D0*Hr2(1,0)*x
     &     - 5192.D0/9.D0*Hr2(1,0)*x**2 + 512.D0/9.D0*Hr2(1,0)*dx + 272.
     &    D0*Hr2(1,0)*z2 - 544.D0*Hr2(1,0)*z2*x + 352.D0*Hr2(1,0)*z2*
     &    x**2 - 524.D0/3.D0*Hr2(1,1) + 872.D0*Hr2(1,1)*x - 776.D0*Hr2(
     &    1,1)*x**2 + 224.D0*Hr2(1,1)*z2 - 448.D0*Hr2(1,1)*z2*x + 256.D0
     &    *Hr2(1,1)*z2*x**2 + 352.D0/3.D0*Hr3(-1,-1,0) + 704.D0*Hr3(-1,
     &    -1,0)*x + 2416.D0/3.D0*Hr3(-1,-1,0)*x**2 + 384.D0/5.D0*Hr3(-1
     &    ,-1,0)*x**3 + 64.D0*Hr3(-1,-1,0)*dx + 32.D0/15.D0*Hr3(-1,-1,0
     &    )*dx**2 - 656.D0/3.D0*Hr3(-1,0,0) - 1136.D0/3.D0*Hr3(-1,0,0)*
     &    x - 1024.D0/3.D0*Hr3(-1,0,0)*x**2 - 384.D0/5.D0*Hr3(-1,0,0)*
     &    x**3 - 128.D0/3.D0*Hr3(-1,0,0)*dx - 32.D0/15.D0*Hr3(-1,0,0)*
     &    dx**2 - 448.D0*Hr3(-1,0,1) - 1120.D0/3.D0*Hr3(-1,0,1)*x - 208.
     &    D0/3.D0*Hr3(-1,0,1)*x**2 - 384.D0/5.D0*Hr3(-1,0,1)*x**3 - 64.D
     &    0/3.D0*Hr3(-1,0,1)*dx - 32.D0/15.D0*Hr3(-1,0,1)*dx**2 + 848.D0
     &    /3.D0*Hr3(0,-1,0) )
      Kqg2 = Kqg2 + nf*cf*ca * (  - 1040.D0/3.D0*Hr3(0,-1,0)*x - 2416.D0
     &    /3.D0*Hr3(0,-1,0)*x**2 - 384.D0/5.D0*Hr3(0,-1,0)*x**3 + 52.D0
     &    *Hr3(0,0,0) + 440.D0/3.D0*Hr3(0,0,0)*x + 480.D0*Hr3(0,0,0)*
     &    x**2 + 384.D0/5.D0*Hr3(0,0,0)*x**3 + 4.D0/3.D0*Hr3(0,0,1) + 
     &    1328.D0/3.D0*Hr3(0,0,1)*x + 224.D0*Hr3(0,0,1)*x**2 + 384.D0/5.
     &    D0*Hr3(0,0,1)*x**3 - 44.D0*Hr3(0,1,0) + 56.D0*Hr3(0,1,0)*x + 
     &    80.D0*Hr3(0,1,0)*x**2 + 64.D0/3.D0*Hr3(0,1,0)*dx + 32.D0*Hr3(
     &    0,1,1) + 192.D0*Hr3(0,1,1)*x - 192.D0*Hr3(0,1,1)*x**2 + 940.D0
     &    /3.D0*Hr3(1,0,0) - 464.D0/3.D0*Hr3(1,0,0)*x - 96.D0*Hr3(1,0,0
     &    )*x**2 + 64.D0/3.D0*Hr3(1,0,0)*dx + 232.D0/3.D0*Hr3(1,0,1) - 
     &    464.D0/3.D0*Hr3(1,0,1)*x + 464.D0/3.D0*Hr3(1,0,1)*x**2 + 56.D0
     &    /3.D0*Hr3(1,1,0) - 112.D0/3.D0*Hr3(1,1,0)*x + 112.D0/3.D0*
     &    Hr3(1,1,0)*x**2 - 448.D0*Hr4(-1,-1,-1,0) - 896.D0*Hr4(-1,-1,
     &    -1,0)*x - 512.D0*Hr4(-1,-1,-1,0)*x**2 + 288.D0*Hr4(-1,-1,0,0)
     &     + 576.D0*Hr4(-1,-1,0,0)*x + 288.D0*Hr4(-1,-1,0,0)*x**2 + 256.
     &    D0*Hr4(-1,-1,0,1) )
      Kqg2 = Kqg2 + nf*cf*ca * ( 512.D0*Hr4(-1,-1,0,1)*x + 320.D0*Hr4(
     &    -1,-1,0,1)*x**2 + 224.D0*Hr4(-1,0,-1,0) + 448.D0*Hr4(-1,0,-1,
     &    0)*x + 256.D0*Hr4(-1,0,-1,0)*x**2 - 144.D0*Hr4(-1,0,0,0) - 
     &    288.D0*Hr4(-1,0,0,0)*x - 192.D0*Hr4(-1,0,0,0)*x**2 - 128.D0*
     &    Hr4(-1,0,0,1) - 256.D0*Hr4(-1,0,0,1)*x - 160.D0*Hr4(-1,0,0,1)
     &    *x**2 - 32.D0*Hr4(-1,0,1,0) - 64.D0*Hr4(-1,0,1,0)*x - 64.D0*
     &    Hr4(-1,0,1,0)*x**2 + 64.D0*Hr4(0,-1,-1,0) + 896.D0*Hr4(0,-1,
     &    -1,0)*x + 320.D0*Hr4(0,-1,-1,0)*x**2 - 112.D0*Hr4(0,-1,0,0)
     &     - 416.D0*Hr4(0,-1,0,0)*x - 160.D0*Hr4(0,-1,0,0)*x**2 - 224.D0
     &    *Hr4(0,-1,0,1) - 64.D0*Hr4(0,-1,0,1)*x - 256.D0*Hr4(0,-1,0,1)
     &    *x**2 + 208.D0*Hr4(0,0,-1,0) - 96.D0*Hr4(0,0,-1,0)*x + 128.D0
     &    *Hr4(0,0,-1,0)*x**2 - 32.D0*Hr4(0,0,0,0) - 96.D0*Hr4(0,0,0,0)
     &    *x - 24.D0*Hr4(0,0,0,1) - 80.D0*Hr4(0,0,0,1)*x + 32.D0*Hr4(0,
     &    0,0,1)*x**2 - 32.D0*Hr4(0,0,1,0) - 64.D0*Hr4(0,0,1,0)*x + 136.
     &    D0*Hr4(0,1,0,0) + 304.D0*Hr4(0,1,0,0)*x + 128.D0*Hr4(0,1,0,0)
     &    *x**2 )
      Kqg2 = Kqg2 + nf*cf*ca * ( 32.D0*Hr4(0,1,0,1) - 64.D0*Hr4(0,1,0,1
     &    )*x + 64.D0*Hr4(0,1,0,1)*x**2 + 32.D0*Hr4(0,1,1,0) - 64.D0*
     &    Hr4(0,1,1,0)*x + 64.D0*Hr4(0,1,1,0)*x**2 + 96.D0*Hr4(1,0,-1,0
     &    ) - 192.D0*Hr4(1,0,-1,0)*x + 192.D0*Hr4(1,0,-1,0)*x**2 - 80.D0
     &    *Hr4(1,0,0,0) + 160.D0*Hr4(1,0,0,0)*x - 64.D0*Hr4(1,0,0,0)*
     &    x**2 - 112.D0*Hr4(1,0,0,1) + 224.D0*Hr4(1,0,0,1)*x - 128.D0*
     &    Hr4(1,0,0,1)*x**2 - 48.D0*Hr4(1,1,0,0) + 96.D0*Hr4(1,1,0,0)*x
     &     )
      Kqg2 = Kqg2 + nf*cf**2 * (  - 2572.D0/45.D0 - 4651.D0/15.D0*x + 
     &    1844.D0/5.D0*x**2 - 20.D0*z4 - 360.D0*z4*x + 96.D0*z4*x**2 + 
     &    64.D0/45.D0*dx - 80.D0*z3 + 2800.D0/3.D0*z3*x + 192.D0*z3*
     &    x**2 + 192.D0*z3*x**3 + 644.D0/15.D0*z2 + 5704.D0/45.D0*z2*x
     &     - 976.D0/5.D0*z2*x**2 + 128.D0*z2*x**3 + 64.D0/15.D0*z2*dx
     &     - 224.D0*Hr1(-1)*z3 - 448.D0*Hr1(-1)*z3*x - 224.D0*Hr1(-1)*
     &    z3*x**2 - 160.D0*Hr1(-1)*z2 - 256.D0*Hr1(-1)*z2*x - 288.D0*
     &    Hr1(-1)*z2*x**2 - 576.D0/5.D0*Hr1(-1)*z2*x**3 - 16.D0/5.D0*
     &    Hr1(-1)*z2*dx**2 - 217.D0/45.D0*Hr1(0) - 392.D0/5.D0*Hr1(0)*x
     &     + 296.D0*Hr1(0)*x**2 - 64.D0/45.D0*Hr1(0)*dx - 16.D0*Hr1(0)*
     &    z3 + 544.D0*Hr1(0)*z3*x - 64.D0*Hr1(0)*z3*x**2 - 32.D0*Hr1(0)
     &    *z2 + 512.D0*Hr1(0)*z2*x + 96.D0*Hr1(0)*z2*x**2 + 768.D0/5.D0
     &    *Hr1(0)*z2*x**3 - 3698.D0/15.D0*Hr1(1) - 504.D0/5.D0*Hr1(1)*x
     &     + 1736.D0/5.D0*Hr1(1)*x**2 + 32.D0/15.D0*Hr1(1)*dx - 256.D0*
     &    Hr1(1)*z3 + 512.D0*Hr1(1)*z3*x - 288.D0*Hr1(1)*z3*x**2 + 16.D0
     &    *Hr1(1)*z2 )
      Kqg2 = Kqg2 + nf*cf**2 * ( 224.D0/3.D0*Hr1(1)*z2*x - 192.D0*Hr1(1
     &    )*z2*x**2 + 192.D0/5.D0*Hr1(1)*z2*x**3 - 16.D0/15.D0*Hr1(1)*
     &    z2*dx**2 + 256.D0*Hr2(-1,-1)*z2 + 512.D0*Hr2(-1,-1)*z2*x + 
     &    256.D0*Hr2(-1,-1)*z2*x**2 - 9736.D0/15.D0*Hr2(-1,0) - 18128.D0
     &    /45.D0*Hr2(-1,0)*x + 1424.D0/5.D0*Hr2(-1,0)*x**2 + 128.D0*
     &    Hr2(-1,0)*x**3 + 32.D0/15.D0*Hr2(-1,0)*dx + 32.D0/9.D0*Hr2(-1
     &    ,0)*dx**2 - 160.D0*Hr2(-1,0)*z2 - 320.D0*Hr2(-1,0)*z2*x - 192.
     &    D0*Hr2(-1,0)*z2*x**2 - 192.D0*Hr2(0,-1)*z2 - 256.D0*Hr2(0,-1)
     &    *z2*x - 256.D0*Hr2(0,-1)*z2*x**2 + 166.D0/15.D0*Hr2(0,0) + 
     &    4988.D0/45.D0*Hr2(0,0)*x - 384.D0/5.D0*Hr2(0,0)*x**2 - 128.D0
     &    *Hr2(0,0)*x**3 - 32.D0/15.D0*Hr2(0,0)*dx - 32.D0*Hr2(0,0)*z2
     &     + 128.D0*Hr2(0,0)*z2*x - 128.D0*Hr2(0,0)*z2*x**2 - 644.D0/15.
     &    D0*Hr2(0,1) - 2648.D0/5.D0*Hr2(0,1)*x + 976.D0/5.D0*Hr2(0,1)*
     &    x**2 - 32.D0/15.D0*Hr2(0,1)*dx - 64.D0*Hr2(0,1)*z2 + 256.D0*
     &    Hr2(0,1)*z2*x - 128.D0*Hr2(0,1)*z2*x**2 + 76.D0*Hr2(1,0) - 
     &    272.D0*Hr2(1,0)*x )
      Kqg2 = Kqg2 + nf*cf**2 * ( 208.D0*Hr2(1,0)*x**2 - 224.D0*Hr2(1,0)
     &    *z2 + 448.D0*Hr2(1,0)*z2*x - 320.D0*Hr2(1,0)*z2*x**2 + 104.D0
     &    *Hr2(1,1) - 336.D0*Hr2(1,1)*x + 272.D0*Hr2(1,1)*x**2 - 128.D0
     &    *Hr2(1,1)*z2 + 256.D0*Hr2(1,1)*z2*x - 128.D0*Hr2(1,1)*z2*x**2
     &     + 64.D0*Hr3(-1,-1,0) - 1024.D0/3.D0*Hr3(-1,-1,0)*x - 576.D0*
     &    Hr3(-1,-1,0)*x**2 - 384.D0/5.D0*Hr3(-1,-1,0)*x**3 - 32.D0/15.D
     &    0*Hr3(-1,-1,0)*dx**2 - 64.D0*Hr3(-1,0,0) - 320.D0/3.D0*Hr3(-1
     &    ,0,0)*x + 96.D0*Hr3(-1,0,0)*x**2 + 384.D0/5.D0*Hr3(-1,0,0)*
     &    x**3 + 32.D0/15.D0*Hr3(-1,0,0)*dx**2 + 192.D0*Hr3(-1,0,1) + 
     &    256.D0/3.D0*Hr3(-1,0,1)*x + 384.D0/5.D0*Hr3(-1,0,1)*x**3 + 32.
     &    D0/15.D0*Hr3(-1,0,1)*dx**2 - 320.D0*Hr3(0,-1,0) + 1184.D0/3.D0
     &    *Hr3(0,-1,0)*x + 576.D0*Hr3(0,-1,0)*x**2 + 384.D0/5.D0*Hr3(0,
     &    -1,0)*x**3 - 272.D0/3.D0*Hr3(0,0,0)*x + 96.D0*Hr3(0,0,0)*x**2
     &     - 384.D0/5.D0*Hr3(0,0,0)*x**3 + 32.D0*Hr3(0,0,1) - 352.D0/3.D
     &    0*Hr3(0,0,1)*x - 96.D0*Hr3(0,0,1)*x**2 - 384.D0/5.D0*Hr3(0,0,
     &    1)*x**3 )
      Kqg2 = Kqg2 + nf*cf**2 * ( 24.D0*Hr3(0,1,0) - 16.D0*Hr3(0,1,0)*x
     &     - 96.D0*Hr3(0,1,0)*x**2 - 112.D0*Hr3(1,0,0) - 32.D0*Hr3(1,0,
     &    0)*x + 192.D0*Hr3(1,0,0)*x**2 + 16.D0*Hr3(1,0,1) + 96.D0*Hr3(
     &    1,0,1)*x - 96.D0*Hr3(1,0,1)*x**2 + 16.D0*Hr3(1,1,0) + 96.D0*
     &    Hr3(1,1,0)*x - 96.D0*Hr3(1,1,0)*x**2 + 256.D0*Hr4(-1,-1,-1,0)
     &     + 512.D0*Hr4(-1,-1,-1,0)*x + 256.D0*Hr4(-1,-1,-1,0)*x**2 - 
     &    64.D0*Hr4(-1,-1,0,0) - 128.D0*Hr4(-1,-1,0,0)*x + 64.D0*Hr4(-1
     &    ,-1,0,0)*x**2 - 128.D0*Hr4(-1,-1,0,1) - 256.D0*Hr4(-1,-1,0,1)
     &    *x - 128.D0*Hr4(-1,-1,0,1)*x**2 - 64.D0*Hr4(-1,0,-1,0) - 128.D
     &    0*Hr4(-1,0,-1,0)*x + 32.D0*Hr4(-1,0,0,0) + 64.D0*Hr4(-1,0,0,0
     &    )*x + 64.D0*Hr4(-1,0,0,1) + 128.D0*Hr4(-1,0,0,1)*x + 64.D0*
     &    Hr4(-1,0,0,1)*x**2 - 128.D0*Hr4(0,-1,-1,0) - 512.D0*Hr4(0,-1,
     &    -1,0)*x - 256.D0*Hr4(0,-1,-1,0)*x**2 + 64.D0*Hr4(0,-1,0,0) + 
     &    128.D0*Hr4(0,-1,0,0)*x - 64.D0*Hr4(0,-1,0,0)*x**2 + 128.D0*
     &    Hr4(0,-1,0,1) + 128.D0*Hr4(0,-1,0,1)*x**2 - 96.D0*Hr4(0,0,-1,
     &    0) )
      Kqg2 = Kqg2 + nf*cf**2 * ( 64.D0*Hr4(0,0,-1,0)*x - 256.D0*Hr4(0,0
     &    ,-1,0)*x**2 + 16.D0*Hr4(0,0,0,0) + 32.D0*Hr4(0,0,0,0)*x + 128.
     &    D0*Hr4(0,0,0,0)*x**2 + 32.D0*Hr4(0,0,0,1) - 64.D0*Hr4(0,0,0,1
     &    )*x + 128.D0*Hr4(0,0,0,1)*x**2 + 32.D0*Hr4(0,0,1,0) - 64.D0*
     &    Hr4(0,0,1,0)*x + 128.D0*Hr4(0,0,1,0)*x**2 - 256.D0*Hr4(0,1,0,
     &    0)*x + 64.D0*Hr4(0,1,0,0)*x**2 - 128.D0*Hr4(1,0,-1,0) + 256.D0
     &    *Hr4(1,0,-1,0)*x - 256.D0*Hr4(1,0,-1,0)*x**2 + 96.D0*Hr4(1,0,
     &    0,0) - 192.D0*Hr4(1,0,0,0)*x + 128.D0*Hr4(1,0,0,0)*x**2 + 128.
     &    D0*Hr4(1,0,0,1) - 256.D0*Hr4(1,0,0,1)*x + 192.D0*Hr4(1,0,0,1)
     &    *x**2 + 64.D0*Hr4(1,0,1,0) - 128.D0*Hr4(1,0,1,0)*x + 128.D0*
     &    Hr4(1,0,1,0)*x**2 + 64.D0*Hr4(1,1,0,0) - 128.D0*Hr4(1,1,0,0)*
     &    x + 64.D0*Hr4(1,1,0,0)*x**2 )
      Kqg2 = Kqg2 + nf**2*ca * ( 230.D0/3.D0 - 692.D0/9.D0*x + 7048.D0/
     &    81.D0*x**2 - 2656.D0/81.D0*dx + 8.D0/3.D0*z3 - 368.D0/3.D0*z3
     &    *x + 80.D0/3.D0*z3*x**2 - 32.D0/3.D0*z2 - 16.D0/3.D0*z2*x - 
     &    176.D0/9.D0*z2*x**2 - 32.D0/9.D0*z2*dx + 16.D0/3.D0*Hr1(-1)*
     &    z2 + 32.D0/3.D0*Hr1(-1)*z2*x + 16.D0/3.D0*Hr1(-1)*z2*x**2 - 
     &    92.D0/9.D0*Hr1(0) - 40.D0/3.D0*Hr1(0)*x + 1112.D0/27.D0*Hr1(0
     &    )*x**2 - 152.D0/9.D0*Hr1(0)*dx - 16.D0/3.D0*Hr1(0)*z2 - 32.D0/
     &    3.D0*Hr1(0)*z2*x**2 + 16.D0*Hr1(1) - 24.D0*Hr1(1)*x + 8.D0*
     &    Hr1(1)*x**2 - 16.D0/3.D0*Hr1(1)*z2 + 32.D0/3.D0*Hr1(1)*z2*x
     &     - 16.D0*Hr1(1)*z2*x**2 - 80.D0/3.D0*Hr2(-1,0) - 32.D0*Hr2(-1
     &    ,0)*x - 64.D0/9.D0*Hr2(-1,0)*x**2 - 64.D0/9.D0*Hr2(-1,0)*dx
     &     + 40.D0/9.D0*Hr2(0,0) + 304.D0/9.D0*Hr2(0,0)*x + 104.D0/3.D0
     &    *Hr2(0,0)*x**2 - 32.D0/9.D0*Hr2(0,0)*dx + 32.D0/3.D0*Hr2(0,1)
     &     - 80.D0/3.D0*Hr2(0,1)*x + 176.D0/9.D0*Hr2(0,1)*x**2 - 32.D0/
     &    9.D0*Hr2(0,1)*dx + 64.D0/9.D0*Hr2(1,0) - 368.D0/9.D0*Hr2(1,0)
     &    *x )
      Kqg2 = Kqg2 + nf**2*ca * ( 424.D0/9.D0*Hr2(1,0)*x**2 - 32.D0/9.D0
     &    *Hr2(1,0)*dx + 16.D0/3.D0*Hr2(1,1) - 32.D0*Hr2(1,1)*x + 32.D0
     &    *Hr2(1,1)*x**2 + 32.D0/3.D0*Hr3(-1,-1,0) + 64.D0/3.D0*Hr3(-1,
     &    -1,0)*x + 32.D0/3.D0*Hr3(-1,-1,0)*x**2 + 16.D0/3.D0*Hr3(-1,0,
     &    0) + 32.D0/3.D0*Hr3(-1,0,0)*x + 16.D0*Hr3(-1,0,0)*x**2 - 16.D0
     &    /3.D0*Hr3(0,-1,0) - 32.D0/3.D0*Hr3(0,-1,0)*x - 16.D0/3.D0*
     &    Hr3(0,0,0) + 16.D0/3.D0*Hr3(0,0,1) - 32.D0/3.D0*Hr3(0,0,1)*x
     &     + 32.D0/3.D0*Hr3(0,0,1)*x**2 - 16.D0/3.D0*Hr3(0,1,0) - 64.D0/
     &    3.D0*Hr3(0,1,0)*x + 16.D0/3.D0*Hr3(0,1,1) - 32.D0/3.D0*Hr3(0,
     &    1,1)*x + 32.D0/3.D0*Hr3(0,1,1)*x**2 + 16.D0/3.D0*Hr3(1,0,0)*
     &    x**2 + 32.D0/3.D0*Hr3(1,0,1) - 64.D0/3.D0*Hr3(1,0,1)*x + 64.D0
     &    /3.D0*Hr3(1,0,1)*x**2 )
      Kqg2 = Kqg2 + nf**2*cf * (  - 859.D0/45.D0 + 16834.D0/45.D0*x - 
     &    105494.D0/405.D0*x**2 - 9796.D0/405.D0*dx + 112.D0/3.D0*z3 - 
     &    32.D0*z3*x - 8.D0/3.D0*z2 - 16.D0/9.D0*z2*x + 16.D0*z2*x**2
     &     + 64.D0/5.D0*z2*x**3 - 64.D0/9.D0*z2*dx - 32.D0/3.D0*Hr1(-1)
     &    *z2 - 64.D0/3.D0*Hr1(-1)*z2*x - 32.D0/3.D0*Hr1(-1)*z2*x**2 - 
     &    7072.D0/45.D0*Hr1(0) + 9028.D0/45.D0*Hr1(0)*x + 12104.D0/45.D0
     &    *Hr1(0)*x**2 - 2848.D0/135.D0*Hr1(0)*dx + 16.D0/3.D0*Hr1(0)*
     &    z2 - 224.D0/3.D0*Hr1(0)*z2*x + 32.D0/3.D0*Hr1(0)*z2*x**2 - 16.
     &    D0*Hr1(1)*x + 56.D0/3.D0*Hr1(1)*x**2 - 16.D0/3.D0*Hr1(1)*dx
     &     - 16.D0/3.D0*Hr1(1)*z2 + 32.D0/3.D0*Hr1(1)*z2*x + 80.D0*Hr2(
     &    -1,0) + 128.D0/9.D0*Hr2(-1,0)*x - 496.D0/9.D0*Hr2(-1,0)*x**2
     &     + 64.D0/5.D0*Hr2(-1,0)*x**3 - 64.D0/9.D0*Hr2(-1,0)*dx + 16.D0
     &    /45.D0*Hr2(-1,0)*dx**2 - 472.D0/3.D0*Hr2(0,0) - 752.D0/9.D0*
     &    Hr2(0,0)*x - 736.D0/9.D0*Hr2(0,0)*x**2 - 64.D0/5.D0*Hr2(0,0)*
     &    x**3 - 64.D0/9.D0*Hr2(0,0)*dx + 8.D0/3.D0*Hr2(0,1) + 16.D0*
     &    Hr2(0,1)*x )
      Kqg2 = Kqg2 + nf**2*cf * (  - 16.D0*Hr2(0,1)*x**2 - 4.D0/3.D0*
     &    Hr2(1,0) - 64.D0/3.D0*Hr2(1,0)*x + 176.D0/9.D0*Hr2(1,0)*x**2
     &     - 32.D0/9.D0*Hr2(1,0)*dx + 8.D0/3.D0*Hr2(1,1) + 16.D0*Hr2(1,
     &    1)*x - 16.D0*Hr2(1,1)*x**2 - 64.D0/3.D0*Hr3(-1,-1,0) - 128.D0/
     &    3.D0*Hr3(-1,-1,0)*x - 64.D0/3.D0*Hr3(-1,-1,0)*x**2 + 32.D0/3.D
     &    0*Hr3(-1,0,0) + 64.D0/3.D0*Hr3(-1,0,0)*x + 32.D0/3.D0*Hr3(-1,
     &    0,0)*x**2 + 160.D0/3.D0*Hr3(0,-1,0) - 64.D0*Hr3(0,-1,0)*x + 
     &    128.D0/3.D0*Hr3(0,-1,0)*x**2 - 48.D0*Hr3(0,0,0) + 176.D0*Hr3(
     &    0,0,0)*x + 32.D0*Hr3(0,0,0)*x**2 - 16.D0/3.D0*Hr3(0,0,1) + 32.
     &    D0/3.D0*Hr3(0,0,1)*x - 32.D0/3.D0*Hr3(0,0,1)*x**2 + 8.D0*Hr3(
     &    0,1,0) - 16.D0*Hr3(0,1,0)*x + 32.D0/3.D0*Hr3(0,1,0)*x**2 - 16.
     &    D0/3.D0*Hr3(1,0,0) + 32.D0/3.D0*Hr3(1,0,0)*x - 64.D0/3.D0*
     &    Hr3(1,0,0)*x**2 - 16.D0/3.D0*Hr3(1,0,1) + 32.D0/3.D0*Hr3(1,0,
     &    1)*x - 32.D0/3.D0*Hr3(1,0,1)*x**2 + 16.D0/3.D0*Hr3(1,1,0) - 
     &    32.D0/3.D0*Hr3(1,1,0)*x + 32.D0/3.D0*Hr3(1,1,0)*x**2 - 32.D0*
     &    Hr4(0,0,0,0) )
      Kqg2 = Kqg2 + nf**2*cf * ( 64.D0*Hr4(0,0,0,0)*x )
      Kqg2 = Kqg2 + nf**3 * (  - 20.D0/9.D0 + 4.D0*x - 196.D0/81.D0*
     &    x**2 + 52.D0/81.D0*dx - 8.D0/9.D0*Hr1(0) + 16.D0/9.D0*Hr1(0)*
     &    x + 16.D0/27.D0*Hr1(0)*dx - 8.D0/9.D0*Hr2(0,0) + 16.D0/9.D0*
     &    Hr2(0,0)*x - 16.D0/9.D0*Hr2(0,0)*x**2 - 8.D0/9.D0*Hr2(1,0) + 
     &    16.D0/9.D0*Hr2(1,0)*x - 16.D0/9.D0*Hr2(1,0)*x**2 )
*
       XK2P2A = Kqg2
*
       RETURN
       END
*
* ---------------------------------------------------------------------
*
*
* ..K_phi 2 
*
       FUNCTION XKP22A (X, NF)
*
       IMPLICIT REAL*8 (A - Z)
       COMPLEX*16 HC1, HC2, HC3, HC4
       INTEGER NF, N1, N2, NW, I1, I2, I3
       PARAMETER ( N1 = -1, N2 = 1, NW = 4 )
       DIMENSION HC1(N1:N2),HC2(N1:N2,N1:N2),HC3(N1:N2,N1:N2,N1:N2),
     ,           HC4(N1:N2,N1:N2,N1:N2,N1:N2)
       DIMENSION HR1(N1:N2),HR2(N1:N2,N1:N2),HR3(N1:N2,N1:N2,N1:N2),
     ,           HR4(N1:N2,N1:N2,N1:N2,N1:N2)
       DIMENSION HI1(N1:N2),HI2(N1:N2,N1:N2),HI3(N1:N2,N1:N2,N1:N2),
     ,           HI4(N1:N2,N1:N2,N1:N2,N1:N2)
       PARAMETER ( Z2 = 1.6449 34066 84822 64365 D0,
     ,             Z3 = 1.2020 56903 15959 42854 D0,
     ,             Z4 = 1.0823 23233 71113 81916 D0 )
*
* ...Colour factors and an abbreviation
*
       CF  = 4./3.D0
       CA  = 3.D0
*
       DX = 1.D0/X
*
* ...The harmonic polylogs up to weight 2 by Gehrmann and Remiddi
*
       CALL HPLOG (X, NW, HC1,HC2,HC3,HC4, HR1,HR2,HR3,HR4,
     ,            HI1,HI2,HI3,HI4, N1, N2)
*
* ...The physical kernel in terms of the harmonic polylogs
*
      Kgq2 =
     &  + cf*ca**2 * (  - 86135.D0/27.D0 + 36166.D0/27.D0*x + 3712.D0/
     &    27.D0*x**2 - 242.D0*z4 - 247.D0*z4*x + 223601.D0/54.D0*dx - 
     &    384.D0*dx*z4 + 1184.D0*z3 - 64.D0*z3*x + 128.D0/3.D0*z3*x**2
     &     - 2776.D0/3.D0*z3*dx + 5632.D0/9.D0*z2 + 64.D0/3.D0*z2*x + 
     &    256.D0/3.D0*z2*x**2 - 2152.D0/9.D0*z2*dx - 336.D0*Hr1(-1)*z3
     &     - 168.D0*Hr1(-1)*z3*x - 336.D0*Hr1(-1)*z3*dx - 2272.D0/3.D0*
     &    Hr1(-1)*z2 - 1004.D0/3.D0*Hr1(-1)*z2*x - 64.D0*Hr1(-1)*z2*
     &    x**2 - 1432.D0/3.D0*Hr1(-1)*z2*dx + 9254.D0/9.D0*Hr1(0) + 
     &    1132.D0/3.D0*Hr1(0)*x + 15400.D0/27.D0*Hr1(0)*x**2 + 28529.D0/
     &    27.D0*Hr1(0)*dx - 64.D0*Hr1(0)*z3 + 144.D0*Hr1(0)*z3*x + 128.D
     &    0*Hr1(0)*z3*dx + 748.D0/3.D0*Hr1(0)*z2 + 580.D0/3.D0*Hr1(0)*
     &    z2*x + 128.D0/3.D0*Hr1(0)*z2*x**2 - 176.D0/3.D0*Hr1(0)*z2*dx
     &     + 6748.D0/27.D0*Hr1(1) + 2836.D0/27.D0*Hr1(1)*x + 1928.D0/9.D
     &    0*Hr1(1)*x**2 - 21676.D0/27.D0*Hr1(1)*dx - 208.D0*Hr1(1)*z3
     &     + 104.D0*Hr1(1)*z3*x + 208.D0*Hr1(1)*z3*dx - 224.D0/3.D0*
     &    Hr1(1)*z2 )
      Kgq2 = Kgq2 + cf*ca**2 * ( 28.D0/3.D0*Hr1(1)*z2*x - 64.D0/3.D0*
     &    Hr1(1)*z2*x**2 + 8.D0*Hr1(1)*z2*dx + 448.D0*Hr2(-1,-1)*z2 + 
     &    224.D0*Hr2(-1,-1)*z2*x + 448.D0*Hr2(-1,-1)*z2*dx - 5936.D0/9.D
     &    0*Hr2(-1,0) - 628.D0/9.D0*Hr2(-1,0)*x - 1888.D0/9.D0*Hr2(-1,0
     &    )*x**2 - 1612.D0/3.D0*Hr2(-1,0)*dx - 224.D0*Hr2(-1,0)*z2 - 
     &    112.D0*Hr2(-1,0)*z2*x - 224.D0*Hr2(-1,0)*z2*dx - 240.D0*Hr2(0
     &    ,-1)*z2 - 104.D0*Hr2(0,-1)*z2*x - 192.D0*Hr2(0,-1)*z2*dx - 
     &    2396.D0*Hr2(0,0) + 3334.D0/9.D0*Hr2(0,0)*x - 1088.D0/3.D0*
     &    Hr2(0,0)*x**2 + 3784.D0/9.D0*Hr2(0,0)*dx - 8.D0*Hr2(0,0)*z2
     &     - 44.D0*Hr2(0,0)*z2*x - 5632.D0/9.D0*Hr2(0,1) - 820.D0/9.D0*
     &    Hr2(0,1)*x - 256.D0/3.D0*Hr2(0,1)*x**2 - 2684.D0/9.D0*Hr2(0,1
     &    )*dx - 48.D0*Hr2(0,1)*z2 + 40.D0*Hr2(0,1)*z2*x + 64.D0*Hr2(0,
     &    1)*z2*dx - 1460.D0/3.D0*Hr2(1,0) + 282.D0*Hr2(1,0)*x + 800.D0/
     &    9.D0*Hr2(1,0)*x**2 + 3892.D0/9.D0*Hr2(1,0)*dx - 968.D0/9.D0*
     &    Hr2(1,1) + 484.D0/9.D0*Hr2(1,1)*x + 68.D0/9.D0*Hr2(1,1)*dx - 
     &    128.D0*Hr2(1,1)*z2 )
      Kgq2 = Kgq2 + cf*ca**2 * ( 64.D0*Hr2(1,1)*z2*x + 128.D0*Hr2(1,1)*
     &    z2*dx - 384.D0*Hr3(-1,-1,0) - 136.D0*Hr3(-1,-1,0)*x - 128.D0/
     &    3.D0*Hr3(-1,-1,0)*x**2 - 464.D0/3.D0*Hr3(-1,-1,0)*dx + 2896.D0
     &    /3.D0*Hr3(-1,0,0) + 860.D0/3.D0*Hr3(-1,0,0)*x + 256.D0/3.D0*
     &    Hr3(-1,0,0)*x**2 + 2528.D0/3.D0*Hr3(-1,0,0)*dx + 1696.D0/3.D0
     &    *Hr3(-1,0,1) + 800.D0/3.D0*Hr3(-1,0,1)*x + 128.D0/3.D0*Hr3(-1
     &    ,0,1)*x**2 + 400.D0*Hr3(-1,0,1)*dx + 2824.D0/3.D0*Hr3(0,-1,0)
     &     + 328.D0/3.D0*Hr3(0,-1,0)*x + 128.D0*Hr3(0,-1,0)*x**2 - 352.D
     &    0/3.D0*Hr3(0,-1,0)*dx + 880.D0/3.D0*Hr3(0,0,0) + 152.D0/3.D0*
     &    Hr3(0,0,0)*x - 64.D0*Hr3(0,0,0)*x**2 + 176.D0/3.D0*Hr3(0,0,0)
     &    *dx - 748.D0/3.D0*Hr3(0,0,1) - 84.D0*Hr3(0,0,1)*x - 128.D0/3.D
     &    0*Hr3(0,0,1)*x**2 - 176.D0/3.D0*Hr3(0,0,1)*dx - 1040.D0/3.D0*
     &    Hr3(0,1,0) + 112.D0/3.D0*Hr3(0,1,0)*x - 64.D0*Hr3(0,1,0)*x**2
     &     + 320.D0/3.D0*Hr3(0,1,0)*dx - 300.D0*Hr3(1,0,0) + 128.D0*
     &    Hr3(1,0,0)*x + 368.D0*Hr3(1,0,0)*dx - 352.D0/3.D0*Hr3(1,0,1)
     &     + 176.D0/3.D0*Hr3(1,0,1)*x )
      Kgq2 = Kgq2 + cf*ca**2 * ( 208.D0/3.D0*Hr3(1,0,1)*dx - 352.D0/3.D0
     &    *Hr3(1,1,0) + 176.D0/3.D0*Hr3(1,1,0)*x + 208.D0/3.D0*Hr3(1,1,
     &    0)*dx + 256.D0*Hr4(-1,-1,-1,0) + 128.D0*Hr4(-1,-1,-1,0)*x + 
     &    256.D0*Hr4(-1,-1,-1,0)*dx - 416.D0*Hr4(-1,-1,0,0) - 208.D0*
     &    Hr4(-1,-1,0,0)*x - 416.D0*Hr4(-1,-1,0,0)*dx - 320.D0*Hr4(-1,
     &    -1,0,1) - 160.D0*Hr4(-1,-1,0,1)*x - 320.D0*Hr4(-1,-1,0,1)*dx
     &     - 256.D0*Hr4(-1,0,-1,0) - 128.D0*Hr4(-1,0,-1,0)*x - 256.D0*
     &    Hr4(-1,0,-1,0)*dx + 160.D0*Hr4(-1,0,0,0) + 80.D0*Hr4(-1,0,0,0
     &    )*x + 160.D0*Hr4(-1,0,0,0)*dx + 160.D0*Hr4(-1,0,0,1) + 80.D0*
     &    Hr4(-1,0,0,1)*x + 160.D0*Hr4(-1,0,0,1)*dx + 64.D0*Hr4(-1,0,1,
     &    0) + 32.D0*Hr4(-1,0,1,0)*x + 64.D0*Hr4(-1,0,1,0)*dx - 96.D0*
     &    Hr4(0,-1,-1,0) - 80.D0*Hr4(0,-1,-1,0)*x - 128.D0*Hr4(0,-1,-1,
     &    0)*dx + 16.D0*Hr4(0,-1,0,0) + 200.D0*Hr4(0,-1,0,0)*x + 256.D0
     &    *Hr4(0,-1,0,0)*dx + 192.D0*Hr4(0,-1,0,1) + 64.D0*Hr4(0,-1,0,1
     &    )*x + 128.D0*Hr4(0,-1,0,1)*dx - 272.D0*Hr4(0,0,-1,0) + 8.D0*
     &    Hr4(0,0,-1,0)*x )
      Kgq2 = Kgq2 + cf*ca**2 * (  - 128.D0*Hr4(0,0,0,0) + 120.D0*Hr4(0,
     &    0,0,0)*x + 8.D0*Hr4(0,0,0,1) + 52.D0*Hr4(0,0,0,1)*x + 128.D0*
     &    Hr4(0,0,1,0) + 96.D0*Hr4(0,0,1,0)*x + 64.D0*Hr4(0,0,1,0)*dx
     &     + 72.D0*Hr4(0,1,0,0) + 4.D0*Hr4(0,1,0,0)*x + 128.D0*Hr4(1,0,
     &    -1,0) - 64.D0*Hr4(1,0,-1,0)*x - 128.D0*Hr4(1,0,-1,0)*dx - 32.D
     &    0*Hr4(1,0,0,0) + 16.D0*Hr4(1,0,0,0)*x + 32.D0*Hr4(1,0,0,0)*dx
     &     - 64.D0*Hr4(1,0,0,1) + 32.D0*Hr4(1,0,0,1)*x + 64.D0*Hr4(1,0,
     &    0,1)*dx - 128.D0*Hr4(1,0,1,0) + 64.D0*Hr4(1,0,1,0)*x + 128.D0
     &    *Hr4(1,0,1,0)*dx + 64.D0*Hr4(1,1,0,0) - 32.D0*Hr4(1,1,0,0)*x
     &     - 64.D0*Hr4(1,1,0,0)*dx )
      Kgq2 = Kgq2 + cf**2*ca * (  - 7417.D0/5.D0 + 6803.D0/45.D0*x + 
     &    1828.D0/45.D0*x**2 - 144.D0*z4 - 54.D0*z4*x + 5831.D0/10.D0*
     &    dx + 88.D0*dx*z4 + 896.D0/3.D0*z3 - 784.D0/3.D0*z3*x + 32.D0*
     &    z3*x**2 - 96.D0*z3*dx + 2428.D0/9.D0*z2 - 2240.D0/9.D0*z2*x
     &     - 832.D0/9.D0*z2*x**2 + 48.D0/5.D0*z2*x**3 - 2104.D0/3.D0*z2
     &    *dx + 368.D0*Hr1(-1)*z3 + 184.D0*Hr1(-1)*z3*x + 368.D0*Hr1(-1
     &    )*z3*dx + 432.D0*Hr1(-1)*z2 + 148.D0*Hr1(-1)*z2*x + 160.D0/3.D
     &    0*Hr1(-1)*z2*x**2 + 712.D0/3.D0*Hr1(-1)*z2*dx - 20044.D0/45.D0
     &    *Hr1(0) + 4052.D0/15.D0*Hr1(0)*x - 3512.D0/45.D0*Hr1(0)*x**2
     &     + 4846.D0/15.D0*Hr1(0)*dx - 160.D0*Hr1(0)*z3 - 288.D0*Hr1(0)
     &    *z3*x - 96.D0*Hr1(0)*z3*dx + 2224.D0/3.D0*Hr1(0)*z2 - 1196.D0/
     &    3.D0*Hr1(0)*z2*x + 64.D0*Hr1(0)*z2*x**2 - 1024.D0/3.D0*Hr1(0)
     &    *z2*dx - 1120.D0/3.D0*Hr1(1) + 536.D0/3.D0*Hr1(1)*x - 520.D0/
     &    9.D0*Hr1(1)*x**2 + 8344.D0/9.D0*Hr1(1)*dx + 528.D0*Hr1(1)*z3
     &     - 264.D0*Hr1(1)*z3*x - 528.D0*Hr1(1)*z3*dx + 896.D0/3.D0*
     &    Hr1(1)*z2 )
      Kgq2 = Kgq2 + cf**2*ca * (  - 244.D0/3.D0*Hr1(1)*z2*x + 32.D0*
     &    Hr1(1)*z2*x**2 - 536.D0/3.D0*Hr1(1)*z2*dx - 448.D0*Hr2(-1,-1)
     &    *z2 - 224.D0*Hr2(-1,-1)*z2*x - 448.D0*Hr2(-1,-1)*z2*dx + 48.D0
     &    *Hr2(-1,0) + 164.D0/3.D0*Hr2(-1,0)*x + 48.D0/5.D0*Hr2(-1,0)*
     &    x**3 - 36.D0*Hr2(-1,0)*dx + 64.D0/15.D0*Hr2(-1,0)*dx**2 + 64.D
     &    0*Hr2(-1,0)*z2 + 32.D0*Hr2(-1,0)*z2*x + 64.D0*Hr2(-1,0)*z2*dx
     &     + 144.D0*Hr2(0,-1)*z2 + 120.D0*Hr2(0,-1)*z2*x + 96.D0*Hr2(0,
     &    -1)*z2*dx + 1780.D0/9.D0*Hr2(0,0) + 1114.D0/9.D0*Hr2(0,0)*x
     &     + 832.D0/9.D0*Hr2(0,0)*x**2 - 48.D0/5.D0*Hr2(0,0)*x**3 - 144.
     &    D0*Hr2(0,0)*z2 - 72.D0*Hr2(0,0)*z2*x - 2428.D0/9.D0*Hr2(0,1)
     &     + 2732.D0/9.D0*Hr2(0,1)*x + 832.D0/9.D0*Hr2(0,1)*x**2 + 1996.
     &    D0/3.D0*Hr2(0,1)*dx + 144.D0*Hr2(0,1)*z2 - 152.D0*Hr2(0,1)*z2
     &    *x - 160.D0*Hr2(0,1)*z2*dx - 232.D0/3.D0*Hr2(1,0) + 46.D0/3.D0
     &    *Hr2(1,0)*x + 140.D0*Hr2(1,0)*dx + 224.D0*Hr2(1,0)*z2 - 112.D0
     &    *Hr2(1,0)*z2*x - 224.D0*Hr2(1,0)*z2*dx + 68.D0*Hr2(1,1)*dx + 
     &    256.D0*Hr2(1,1)*z2 )
      Kgq2 = Kgq2 + cf**2*ca * (  - 128.D0*Hr2(1,1)*z2*x - 256.D0*Hr2(1
     &    ,1)*z2*dx + 480.D0*Hr3(-1,-1,0) + 104.D0*Hr3(-1,-1,0)*x + 64.D
     &    0*Hr3(-1,-1,0)*x**2 + 240.D0*Hr3(-1,-1,0)*dx - 272.D0*Hr3(-1,
     &    0,0) - 84.D0*Hr3(-1,0,0)*x - 128.D0/3.D0*Hr3(-1,0,0)*x**2 - 
     &    536.D0/3.D0*Hr3(-1,0,0)*dx - 192.D0*Hr3(-1,0,1) - 96.D0*Hr3(
     &    -1,0,1)*x - 64.D0/3.D0*Hr3(-1,0,1)*x**2 - 352.D0/3.D0*Hr3(-1,
     &    0,1)*dx - 352.D0*Hr3(0,-1,0) - 136.D0*Hr3(0,-1,0)*x - 64.D0*
     &    Hr3(0,-1,0)*x**2 - 48.D0*Hr3(0,-1,0)*dx - 536.D0*Hr3(0,0,0)
     &     + 268.D0*Hr3(0,0,0)*x - 64.D0*Hr3(0,0,0)*x**2 - 2224.D0/3.D0
     &    *Hr3(0,0,1) + 788.D0/3.D0*Hr3(0,0,1)*x - 64.D0*Hr3(0,0,1)*
     &    x**2 + 880.D0/3.D0*Hr3(0,0,1)*dx - 568.D0/3.D0*Hr3(0,1,0) + 
     &    380.D0/3.D0*Hr3(0,1,0)*x + 128.D0*Hr3(0,1,0)*dx - 176.D0*Hr3(
     &    0,1,1) + 88.D0*Hr3(0,1,1)*x + 80.D0*Hr3(0,1,1)*dx - 752.D0/3.D
     &    0*Hr3(1,0,0) + 136.D0/3.D0*Hr3(1,0,0)*x - 64.D0/3.D0*Hr3(1,0,
     &    0)*x**2 + 120.D0*Hr3(1,0,0)*dx - 176.D0/3.D0*Hr3(1,0,1) + 88.D
     &    0/3.D0*Hr3(1,0,1)*x )
      Kgq2 = Kgq2 + cf**2*ca * ( 176.D0/3.D0*Hr3(1,0,1)*dx - 176.D0/3.D0
     &    *Hr3(1,1,0) + 88.D0/3.D0*Hr3(1,1,0)*x + 176.D0/3.D0*Hr3(1,1,0
     &    )*dx - 512.D0*Hr4(-1,-1,-1,0) - 256.D0*Hr4(-1,-1,-1,0)*x - 
     &    512.D0*Hr4(-1,-1,-1,0)*dx + 224.D0*Hr4(-1,-1,0,0) + 112.D0*
     &    Hr4(-1,-1,0,0)*x + 224.D0*Hr4(-1,-1,0,0)*dx + 192.D0*Hr4(-1,
     &    -1,0,1) + 96.D0*Hr4(-1,-1,0,1)*x + 192.D0*Hr4(-1,-1,0,1)*dx
     &     + 256.D0*Hr4(-1,0,-1,0) + 128.D0*Hr4(-1,0,-1,0)*x + 256.D0*
     &    Hr4(-1,0,-1,0)*dx + 32.D0*Hr4(-1,0,0,0) + 16.D0*Hr4(-1,0,0,0)
     &    *x + 32.D0*Hr4(-1,0,0,0)*dx + 32.D0*Hr4(-1,0,0,1) + 16.D0*
     &    Hr4(-1,0,0,1)*x + 32.D0*Hr4(-1,0,0,1)*dx + 160.D0*Hr4(0,-1,-1
     &    ,0) + 240.D0*Hr4(0,-1,-1,0)*x + 192.D0*Hr4(0,-1,-1,0)*dx - 48.
     &    D0*Hr4(0,-1,0,0) - 88.D0*Hr4(0,-1,0,0)*x - 96.D0*Hr4(0,-1,0,0
     &    )*dx - 64.D0*Hr4(0,-1,0,1) - 16.D0*Hr4(0,0,-1,0)*x + 64.D0*
     &    Hr4(0,0,0,0) + 48.D0*Hr4(0,0,0,0)*x + 144.D0*Hr4(0,0,0,1) + 
     &    56.D0*Hr4(0,0,0,1)*x - 32.D0*Hr4(0,0,1,0) + 16.D0*Hr4(0,0,1,0
     &    )*x )
      Kgq2 = Kgq2 + cf**2*ca * (  - 160.D0*Hr4(0,1,0,0) + 176.D0*Hr4(0,
     &    1,0,0)*x + 160.D0*Hr4(0,1,0,0)*dx - 64.D0*Hr4(0,1,0,1) + 32.D0
     &    *Hr4(0,1,0,1)*x + 64.D0*Hr4(0,1,0,1)*dx - 64.D0*Hr4(0,1,1,0)
     &     + 32.D0*Hr4(0,1,1,0)*x + 64.D0*Hr4(0,1,1,0)*dx - 64.D0*Hr4(1
     &    ,0,-1,0) + 32.D0*Hr4(1,0,-1,0)*x + 64.D0*Hr4(1,0,-1,0)*dx - 
     &    160.D0*Hr4(1,0,0,0) + 80.D0*Hr4(1,0,0,0)*x + 160.D0*Hr4(1,0,0
     &    ,0)*dx - 128.D0*Hr4(1,0,0,1) + 64.D0*Hr4(1,0,0,1)*x + 128.D0*
     &    Hr4(1,0,0,1)*dx - 256.D0*Hr4(1,1,0,0) + 128.D0*Hr4(1,1,0,0)*x
     &     + 256.D0*Hr4(1,1,0,0)*dx )
      Kgq2 = Kgq2 + cf**3 * ( 5432.D0/15.D0 + 246.D0/5.D0*x + 96.D0/5.D0
     &    *x**2 - 64.D0*z4 - 4.D0*z4*x - 5468.D0/15.D0*dx + 64.D0*dx*z4
     &     + 96.D0*z3 + 256.D0*z3*x + 96.D0*z3*dx + 72.D0*z2 + 164.D0/3.
     &    D0*z2*x - 96.D0/5.D0*z2*x**3 + 112.D0*z2*dx - 224.D0*Hr1(-1)*
     &    z3 - 112.D0*Hr1(-1)*z3*x - 224.D0*Hr1(-1)*z3*dx - 128.D0*Hr1(
     &    -1)*z2 - 104.D0*Hr1(-1)*z2*x - 48.D0*Hr1(-1)*z2*dx - 4264.D0/
     &    15.D0*Hr1(0) - 398.D0/5.D0*Hr1(0)*x + 96.D0/5.D0*Hr1(0)*x**2
     &     - 1432.D0/15.D0*Hr1(0)*dx + 128.D0*Hr1(0)*z3 + 160.D0*Hr1(0)
     &    *z3*x - 64.D0*Hr1(0)*z3*dx - 32.D0*Hr1(0)*z2 + 176.D0*Hr1(0)*
     &    z2*x + 96.D0*Hr1(0)*z2*dx - 84.D0*Hr1(1) + 32.D0*Hr1(1)*x - 
     &    54.D0*Hr1(1)*dx - 224.D0*Hr1(1)*z3 + 112.D0*Hr1(1)*z3*x + 224.
     &    D0*Hr1(1)*z3*dx - 64.D0*Hr1(1)*z2 + 40.D0*Hr1(1)*z2*x + 256.D0
     &    *Hr2(-1,-1)*z2 + 128.D0*Hr2(-1,-1)*z2*x + 256.D0*Hr2(-1,-1)*
     &    z2*dx + 96.D0*Hr2(-1,0) - 136.D0/3.D0*Hr2(-1,0)*x - 96.D0/5.D0
     &    *Hr2(-1,0)*x**3 + 152.D0*Hr2(-1,0)*dx - 128.D0/15.D0*Hr2(-1,0
     &    )*dx**2 )
      Kgq2 = Kgq2 + cf**3 * (  - 128.D0*Hr2(-1,0)*z2 - 64.D0*Hr2(-1,0)*
     &    z2*x - 128.D0*Hr2(-1,0)*z2*dx - 288.D0*Hr2(0,-1)*z2 - 112.D0*
     &    Hr2(0,-1)*z2*x - 64.D0*Hr2(0,-1)*z2*dx - 96.D0*Hr2(0,0) - 68.D
     &    0/3.D0*Hr2(0,0)*x + 96.D0/5.D0*Hr2(0,0)*x**3 + 96.D0*Hr2(0,0)
     &    *z2 - 16.D0*Hr2(0,0)*z2*x - 72.D0*Hr2(0,1) - 100.D0*Hr2(0,1)*
     &    x + 40.D0*Hr2(0,1)*dx - 96.D0*Hr2(0,1)*z2 + 80.D0*Hr2(0,1)*z2
     &    *x - 72.D0*Hr2(1,0) - 4.D0*Hr2(1,0)*x + 56.D0*Hr2(1,0)*dx - 
     &    128.D0*Hr2(1,0)*z2 + 64.D0*Hr2(1,0)*z2*x + 128.D0*Hr2(1,0)*z2
     &    *dx + 32.D0*Hr2(1,1)*dx - 128.D0*Hr2(1,1)*z2 + 64.D0*Hr2(1,1)
     &    *z2*x + 128.D0*Hr2(1,1)*z2*dx - 128.D0*Hr3(-1,-1,0) - 80.D0*
     &    Hr3(-1,-1,0)*x - 96.D0*Hr3(-1,-1,0)*dx + 96.D0*Hr3(-1,0,0) + 
     &    72.D0*Hr3(-1,0,0)*x + 48.D0*Hr3(-1,0,0)*dx + 64.D0*Hr3(-1,0,1
     &    ) + 64.D0*Hr3(-1,0,1)*x + 128.D0*Hr3(0,-1,0) + 160.D0*Hr3(0,
     &    -1,0)*x + 96.D0*Hr3(0,-1,0)*dx + 32.D0*Hr3(0,0,0) - 144.D0*
     &    Hr3(0,0,0)*x + 32.D0*Hr3(0,0,1) - 16.D0*Hr3(0,0,1)*x + 16.D0*
     &    Hr3(0,1,0) )
      Kgq2 = Kgq2 + cf**3 * (  - 8.D0*Hr3(0,1,0)*x + 48.D0*Hr3(0,1,0)*
     &    dx + 96.D0*Hr3(0,1,1)*dx + 32.D0*Hr3(1,0,0) - 8.D0*Hr3(1,0,0)
     &    *x + 48.D0*Hr3(1,0,1)*dx + 48.D0*Hr3(1,1,0)*dx + 256.D0*Hr4(
     &    -1,-1,-1,0) + 128.D0*Hr4(-1,-1,-1,0)*x + 256.D0*Hr4(-1,-1,-1,
     &    0)*dx - 192.D0*Hr4(-1,-1,0,0) - 96.D0*Hr4(-1,-1,0,0)*x - 192.D
     &    0*Hr4(-1,-1,0,0)*dx - 128.D0*Hr4(-1,-1,0,1) - 64.D0*Hr4(-1,-1
     &    ,0,1)*x - 128.D0*Hr4(-1,-1,0,1)*dx - 128.D0*Hr4(-1,0,-1,0) - 
     &    64.D0*Hr4(-1,0,-1,0)*x - 128.D0*Hr4(-1,0,-1,0)*dx + 64.D0*
     &    Hr4(-1,0,0,0) + 32.D0*Hr4(-1,0,0,0)*x + 64.D0*Hr4(-1,0,0,0)*
     &    dx + 64.D0*Hr4(-1,0,0,1) + 32.D0*Hr4(-1,0,0,1)*x + 64.D0*Hr4(
     &    -1,0,0,1)*dx - 320.D0*Hr4(0,-1,-1,0) - 224.D0*Hr4(0,-1,-1,0)*
     &    x - 128.D0*Hr4(0,-1,-1,0)*dx + 224.D0*Hr4(0,-1,0,0) + 112.D0*
     &    Hr4(0,-1,0,0)*x + 64.D0*Hr4(0,-1,0,0)*dx + 128.D0*Hr4(0,-1,0,
     &    1) + 128.D0*Hr4(0,0,-1,0) + 32.D0*Hr4(0,0,-1,0)*x - 32.D0*
     &    Hr4(0,0,0,0) - 16.D0*Hr4(0,0,0,0)*x - 96.D0*Hr4(0,0,0,1) + 48.
     &    D0*Hr4(0,0,0,1)*x )
      Kgq2 = Kgq2 + cf**3 * (  - 96.D0*Hr4(0,0,1,0) + 48.D0*Hr4(0,0,1,0
     &    )*x + 64.D0*Hr4(0,0,1,0)*dx - 128.D0*Hr4(0,0,1,1) + 64.D0*
     &    Hr4(0,0,1,1)*x + 128.D0*Hr4(0,0,1,1)*dx + 32.D0*Hr4(0,1,0,0)
     &     - 80.D0*Hr4(0,1,0,0)*x - 64.D0*Hr4(0,1,0,1) + 32.D0*Hr4(0,1,
     &    0,1)*x + 64.D0*Hr4(0,1,0,1)*dx - 64.D0*Hr4(0,1,1,0) + 32.D0*
     &    Hr4(0,1,1,0)*x + 64.D0*Hr4(0,1,1,0)*dx + 64.D0*Hr4(1,0,0,0)
     &     - 32.D0*Hr4(1,0,0,0)*x - 64.D0*Hr4(1,0,0,0)*dx + 64.D0*Hr4(1
     &    ,0,0,1) - 32.D0*Hr4(1,0,0,1)*x - 64.D0*Hr4(1,0,0,1)*dx + 64.D0
     &    *Hr4(1,1,0,0) - 32.D0*Hr4(1,1,0,0)*x - 64.D0*Hr4(1,1,0,0)*dx
     &     )
      Kgq2 = Kgq2 + nf*cf*ca * ( 7732.D0/27.D0 - 8390.D0/27.D0*x - 
     &    12728.D0/81.D0*x**2 - 43102.D0/81.D0*dx + 64.D0*z3 - 48.D0*z3
     &    *x - 64.D0*z3*dx - 1280.D0/9.D0*z2 + 344.D0/9.D0*z2*x - 128.D0
     &    /9.D0*z2*x**2 - 224.D0/9.D0*z2*dx + 16.D0/3.D0*Hr1(-1)*z2 + 8.
     &    D0/3.D0*Hr1(-1)*z2*x + 16.D0/3.D0*Hr1(-1)*z2*dx + 2032.D0/3.D0
     &    *Hr1(0) - 1400.D0/9.D0*Hr1(0)*x + 448.D0/27.D0*Hr1(0)*x**2 - 
     &    10316.D0/27.D0*Hr1(0)*dx + 32.D0/3.D0*Hr1(0)*z2 - 16.D0/3.D0*
     &    Hr1(0)*z2*x - 32.D0/3.D0*Hr1(0)*z2*dx + 1672.D0/27.D0*Hr1(1)
     &     - 1628.D0/27.D0*Hr1(1)*x - 256.D0/9.D0*Hr1(1)*x**2 + 104.D0/
     &    27.D0*Hr1(1)*dx - 112.D0/3.D0*Hr1(1)*z2 + 56.D0/3.D0*Hr1(1)*
     &    z2*x + 112.D0/3.D0*Hr1(1)*z2*dx + 32.D0/9.D0*Hr2(-1,0) + 136.D
     &    0/9.D0*Hr2(-1,0)*x + 64.D0/9.D0*Hr2(-1,0)*x**2 - 40.D0*Hr2(-1
     &    ,0)*dx + 2944.D0/9.D0*Hr2(0,0) - 536.D0/3.D0*Hr2(0,0)*x + 352.
     &    D0/9.D0*Hr2(0,0)*x**2 - 1832.D0/9.D0*Hr2(0,0)*dx + 1280.D0/9.D
     &    0*Hr2(0,1) - 208.D0/9.D0*Hr2(0,1)*x + 128.D0/9.D0*Hr2(0,1)*
     &    x**2 )
      Kgq2 = Kgq2 + nf*cf*ca * (  - 136.D0/9.D0*Hr2(0,1)*dx + 1856.D0/9.
     &    D0*Hr2(1,0) - 808.D0/9.D0*Hr2(1,0)*x + 32.D0/9.D0*Hr2(1,0)*
     &    x**2 - 1696.D0/9.D0*Hr2(1,0)*dx + 352.D0/9.D0*Hr2(1,1) - 176.D
     &    0/9.D0*Hr2(1,1)*x - 136.D0/9.D0*Hr2(1,1)*dx - 32.D0*Hr3(-1,-1
     &    ,0) - 16.D0*Hr3(-1,-1,0)*x - 32.D0*Hr3(-1,-1,0)*dx - 112.D0/3.
     &    D0*Hr3(-1,0,0) - 56.D0/3.D0*Hr3(-1,0,0)*x - 112.D0/3.D0*Hr3(
     &    -1,0,0)*dx - 64.D0/3.D0*Hr3(-1,0,1) - 32.D0/3.D0*Hr3(-1,0,1)*
     &    x - 64.D0/3.D0*Hr3(-1,0,1)*dx + 32.D0/3.D0*Hr3(0,-1,0) - 64.D0
     &    /3.D0*Hr3(0,-1,0)*x - 64.D0/3.D0*Hr3(0,-1,0)*dx - 160.D0/3.D0
     &    *Hr3(0,0,0) - 128.D0/3.D0*Hr3(0,0,0)*x - 32.D0/3.D0*Hr3(0,0,0
     &    )*dx - 32.D0/3.D0*Hr3(0,0,1) - 16.D0*Hr3(0,0,1)*x - 32.D0/3.D0
     &    *Hr3(0,0,1)*dx + 32.D0/3.D0*Hr3(0,1,0) - 64.D0/3.D0*Hr3(0,1,0
     &    )*x - 32.D0*Hr3(0,1,0)*dx + 80.D0*Hr3(1,0,0) - 40.D0*Hr3(1,0,
     &    0)*x - 80.D0*Hr3(1,0,0)*dx + 64.D0/3.D0*Hr3(1,0,1) - 32.D0/3.D
     &    0*Hr3(1,0,1)*x - 64.D0/3.D0*Hr3(1,0,1)*dx + 64.D0/3.D0*Hr3(1,
     &    1,0) )
      Kgq2 = Kgq2 + nf*cf*ca * (  - 32.D0/3.D0*Hr3(1,1,0)*x - 64.D0/3.D0
     &    *Hr3(1,1,0)*dx )
      Kgq2 = Kgq2 + nf*cf**2 * ( 1532.D0/3.D0 - 2741.D0/9.D0*x + 304.D0/
     &    27.D0*x**2 - 5779.D0/27.D0*dx - 608.D0/3.D0*z3 + 208.D0/3.D0*
     &    z3*x + 416.D0/3.D0*z3*dx - 880.D0/9.D0*z2 + 248.D0/9.D0*z2*x
     &     + 1288.D0/9.D0*z2*dx + 32.D0*Hr1(-1)*z2 + 16.D0*Hr1(-1)*z2*x
     &     + 32.D0*Hr1(-1)*z2*dx + 1868.D0/9.D0*Hr1(0) - 88.D0/3.D0*
     &    Hr1(0)*x - 448.D0/27.D0*Hr1(0)*x**2 + 220.D0/27.D0*Hr1(0)*dx
     &     - 256.D0/3.D0*Hr1(0)*z2 + 128.D0/3.D0*Hr1(0)*z2*x + 224.D0/3.
     &    D0*Hr1(0)*z2*dx + 40.D0*Hr1(1) - 28.D0/3.D0*Hr1(1)*x - 364.D0/
     &    3.D0*Hr1(1)*dx + 64.D0/3.D0*Hr1(1)*z2 - 32.D0/3.D0*Hr1(1)*z2*
     &    x - 64.D0/3.D0*Hr1(1)*z2*dx - 32.D0*Hr2(-1,0) - 32.D0*Hr2(-1,
     &    0)*x + 2024.D0/9.D0*Hr2(0,0) + 188.D0/9.D0*Hr2(0,0)*x + 416.D0
     &    /9.D0*Hr2(0,0)*dx + 880.D0/9.D0*Hr2(0,1) - 536.D0/9.D0*Hr2(0,
     &    1)*x - 1288.D0/9.D0*Hr2(0,1)*dx + 16.D0/3.D0*Hr2(1,0) - 4.D0/
     &    3.D0*Hr2(1,0)*x - 24.D0*Hr2(1,0)*dx - 24.D0*Hr2(1,1)*dx + 64.D
     &    0*Hr3(-1,-1,0) + 32.D0*Hr3(-1,-1,0)*x + 64.D0*Hr3(-1,-1,0)*dx
     &     - 32.D0*Hr3(-1,0,0) )
      Kgq2 = Kgq2 + nf*cf**2 * (  - 16.D0*Hr3(-1,0,0)*x - 32.D0*Hr3(-1,
     &    0,0)*dx - 64.D0*Hr3(0,-1,0) + 64.D0*Hr3(0,0,0) + 24.D0*Hr3(0,
     &    0,0)*x + 256.D0/3.D0*Hr3(0,0,1) - 128.D0/3.D0*Hr3(0,0,1)*x - 
     &    224.D0/3.D0*Hr3(0,0,1)*dx + 112.D0/3.D0*Hr3(0,1,0) - 56.D0/3.D
     &    0*Hr3(0,1,0)*x - 32.D0*Hr3(0,1,0)*dx + 32.D0*Hr3(0,1,1) - 16.D
     &    0*Hr3(0,1,1)*x - 32.D0*Hr3(0,1,1)*dx - 64.D0/3.D0*Hr3(1,0,0)
     &     + 32.D0/3.D0*Hr3(1,0,0)*x + 64.D0/3.D0*Hr3(1,0,0)*dx + 32.D0/
     &    3.D0*Hr3(1,0,1) - 16.D0/3.D0*Hr3(1,0,1)*x - 32.D0/3.D0*Hr3(1,
     &    0,1)*dx + 32.D0/3.D0*Hr3(1,1,0) - 16.D0/3.D0*Hr3(1,1,0)*x - 
     &    32.D0/3.D0*Hr3(1,1,0)*dx + 64.D0*Hr4(0,0,0,0) - 32.D0*Hr4(0,0
     &    ,0,0)*x )
      Kgq2 = Kgq2 + nf**2*cf * (  - 1628.D0/27.D0 + 844.D0/27.D0*x + 
     &    2006.D0/27.D0*dx + 64.D0/9.D0*z2 - 32.D0/9.D0*z2*x - 64.D0/9.D
     &    0*z2*dx - 424.D0/9.D0*Hr1(0) + 208.D0/9.D0*Hr1(0)*x + 476.D0/
     &    9.D0*Hr1(0)*dx - 464.D0/27.D0*Hr1(1) + 232.D0/27.D0*Hr1(1)*x
     &     + 464.D0/27.D0*Hr1(1)*dx - 208.D0/9.D0*Hr2(0,0) + 104.D0/9.D0
     &    *Hr2(0,0)*x + 208.D0/9.D0*Hr2(0,0)*dx - 64.D0/9.D0*Hr2(0,1)
     &     + 32.D0/9.D0*Hr2(0,1)*x + 64.D0/9.D0*Hr2(0,1)*dx - 80.D0/9.D0
     &    *Hr2(1,0) + 40.D0/9.D0*Hr2(1,0)*x + 80.D0/9.D0*Hr2(1,0)*dx - 
     &    32.D0/9.D0*Hr2(1,1) + 16.D0/9.D0*Hr2(1,1)*x + 32.D0/9.D0*Hr2(
     &    1,1)*dx )
*
       XKP22A = Kgq2
*
       RETURN
       END
*
* ---------------------------------------------------------------------
*
*
* ..K_phi phi, regular part
*
       FUNCTION XKPP2A (X, NF)
*
       IMPLICIT REAL*8 (A - Z)
       COMPLEX*16 HC1, HC2, HC3, HC4 
       INTEGER NF, N1, N2, NW, I1, I2, I3
       PARAMETER ( N1 = -1, N2 = 1, NW = 4 ) 
       DIMENSION HC1(N1:N2),HC2(N1:N2,N1:N2),HC3(N1:N2,N1:N2,N1:N2), 
     ,           HC4(N1:N2,N1:N2,N1:N2,N1:N2) 
       DIMENSION HR1(N1:N2),HR2(N1:N2,N1:N2),HR3(N1:N2,N1:N2,N1:N2), 
     ,           HR4(N1:N2,N1:N2,N1:N2,N1:N2) 
       DIMENSION HI1(N1:N2),HI2(N1:N2,N1:N2),HI3(N1:N2,N1:N2,N1:N2), 
     ,           HI4(N1:N2,N1:N2,N1:N2,N1:N2) 
       PARAMETER ( Z2 = 1.6449 34066 84822 64365 D0,
     ,             Z3 = 1.2020 56903 15959 42854 D0,
     ,             Z4 = 1.0823 23233 71113 81916 D0 )
*
* ..The soft coefficient for use in XKPP2B and XKPP2C
*
       COMMON / KP2SOFT / KP2A2, KP2A1, KP2A0
*
* ...Colour factors
*
       CF  = 4./3.D0
       CA  = 3.D0
*
* ...Some abbreviations
*
       DX = 1.D0/X
       DM = 1.D0/(1.D0-X)
       DP = 1.D0/(1.D0+X)
       DL1 = LOG (1.D0-X)
*
* ...The harmonic polylogs up to weight NW = 4 by Gehrmann and Remiddi
*
       CALL HPLOG (X, NW, HC1,HC2,HC3,HC4, HR1,HR2,HR3,HR4,
     ,            HI1,HI2,HI3,HI4, N1, N2) 
*
* ...The physical kernel in terms of the harmonic polylogs
*    (without the delta(1-x) part, but with the soft contribution)
*
      Kgg2 =
     &  + ca**3 * (  - 280316.D0/81.D0 + 250894.D0/81.D0*x - 90872.D0/
     &    27.D0*x**2 - 680.D0*z4 - 576.D0*z4*x - 208.D0*z4*x**2 + 
     &    315956.D0/81.D0*dx - 232.D0*dx*z4 + 220.D0*dp*z4 + 18974.D0/
     &    27.D0*dm - 12.D0*dm*z4 + 5288.D0/3.D0*z3 - 176.D0/3.D0*z3*x
     &     + 3520.D0/3.D0*z3*x**2 - 2024.D0/3.D0*z3*dx - 616.D0/3.D0*z3
     &    *dp - 440.D0*z3*dm + 7064.D0/9.D0*z2 - 5624.D0/9.D0*z2*x + 
     &    5912.D0/9.D0*z2*x**2 - 776.D0*z2*dx - 1072.D0/9.D0*z2*dp - 
     &    3008.D0/9.D0*z2*dm - 384.D0*Hr1(-1)*z3 - 192.D0*Hr1(-1)*z3*x
     &     - 192.D0*Hr1(-1)*z3*x**2 - 192.D0*Hr1(-1)*z3*dx + 192.D0*
     &    Hr1(-1)*z3*dp - 2680.D0/3.D0*Hr1(-1)*z2 - 1976.D0/3.D0*Hr1(-1
     &    )*z2*x - 968.D0/3.D0*Hr1(-1)*z2*x**2 - 968.D0/3.D0*Hr1(-1)*z2
     &    *dx + 704.D0/3.D0*Hr1(-1)*z2*dp + 43460.D0/27.D0*Hr1(0) + 
     &    32576.D0/27.D0*Hr1(0)*x + 42380.D0/27.D0*Hr1(0)*x**2 + 34549.D
     &    0/27.D0*Hr1(0)*dx + 11185.D0/27.D0*Hr1(0)*dm - 160.D0*Hr1(0)*
     &    z3*x + 192.D0*Hr1(0)*z3*x**2 - 32.D0*Hr1(0)*z3*dx - 80.D0*
     &    Hr1(0)*z3*dp )
      Kgg2 = Kgg2 + ca**3 * (  - 112.D0*Hr1(0)*z3*dm + 2888.D0/3.D0*
     &    Hr1(0)*z2 - 224.D0*Hr1(0)*z2*x + 2992.D0/3.D0*Hr1(0)*z2*x**2
     &     - 880.D0/3.D0*Hr1(0)*z2*dx - 88.D0*Hr1(0)*z2*dp - 880.D0/3.D0
     &    *Hr1(0)*z2*dm - 3176.D0/27.D0*Hr1(1) - 3812.D0/27.D0*Hr1(1)*x
     &     + 428.D0/27.D0*Hr1(1)*x**2 + 2234.D0/27.D0*Hr1(1)*dx + 9782.D
     &    0/27.D0*Hr1(1)*dm + 192.D0*Hr1(1)*z3 - 96.D0*Hr1(1)*z3*x + 96.
     &    D0*Hr1(1)*z3*x**2 - 96.D0*Hr1(1)*z3*dx - 96.D0*Hr1(1)*z3*dm
     &     + 280.D0/3.D0*Hr1(1)*z2 - 104.D0/3.D0*Hr1(1)*z2*x + 440.D0/3.
     &    D0*Hr1(1)*z2*x**2 - 440.D0/3.D0*Hr1(1)*z2*dx - 176.D0/3.D0*
     &    Hr1(1)*z2*dm + 512.D0*Hr2(-1,-1)*z2 + 256.D0*Hr2(-1,-1)*z2*x
     &     + 256.D0*Hr2(-1,-1)*z2*x**2 + 256.D0*Hr2(-1,-1)*z2*dx - 256.D
     &    0*Hr2(-1,-1)*z2*dp - 1928.D0/9.D0*Hr2(-1,0) - 4072.D0/9.D0*
     &    Hr2(-1,0)*x - 3976.D0/9.D0*Hr2(-1,0)*x**2 - 3976.D0/9.D0*Hr2(
     &    -1,0)*dx - 2144.D0/9.D0*Hr2(-1,0)*dp - 576.D0*Hr2(-1,0)*z2 - 
     &    288.D0*Hr2(-1,0)*z2*x - 288.D0*Hr2(-1,0)*z2*x**2 - 288.D0*
     &    Hr2(-1,0)*z2*dx )
      Kgg2 = Kgg2 + ca**3 * ( 288.D0*Hr2(-1,0)*z2*dp - 768.D0*Hr2(0,-1)
     &    *z2 - 96.D0*Hr2(0,-1)*z2*x - 352.D0*Hr2(0,-1)*z2*x**2 - 160.D0
     &    *Hr2(0,-1)*z2*dx + 256.D0*Hr2(0,-1)*z2*dp + 96.D0*Hr2(0,-1)*
     &    z2*dm - 6968.D0/3.D0*Hr2(0,0) + 7072.D0/9.D0*Hr2(0,0)*x - 
     &    2424.D0*Hr2(0,0)*x**2 + 3872.D0/9.D0*Hr2(0,0)*dx + 1072.D0/9.D
     &    0*Hr2(0,0)*dp + 3008.D0/9.D0*Hr2(0,0)*dm + 96.D0*Hr2(0,0)*z2
     &     - 352.D0*Hr2(0,0)*z2*x + 256.D0*Hr2(0,0)*z2*x**2 - 128.D0*
     &    Hr2(0,0)*z2*dp - 128.D0*Hr2(0,0)*z2*dm - 7064.D0/9.D0*Hr2(0,1
     &    ) + 1552.D0/9.D0*Hr2(0,1)*x - 5912.D0/9.D0*Hr2(0,1)*x**2 + 
     &    3008.D0/9.D0*Hr2(0,1)*dx + 1360.D0/3.D0*Hr2(0,1)*dm - 160.D0*
     &    Hr2(0,1)*z2*x + 32.D0*Hr2(0,1)*z2*x**2 - 96.D0*Hr2(0,1)*z2*dx
     &     + 32.D0*Hr2(0,1)*z2*dp - 64.D0*Hr2(0,1)*z2*dm - 2600.D0/3.D0
     &    *Hr2(1,0) + 1240.D0/3.D0*Hr2(1,0)*x - 1648.D0/3.D0*Hr2(1,0)*
     &    x**2 + 1648.D0/3.D0*Hr2(1,0)*dx + 1360.D0/3.D0*Hr2(1,0)*dm + 
     &    192.D0*Hr2(1,0)*z2 - 96.D0*Hr2(1,0)*z2*x + 96.D0*Hr2(1,0)*z2*
     &    x**2 )
      Kgg2 = Kgg2 + ca**3 * (  - 96.D0*Hr2(1,0)*z2*dx - 96.D0*Hr2(1,0)*
     &    z2*dm - 1936.D0/9.D0*Hr2(1,1) + 968.D0/9.D0*Hr2(1,1)*x - 968.D
     &    0/9.D0*Hr2(1,1)*x**2 + 968.D0/9.D0*Hr2(1,1)*dx + 968.D0/9.D0*
     &    Hr2(1,1)*dm - 1552.D0/3.D0*Hr3(-1,-1,0) - 848.D0/3.D0*Hr3(-1,
     &    -1,0)*x - 176.D0/3.D0*Hr3(-1,-1,0)*x**2 - 176.D0/3.D0*Hr3(-1,
     &    -1,0)*dx + 704.D0/3.D0*Hr3(-1,-1,0)*dp + 3584.D0/3.D0*Hr3(-1,
     &    0,0) + 2704.D0/3.D0*Hr3(-1,0,0)*x + 2288.D0/3.D0*Hr3(-1,0,0)*
     &    x**2 + 2288.D0/3.D0*Hr3(-1,0,0)*dx - 880.D0/3.D0*Hr3(-1,0,0)*
     &    dp + 1904.D0/3.D0*Hr3(-1,0,1) + 1552.D0/3.D0*Hr3(-1,0,1)*x + 
     &    880.D0/3.D0*Hr3(-1,0,1)*x**2 + 880.D0/3.D0*Hr3(-1,0,1)*dx - 
     &    352.D0/3.D0*Hr3(-1,0,1)*dp + 2752.D0/3.D0*Hr3(0,-1,0) + 160.D0
     &    *Hr3(0,-1,0)*x + 704.D0*Hr3(0,-1,0)*x**2 - 176.D0/3.D0*Hr3(0,
     &    -1,0)*dx - 176.D0*Hr3(0,-1,0)*dp - 352.D0/3.D0*Hr3(0,-1,0)*dm
     &     - 368.D0*Hr3(0,0,0) + 2048.D0/3.D0*Hr3(0,0,0)*x - 2816.D0/3.D
     &    0*Hr3(0,0,0)*x**2 + 176.D0/3.D0*Hr3(0,0,0)*dx + 88.D0*Hr3(0,0
     &    ,0)*dp )
      Kgg2 = Kgg2 + ca**3 * ( 440.D0/3.D0*Hr3(0,0,0)*dm - 2888.D0/3.D0*
     &    Hr3(0,0,1) + 384.D0*Hr3(0,0,1)*x - 2992.D0/3.D0*Hr3(0,0,1)*
     &    x**2 + 704.D0/3.D0*Hr3(0,0,1)*dx + 176.D0/3.D0*Hr3(0,0,1)*dp
     &     + 968.D0/3.D0*Hr3(0,0,1)*dm - 464.D0*Hr3(0,1,0) + 448.D0*
     &    Hr3(0,1,0)*x - 528.D0*Hr3(0,1,0)*x**2 + 880.D0/3.D0*Hr3(0,1,0
     &    )*dx + 176.D0*Hr3(0,1,0)*dm - 352.D0*Hr3(0,1,1) + 176.D0*Hr3(
     &    0,1,1)*x - 176.D0*Hr3(0,1,1)*x**2 + 176.D0*Hr3(0,1,1)*dx + 
     &    176.D0*Hr3(0,1,1)*dm - 1832.D0/3.D0*Hr3(1,0,0) + 1216.D0/3.D0
     &    *Hr3(1,0,0)*x - 1408.D0/3.D0*Hr3(1,0,0)*x**2 + 1408.D0/3.D0*
     &    Hr3(1,0,0)*dx + 616.D0/3.D0*Hr3(1,0,0)*dm - 352.D0*Hr3(1,0,1)
     &     + 176.D0*Hr3(1,0,1)*x - 176.D0*Hr3(1,0,1)*x**2 + 176.D0*Hr3(
     &    1,0,1)*dx + 176.D0*Hr3(1,0,1)*dm - 352.D0*Hr3(1,1,0) + 176.D0
     &    *Hr3(1,1,0)*x - 176.D0*Hr3(1,1,0)*x**2 + 176.D0*Hr3(1,1,0)*dx
     &     + 176.D0*Hr3(1,1,0)*dm - 768.D0*Hr4(-1,-1,0,0) - 384.D0*Hr4(
     &    -1,-1,0,0)*x - 384.D0*Hr4(-1,-1,0,0)*x**2 - 384.D0*Hr4(-1,-1,
     &    0,0)*dx )
      Kgg2 = Kgg2 + ca**3 * ( 384.D0*Hr4(-1,-1,0,0)*dp - 512.D0*Hr4(-1,
     &    -1,0,1) - 256.D0*Hr4(-1,-1,0,1)*x - 256.D0*Hr4(-1,-1,0,1)*
     &    x**2 - 256.D0*Hr4(-1,-1,0,1)*dx + 256.D0*Hr4(-1,-1,0,1)*dp - 
     &    256.D0*Hr4(-1,0,-1,0) - 128.D0*Hr4(-1,0,-1,0)*x - 128.D0*Hr4(
     &    -1,0,-1,0)*x**2 - 128.D0*Hr4(-1,0,-1,0)*dx + 128.D0*Hr4(-1,0,
     &    -1,0)*dp + 512.D0*Hr4(-1,0,0,0) + 256.D0*Hr4(-1,0,0,0)*x + 
     &    256.D0*Hr4(-1,0,0,0)*x**2 + 256.D0*Hr4(-1,0,0,0)*dx - 256.D0*
     &    Hr4(-1,0,0,0)*dp + 512.D0*Hr4(-1,0,0,1) + 256.D0*Hr4(-1,0,0,1
     &    )*x + 256.D0*Hr4(-1,0,0,1)*x**2 + 256.D0*Hr4(-1,0,0,1)*dx - 
     &    256.D0*Hr4(-1,0,0,1)*dp + 128.D0*Hr4(-1,0,1,0) + 64.D0*Hr4(-1
     &    ,0,1,0)*x + 64.D0*Hr4(-1,0,1,0)*x**2 + 64.D0*Hr4(-1,0,1,0)*dx
     &     - 64.D0*Hr4(-1,0,1,0)*dp - 512.D0*Hr4(0,-1,-1,0) + 64.D0*
     &    Hr4(0,-1,-1,0)*x - 192.D0*Hr4(0,-1,-1,0)*x**2 - 64.D0*Hr4(0,
     &    -1,-1,0)*dx + 128.D0*Hr4(0,-1,-1,0)*dp + 64.D0*Hr4(0,-1,-1,0)
     &    *dm + 512.D0*Hr4(0,-1,0,0) + 416.D0*Hr4(0,-1,0,0)*x + 352.D0*
     &    Hr4(0,-1,0,0)*x**2 )
      Kgg2 = Kgg2 + ca**3 * ( 224.D0*Hr4(0,-1,0,0)*dx - 288.D0*Hr4(0,-1
     &    ,0,0)*dp - 64.D0*Hr4(0,-1,0,0)*dm + 512.D0*Hr4(0,-1,0,1) + 
     &    128.D0*Hr4(0,-1,0,1)*x + 256.D0*Hr4(0,-1,0,1)*x**2 + 128.D0*
     &    Hr4(0,-1,0,1)*dx - 192.D0*Hr4(0,-1,0,1)*dp - 64.D0*Hr4(0,-1,0
     &    ,1)*dm - 64.D0*Hr4(0,0,-1,0) + 64.D0*Hr4(0,0,-1,0)*x + 128.D0
     &    *Hr4(0,0,-1,0)*x**2 - 64.D0*Hr4(0,0,-1,0)*dp - 64.D0*Hr4(0,0,
     &    -1,0)*dm - 256.D0*Hr4(0,0,0,0) + 448.D0*Hr4(0,0,0,0)*x - 128.D
     &    0*Hr4(0,0,0,0)*x**2 + 64.D0*Hr4(0,0,0,0)*dp + 64.D0*Hr4(0,0,0
     &    ,0)*dm - 96.D0*Hr4(0,0,0,1) + 416.D0*Hr4(0,0,0,1)*x - 256.D0*
     &    Hr4(0,0,0,1)*x**2 + 128.D0*Hr4(0,0,0,1)*dp + 128.D0*Hr4(0,0,0
     &    ,1)*dm - 128.D0*Hr4(0,0,1,0) + 384.D0*Hr4(0,0,1,0)*x - 192.D0
     &    *Hr4(0,0,1,0)*x**2 + 128.D0*Hr4(0,0,1,0)*dx + 32.D0*Hr4(0,0,1
     &    ,0)*dp + 160.D0*Hr4(0,0,1,0)*dm - 256.D0*Hr4(0,0,1,1) + 128.D0
     &    *Hr4(0,0,1,1)*x - 128.D0*Hr4(0,0,1,1)*x**2 + 128.D0*Hr4(0,0,1
     &    ,1)*dx + 128.D0*Hr4(0,0,1,1)*dm - 160.D0*Hr4(0,1,0,0) + 320.D0
     &    *Hr4(0,1,0,0)*x )
      Kgg2 = Kgg2 + ca**3 * (  - 160.D0*Hr4(0,1,0,0)*x**2 + 160.D0*Hr4(
     &    0,1,0,0)*dx + 160.D0*Hr4(0,1,0,0)*dm - 256.D0*Hr4(0,1,0,1) + 
     &    128.D0*Hr4(0,1,0,1)*x - 128.D0*Hr4(0,1,0,1)*x**2 + 128.D0*
     &    Hr4(0,1,0,1)*dx + 128.D0*Hr4(0,1,0,1)*dm - 256.D0*Hr4(0,1,1,0
     &    ) + 128.D0*Hr4(0,1,1,0)*x - 128.D0*Hr4(0,1,1,0)*x**2 + 128.D0
     &    *Hr4(0,1,1,0)*dx + 128.D0*Hr4(0,1,1,0)*dm + 128.D0*Hr4(1,0,-1
     &    ,0) - 64.D0*Hr4(1,0,-1,0)*x + 64.D0*Hr4(1,0,-1,0)*x**2 - 64.D0
     &    *Hr4(1,0,-1,0)*dx - 64.D0*Hr4(1,0,-1,0)*dm - 256.D0*Hr4(1,0,0
     &    ,0) + 128.D0*Hr4(1,0,0,0)*x - 128.D0*Hr4(1,0,0,0)*x**2 + 128.D
     &    0*Hr4(1,0,0,0)*dx + 128.D0*Hr4(1,0,0,0)*dm - 256.D0*Hr4(1,0,0
     &    ,1) + 128.D0*Hr4(1,0,0,1)*x - 128.D0*Hr4(1,0,0,1)*x**2 + 128.D
     &    0*Hr4(1,0,0,1)*dx + 128.D0*Hr4(1,0,0,1)*dm - 256.D0*Hr4(1,0,1
     &    ,0) + 128.D0*Hr4(1,0,1,0)*x - 128.D0*Hr4(1,0,1,0)*x**2 + 128.D
     &    0*Hr4(1,0,1,0)*dx + 128.D0*Hr4(1,0,1,0)*dm - 256.D0*Hr4(1,1,0
     &    ,0) + 128.D0*Hr4(1,1,0,0)*x - 128.D0*Hr4(1,1,0,0)*x**2 + 128.D
     &    0*Hr4(1,1,0,0)*dx )
      Kgg2 = Kgg2 + ca**3 * ( 128.D0*Hr4(1,1,0,0)*dm )
      Kgg2 = Kgg2 + nf*ca**2 * ( 15406.D0/81.D0 - 10262.D0/81.D0*x + 
     &    1768.D0/9.D0*x**2 + 138.D0*z4 + 78.D0*z4*x - 4010.D0/9.D0*dx
     &     - 20858.D0/81.D0*dm - 272.D0/3.D0*z3 + 272.D0/3.D0*z3*x - 
     &    256.D0/3.D0*z3*x**2 - 16.D0/3.D0*z3*dx + 112.D0/3.D0*z3*dp + 
     &    48.D0*z3*dm - 292.D0*z2 + 1972.D0/9.D0*z2*x - 176.D0*z2*x**2
     &     + 224.D0/3.D0*z2*dx + 160.D0/9.D0*z2*dp + 96.D0*z2*dm - 8.D0/
     &    3.D0*Hr1(-1)*z2 - 136.D0/3.D0*Hr1(-1)*z2*x + 48.D0*Hr1(-1)*z2
     &    *x**2 + 48.D0*Hr1(-1)*z2*dx - 128.D0/3.D0*Hr1(-1)*z2*dp + 
     &    7952.D0/27.D0*Hr1(0) - 10954.D0/27.D0*Hr1(0)*x + 2692.D0/9.D0
     &    *Hr1(0)*x**2 - 8578.D0/27.D0*Hr1(0)*dx - 4562.D0/27.D0*Hr1(0)
     &    *dm - 96.D0*Hr1(0)*z3*x - 260.D0/3.D0*Hr1(0)*z2 + 132.D0*Hr1(
     &    0)*z2*x - 160.D0/3.D0*Hr1(0)*z2*x**2 + 32.D0*Hr1(0)*z2*dx + 
     &    16.D0*Hr1(0)*z2*dp + 160.D0/3.D0*Hr1(0)*z2*dm + 7534.D0/27.D0
     &    *Hr1(1) - 5378.D0/27.D0*Hr1(1)*x + 1564.D0/27.D0*Hr1(1)*x**2
     &     - 3016.D0/27.D0*Hr1(1)*dx - 3764.D0/27.D0*Hr1(1)*dm - 232.D0/
     &    3.D0*Hr1(1)*z2 )
      Kgg2 = Kgg2 + nf*ca**2 * ( 200.D0/3.D0*Hr1(1)*z2*x + 16.D0/3.D0*
     &    Hr1(1)*z2*x**2 - 16.D0/3.D0*Hr1(1)*z2*dx + 32.D0/3.D0*Hr1(1)*
     &    z2*dm + 1400.D0/9.D0*Hr2(-1,0) + 1720.D0/9.D0*Hr2(-1,0)*x - 
     &    560.D0/9.D0*Hr2(-1,0)*x**2 - 560.D0/9.D0*Hr2(-1,0)*dx + 320.D0
     &    /9.D0*Hr2(-1,0)*dp - 48.D0*Hr2(0,-1)*z2 + 48.D0*Hr2(0,-1)*z2*
     &    x + 640.D0/3.D0*Hr2(0,0) - 3748.D0/9.D0*Hr2(0,0)*x + 2608.D0/
     &    9.D0*Hr2(0,0)*x**2 - 352.D0/3.D0*Hr2(0,0)*dx - 160.D0/9.D0*
     &    Hr2(0,0)*dp - 96.D0*Hr2(0,0)*dm - 24.D0*Hr2(0,0)*z2 - 40.D0*
     &    Hr2(0,0)*z2*x + 292.D0*Hr2(0,1) - 28.D0*Hr2(0,1)*x + 176.D0*
     &    Hr2(0,1)*x**2 - 1232.D0/9.D0*Hr2(0,1)*dx - 1024.D0/9.D0*Hr2(0
     &    ,1)*dm - 48.D0*Hr2(0,1)*z2 - 48.D0*Hr2(0,1)*z2*x + 2480.D0/9.D
     &    0*Hr2(1,0) - 1456.D0/9.D0*Hr2(1,0)*x + 176.D0*Hr2(1,0)*x**2
     &     - 176.D0*Hr2(1,0)*dx - 1024.D0/9.D0*Hr2(1,0)*dm + 704.D0/9.D0
     &    *Hr2(1,1) - 352.D0/9.D0*Hr2(1,1)*x + 352.D0/9.D0*Hr2(1,1)*
     &    x**2 - 352.D0/9.D0*Hr2(1,1)*dx - 352.D0/9.D0*Hr2(1,1)*dm - 80.
     &    D0/3.D0*Hr3(-1,-1,0) )
      Kgg2 = Kgg2 + nf*ca**2 * (  - 208.D0/3.D0*Hr3(-1,-1,0)*x + 224.D0/
     &    3.D0*Hr3(-1,-1,0)*x**2 + 224.D0/3.D0*Hr3(-1,-1,0)*dx - 128.D0/
     &    3.D0*Hr3(-1,-1,0)*dp - 104.D0/3.D0*Hr3(-1,0,0) + 56.D0/3.D0*
     &    Hr3(-1,0,0)*x - 64.D0*Hr3(-1,0,0)*x**2 - 64.D0*Hr3(-1,0,0)*dx
     &     + 160.D0/3.D0*Hr3(-1,0,0)*dp - 32.D0/3.D0*Hr3(-1,0,1) + 32.D0
     &    /3.D0*Hr3(-1,0,1)*x - 32.D0/3.D0*Hr3(-1,0,1)*x**2 - 32.D0/3.D0
     &    *Hr3(-1,0,1)*dx + 64.D0/3.D0*Hr3(-1,0,1)*dp + 56.D0/3.D0*Hr3(
     &    0,-1,0) - 24.D0*Hr3(0,-1,0)*x - 256.D0/3.D0*Hr3(0,-1,0)*x**2
     &     - 32.D0/3.D0*Hr3(0,-1,0)*dx + 32.D0*Hr3(0,-1,0)*dp + 64.D0/3.
     &    D0*Hr3(0,-1,0)*dm + 32.D0*Hr3(0,0,0) - 440.D0/3.D0*Hr3(0,0,0)
     &    *x + 128.D0/3.D0*Hr3(0,0,0)*x**2 - 32.D0/3.D0*Hr3(0,0,0)*dx
     &     - 16.D0*Hr3(0,0,0)*dp - 80.D0/3.D0*Hr3(0,0,0)*dm + 260.D0/3.D
     &    0*Hr3(0,0,1) - 156.D0*Hr3(0,0,1)*x + 160.D0/3.D0*Hr3(0,0,1)*
     &    x**2 - 128.D0/3.D0*Hr3(0,0,1)*dx - 32.D0/3.D0*Hr3(0,0,1)*dp
     &     - 176.D0/3.D0*Hr3(0,0,1)*dm + 32.D0*Hr3(0,1,0) - 64.D0*Hr3(0
     &    ,1,0)*x )
      Kgg2 = Kgg2 + nf*ca**2 * ( 32.D0*Hr3(0,1,0)*x**2 - 32.D0*Hr3(0,1,
     &    0)*dx - 32.D0*Hr3(0,1,0)*dm + 64.D0*Hr3(0,1,1) - 32.D0*Hr3(0,
     &    1,1)*x + 32.D0*Hr3(0,1,1)*x**2 - 32.D0*Hr3(0,1,1)*dx - 32.D0*
     &    Hr3(0,1,1)*dm + 308.D0/3.D0*Hr3(1,0,0) - 196.D0/3.D0*Hr3(1,0,
     &    0)*x + 32.D0*Hr3(1,0,0)*x**2 - 32.D0*Hr3(1,0,0)*dx - 112.D0/3.
     &    D0*Hr3(1,0,0)*dm + 64.D0*Hr3(1,0,1) - 32.D0*Hr3(1,0,1)*x + 32.
     &    D0*Hr3(1,0,1)*x**2 - 32.D0*Hr3(1,0,1)*dx - 32.D0*Hr3(1,0,1)*
     &    dm + 64.D0*Hr3(1,1,0) - 32.D0*Hr3(1,1,0)*x + 32.D0*Hr3(1,1,0)
     &    *x**2 - 32.D0*Hr3(1,1,0)*dx - 32.D0*Hr3(1,1,0)*dm - 96.D0*
     &    Hr4(0,-1,-1,0) + 96.D0*Hr4(0,-1,-1,0)*x + 48.D0*Hr4(0,-1,0,0)
     &     - 48.D0*Hr4(0,-1,0,0)*x + 80.D0*Hr4(0,0,-1,0) - 16.D0*Hr4(0,
     &    0,-1,0)*x + 16.D0*Hr4(0,0,0,0)*x + 24.D0*Hr4(0,0,0,1) + 24.D0
     &    *Hr4(0,0,0,1)*x + 24.D0*Hr4(0,1,0,0) + 24.D0*Hr4(0,1,0,0)*x )
      Kgg2 = Kgg2 + nf*cf*ca * ( 1475.D0/27.D0 - 11942.D0/27.D0*x + 
     &    57034.D0/81.D0*x**2 - 140.D0*z4 - 29197.D0/81.D0*dx - 176.D0/
     &    3.D0*dm - 392.D0/3.D0*z3 - 248.D0/3.D0*z3*x - 160.D0/3.D0*z3*
     &    x**2 + 256.D0/3.D0*z3*dx + 32.D0*z3*dm + 464.D0/3.D0*z2 - 384.
     &    D0*z2*x + 224.D0/9.D0*z2*x**2 + 184.D0*Hr1(-1)*z2 + 184.D0*
     &    Hr1(-1)*z2*x - 64.D0/3.D0*Hr1(-1)*z2*x**2 - 64.D0/3.D0*Hr1(-1
     &    )*z2*dx - 1498.D0/9.D0*Hr1(0) + 484.D0/3.D0*Hr1(0)*x - 16712.D
     &    0/27.D0*Hr1(0)*x**2 - 928.D0/9.D0*Hr1(0)*dx - 8.D0*Hr1(0)*dm
     &     + 128.D0*Hr1(0)*z3 + 256.D0*Hr1(0)*z3*x + 80.D0*Hr1(0)*z2 - 
     &    16.D0*Hr1(0)*z2*x - 64.D0/3.D0*Hr1(0)*z2*x**2 - 928.D0/3.D0*
     &    Hr1(1) + 964.D0/3.D0*Hr1(1)*x - 856.D0/27.D0*Hr1(1)*x**2 + 
     &    748.D0/27.D0*Hr1(1)*dx - 8.D0*Hr1(1)*dm + 120.D0*Hr1(1)*z2 - 
     &    120.D0*Hr1(1)*z2*x - 128.D0/3.D0*Hr1(1)*z2*x**2 + 128.D0/3.D0
     &    *Hr1(1)*z2*dx - 1520.D0/3.D0*Hr2(-1,0) - 1136.D0/3.D0*Hr2(-1,
     &    0)*x + 128.D0*Hr2(-1,0)*x**2 + 112.D0*Hr2(0,-1)*z2 - 112.D0*
     &    Hr2(0,-1)*z2*x )
      Kgg2 = Kgg2 + nf*cf*ca * ( 1340.D0/9.D0*Hr2(0,0) + 4892.D0/9.D0*
     &    Hr2(0,0)*x + 160.D0*Hr2(0,0)*x**2 - 464.D0/9.D0*Hr2(0,0)*dx
     &     + 96.D0*Hr2(0,0)*z2 + 96.D0*Hr2(0,0)*z2*x - 464.D0/3.D0*Hr2(
     &    0,1) + 16.D0/3.D0*Hr2(0,1)*x - 224.D0/9.D0*Hr2(0,1)*x**2 + 
     &    112.D0*Hr2(0,1)*z2 + 112.D0*Hr2(0,1)*z2*x - 44.D0/3.D0*Hr2(1,
     &    0) + 236.D0/3.D0*Hr2(1,0)*x - 64.D0/3.D0*Hr2(1,0)*x**2 - 128.D
     &    0/3.D0*Hr2(1,0)*dx + 240.D0*Hr3(-1,-1,0) + 240.D0*Hr3(-1,-1,0
     &    )*x - 256.D0/3.D0*Hr3(-1,-1,0)*x**2 - 256.D0/3.D0*Hr3(-1,-1,0
     &    )*dx - 120.D0*Hr3(-1,0,0) - 120.D0*Hr3(-1,0,0)*x - 32.D0/3.D0
     &    *Hr3(-1,0,0)*x**2 - 32.D0/3.D0*Hr3(-1,0,0)*dx - 64.D0*Hr3(-1,
     &    0,1) - 64.D0*Hr3(-1,0,1)*x - 64.D0/3.D0*Hr3(-1,0,1)*x**2 - 64.
     &    D0/3.D0*Hr3(-1,0,1)*dx - 160.D0*Hr3(0,-1,0) + 80.D0*Hr3(0,-1,
     &    0)*x + 64.D0*Hr3(0,-1,0)*x**2 - 64.D0/3.D0*Hr3(0,-1,0)*dx - 
     &    344.D0/3.D0*Hr3(0,0,0) - 248.D0/3.D0*Hr3(0,0,0)*x - 80.D0*
     &    Hr3(0,0,1) + 96.D0*Hr3(0,0,1)*x + 64.D0/3.D0*Hr3(0,0,1)*x**2
     &     - 64.D0/3.D0*Hr3(0,0,1)*dx )
      Kgg2 = Kgg2 + nf*cf*ca * (  - 184.D0/3.D0*Hr3(0,1,0) + 56.D0/3.D0
     &    *Hr3(0,1,0)*x - 64.D0/3.D0*Hr3(0,1,0)*dx - 88.D0*Hr3(1,0,0)
     &     + 88.D0*Hr3(1,0,0)*x + 160.D0/3.D0*Hr3(1,0,0)*x**2 - 160.D0/
     &    3.D0*Hr3(1,0,0)*dx + 224.D0*Hr4(0,-1,-1,0) - 224.D0*Hr4(0,-1,
     &    -1,0)*x - 48.D0*Hr4(0,-1,0,0) + 48.D0*Hr4(0,-1,0,0)*x - 96.D0
     &    *Hr4(0,0,-1,0) + 128.D0*Hr4(0,0,0,0) - 192.D0*Hr4(0,0,0,0)*x
     &     - 96.D0*Hr4(0,0,0,1) - 96.D0*Hr4(0,0,0,1)*x - 32.D0*Hr4(0,0,
     &    1,0) - 32.D0*Hr4(0,0,1,0)*x - 112.D0*Hr4(0,1,0,0) - 112.D0*
     &    Hr4(0,1,0,0)*x )
      Kgg2 = Kgg2 + nf*cf**2 * (  - 4807.D0/135.D0 + 3427.D0/135.D0*x
     &     + 3004.D0/45.D0*x**2 + 24.D0*z4 - 16.D0*z4*x - 848.D0/15.D0*
     &    dx - 16.D0*z3 - 64.D0*z3*x - 64.D0*z3*dx + 1432.D0/9.D0*z2*x
     &     + 64.D0/5.D0*z2*x**3 + 640.D0/9.D0*z2*dx - 16.D0*Hr1(-1)*z2
     &     - 16.D0*Hr1(-1)*z2*x + 64.D0/3.D0*Hr1(-1)*z2*x**2 + 64.D0/3.D
     &    0*Hr1(-1)*z2*dx - 304.D0/15.D0*Hr1(0) - 4622.D0/45.D0*Hr1(0)*
     &    x - 328.D0/135.D0*Hr1(0)*x**2 - 1256.D0/45.D0*Hr1(0)*dx - 32.D
     &    0*Hr1(0)*z3 - 96.D0*Hr1(0)*z3*x + 48.D0*Hr1(0)*z2 - 160.D0/3.D
     &    0*Hr1(0)*z2*x + 64.D0/3.D0*Hr1(0)*z2*dx + 100.D0*Hr1(1) - 8.D0
     &    *Hr1(1)*x + 280.D0/27.D0*Hr1(1)*x**2 - 2764.D0/27.D0*Hr1(1)*
     &    dx - 16.D0*Hr1(1)*z2 + 16.D0*Hr1(1)*z2*x + 64.D0/3.D0*Hr1(1)*
     &    z2*x**2 - 64.D0/3.D0*Hr1(1)*z2*dx + 448.D0/3.D0*Hr2(-1,0) + 
     &    1216.D0/9.D0*Hr2(-1,0)*x + 64.D0/5.D0*Hr2(-1,0)*x**3 - 64.D0/
     &    45.D0*Hr2(-1,0)*dx**2 - 32.D0*Hr2(0,-1)*z2 + 32.D0*Hr2(0,-1)*
     &    z2*x - 12.D0*Hr2(0,0) - 1468.D0/9.D0*Hr2(0,0)*x + 352.D0/9.D0
     &    *Hr2(0,0)*x**2 )
      Kgg2 = Kgg2 + nf*cf**2 * (  - 64.D0/5.D0*Hr2(0,0)*x**3 + 32.D0*
     &    Hr2(0,0)*z2 + 32.D0*Hr2(0,0)*z2*x - 24.D0*Hr2(0,1)*x - 640.D0/
     &    9.D0*Hr2(0,1)*dx - 32.D0*Hr2(0,1)*z2 - 32.D0*Hr2(0,1)*z2*x + 
     &    24.D0*Hr2(1,0) - 24.D0*Hr2(1,0)*x + 352.D0/9.D0*Hr2(1,0)*x**2
     &     - 352.D0/9.D0*Hr2(1,0)*dx - 32.D0*Hr3(-1,-1,0) - 32.D0*Hr3(
     &    -1,-1,0)*x + 128.D0/3.D0*Hr3(-1,-1,0)*x**2 + 128.D0/3.D0*Hr3(
     &    -1,-1,0)*dx + 16.D0*Hr3(-1,0,0) + 16.D0*Hr3(-1,0,0)*x - 64.D0/
     &    3.D0*Hr3(-1,0,0)*x**2 - 64.D0/3.D0*Hr3(-1,0,0)*dx + 32.D0*
     &    Hr3(0,-1,0) - 64.D0/3.D0*Hr3(0,-1,0)*x - 128.D0/3.D0*Hr3(0,-1
     &    ,0)*x**2 - 16.D0*Hr3(0,0,0) - 32.D0/3.D0*Hr3(0,0,0)*x - 48.D0
     &    *Hr3(0,0,1) + 32.D0*Hr3(0,0,1)*x - 64.D0/3.D0*Hr3(0,0,1)*dx
     &     - 32.D0*Hr3(0,1,0) - 16.D0*Hr3(0,1,0)*x - 64.D0/3.D0*Hr3(0,1
     &    ,0)*dx + 16.D0*Hr3(1,0,0) - 16.D0*Hr3(1,0,0)*x - 64.D0/3.D0*
     &    Hr3(1,0,0)*x**2 + 64.D0/3.D0*Hr3(1,0,0)*dx - 64.D0*Hr4(0,-1,
     &    -1,0) + 64.D0*Hr4(0,-1,-1,0)*x + 32.D0*Hr4(0,-1,0,0) - 32.D0*
     &    Hr4(0,-1,0,0)*x )
      Kgg2 = Kgg2 + nf*cf**2 * ( 64.D0*Hr4(0,0,-1,0) - 32.D0*Hr4(0,0,0,
     &    0) - 32.D0*Hr4(0,0,0,0)*x - 32.D0*Hr4(0,0,0,1) - 32.D0*Hr4(0,
     &    0,0,1)*x - 32.D0*Hr4(0,0,1,0) - 32.D0*Hr4(0,0,1,0)*x + 32.D0*
     &    Hr4(0,1,0,0) + 32.D0*Hr4(0,1,0,0)*x )
      Kgg2 = Kgg2 + nf**2*ca * (  - 2786.D0/81.D0 + 2890.D0/81.D0*x - 
     &    896.D0/27.D0*x**2 + 596.D0/9.D0*dx + 2284.D0/81.D0*dm + 64.D0/
     &    9.D0*z2 - 32.D0/9.D0*z2*x + 32.D0/9.D0*z2*x**2 - 64.D0/9.D0*
     &    z2*dx - 64.D0/9.D0*z2*dm - 304.D0/27.D0*Hr1(0) + 566.D0/27.D0
     &    *Hr1(0)*x - 88.D0/9.D0*Hr1(0)*x**2 + 940.D0/27.D0*Hr1(0)*dx
     &     + 556.D0/27.D0*Hr1(0)*dm - 398.D0/27.D0*Hr1(1) + 262.D0/27.D0
     &    *Hr1(1)*x - 88.D0/9.D0*Hr1(1)*x**2 + 176.D0/9.D0*Hr1(1)*dx + 
     &    424.D0/27.D0*Hr1(1)*dm - 32.D0/3.D0*Hr2(0,0) + 32.D0/3.D0*
     &    Hr2(0,0)*x - 64.D0/9.D0*Hr2(0,0)*x**2 + 64.D0/9.D0*Hr2(0,0)*
     &    dx + 64.D0/9.D0*Hr2(0,0)*dm - 64.D0/9.D0*Hr2(0,1) + 32.D0/9.D0
     &    *Hr2(0,1)*x - 32.D0/9.D0*Hr2(0,1)*x**2 + 64.D0/9.D0*Hr2(0,1)*
     &    dx + 64.D0/9.D0*Hr2(0,1)*dm - 128.D0/9.D0*Hr2(1,0) + 64.D0/9.D
     &    0*Hr2(1,0)*x - 64.D0/9.D0*Hr2(1,0)*x**2 + 64.D0/9.D0*Hr2(1,0)
     &    *dx + 64.D0/9.D0*Hr2(1,0)*dm - 64.D0/9.D0*Hr2(1,1) + 32.D0/9.D
     &    0*Hr2(1,1)*x - 32.D0/9.D0*Hr2(1,1)*x**2 + 32.D0/9.D0*Hr2(1,1)
     &    *dx )
      Kgg2 = Kgg2 + nf**2*ca * ( 32.D0/9.D0*Hr2(1,1)*dm )
      Kgg2 = Kgg2 + nf**2*cf * ( 134.D0/9.D0 - 280.D0/3.D0*x + 248.D0/
     &    27.D0*x**2 + 2266.D0/27.D0*dx + 4.D0*dm + 32.D0/3.D0*z3 + 32.D
     &    0/3.D0*z3*x + 620.D0/9.D0*Hr1(0) + 8.D0/9.D0*Hr1(0)*x + 400.D0
     &    /9.D0*Hr1(0)*dx + 376.D0/9.D0*Hr2(0,0) + 40.D0/9.D0*Hr2(0,0)*
     &    x - 32.D0/9.D0*Hr2(0,0)*x**2 + 160.D0/9.D0*Hr2(0,0)*dx + 8.D0/
     &    3.D0*Hr2(1,0) - 8.D0/3.D0*Hr2(1,0)*x - 32.D0/9.D0*Hr2(1,0)*
     &    x**2 + 32.D0/9.D0*Hr2(1,0)*dx + 80.D0/3.D0*Hr3(0,0,0) + 80.D0/
     &    3.D0*Hr3(0,0,0)*x + 16.D0/3.D0*Hr3(0,1,0) + 16.D0/3.D0*Hr3(0,
     &    1,0)*x )
      Kgg2 = Kgg2 + nf**3 * (  - 80.D0/81.D0*dx - 80.D0/81.D0*dm - 8.D0/
     &    9.D0*Hr1(0)*dx - 8.D0/9.D0*Hr1(0)*dm - 16.D0/27.D0*Hr1(1)*dx
     &     - 16.D0/27.D0*Hr1(1)*dm )
*
* ...The soft (`+'-distribution) part of the kernel
*
       KP2A2 =
     &    +16.D0/9.D0*ca*nf**2
     &    -176.D0/9.D0*ca**2*nf
     &    +484.D0/9.D0*ca**3
       KP2A1 =
     &    +16.D0/27.D0*nf**3
     &    -424.D0/27.D0*ca*nf**2
     &    +3764.D0/27.D0*ca**2*nf
     &    -9782.D0/27.D0*ca**3
     &    +8.D0*cf*ca*nf
     &    -32.D0/3.D0*z2*ca**2*nf
     &    +176.D0/3.D0*z2*ca**3
       KP2A0 =
     &    -80.D0/81.D0*nf**3
     &    +2284.D0/81.D0*ca*nf**2
     &    -20858.D0/81.D0*ca**2*nf
     &    +18974.D0/27.D0*ca**3
     &    +4.D0*cf*nf**2
     &    -176.D0/3.D0*cf*ca*nf
     &    -16.D0*z3*ca**2*nf
     &    -88.D0*z3*ca**3
     &    +32.D0*z3*cf*ca*nf
     &    -64.D0/9.D0*z2*ca*nf**2
     &    +96.D0*z2*ca**2*nf
     &    -3008.D0/9.D0*z2*ca**3
     &    +176.D0/5.D0*z2**2*ca**3
*
       Kgg2L = DM* ( DL1**2*KP2A2 + DL1* KP2A1 + KP2A0 )

* ...The regular piece of the kernel
*
       XKPP2A = Kgg2 - Kgg2L
*
       RETURN
       END
*
* ---------------------------------------------------------------------
*
*
* ..The singular (soft) piece.
*
       FUNCTION XKPP2B (Y, NF)
       IMPLICIT REAL*8 (A - Z)
       INTEGER NF
*
       COMMON / KP2SOFT / KP2A2, KP2A1, KP2A0
*
       DL1 = LOG (1.D0-Y)
       DM  = 1.D0/(1.D0-Y)
*
       XKPP2B  = DM* ( DL1**2* KP2A2 + DL1* KP2A1 + KP2A0 )
*
       RETURN
       END
*
* ---------------------------------------------------------------------
*
*
* ..The 'local' piece.
*
       FUNCTION XKPP2C (Y, NF)
*
       IMPLICIT REAL*8 (A - Z)
       INTEGER NF
       PARAMETER ( Z2 = 1.6449 34066 84822 64365 D0,
     ,             Z3 = 1.2020 56903 15959 42854 D0,
     ,             Z4 = 1.0823 23233 71113 81916 D0,
     ,             Z5 = 1.0369 27755 14336 99263 D0 )
*
       COMMON / KP2SOFT / KP2A2, KP2A1, KP2A0
*
* ...Colour factors
*
       CF  = 4./3.D0
       CA  = 3.D0
*
* ...The coefficient of delta(1-x)
*
       KP2DELT = 
     &    +200.D0/243.D0*nf**3
     &    -1139.D0/18.D0*ca*nf**2
     &    +89027.D0/162.D0*ca**2*nf
     &    -592399.D0/486.D0*ca**3
     &    -43.D0*cf*nf**2
     &    +465.D0/2.D0*cf*ca*nf
     &    +cf**2*nf
     &    -80.D0*z5*ca**3
     &    -16.D0*z3*ca*nf**2
     &    -80.D0/3.D0*z3*ca**2*nf
     &    +1988.D0/3.D0*z3*ca**3
     &    +32.D0*z3*cf*nf**2
     &    -176.D0*z3*cf*ca*nf
     &    -8.D0/9.D0*z2*nf**3
     &    +556.D0/27.D0*z2*ca*nf**2
     &    -4562.D0/27.D0*z2*ca**2*nf
     &    +11185.D0/27.D0*z2*ca**3
     &    -8.D0*z2*cf*ca*nf
     &    -16.D0*z2*z3*ca**3
     &    +16.D0*z2**2*ca**2*nf
     &    -88.D0*z2**2*ca**3
*
       DL1 = LOG (1.D0-Y)
*
       XKPP2C = DL1**3 * KP2A2/3.D0 + DL1**2 * KP2A1/2.D0
     1        + DL1 * KP2A0 + KP2DELT
*
       RETURN
       END
*
* =================================================================av==
